<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Convolutional Neural Network - ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="Convolutional Neural Network" />
<meta property="og:description" content="ì˜ìƒ ì¸ì‹ì˜ í˜ëª…!  ì»¨ë³¼ë£¨ì…˜ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Convolutional Neural Network) ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/convolutional_neural_network/" />
<meta property="article:published_time" content="2019-09-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-09-08T00:00:00+00:00" />

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ" rel="home">
				<div class="logo__title">ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</div>
				<div class="logo__tagline">ë”¥ëŸ¬ë‹ ëª¨ë¸ë§</div>
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Convolutional Neural Network</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2019-09-08T00:00:00">2019-09-08</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/deep-learning" rel="category">Deep Learning</a>, <a class="meta__link" href="/categories/convolutional-neural-network" rel="category">Convolutional Neural Network</a></span>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</a></li>
<li><a href="#ë°ì´í„°-ìˆ˜ì§‘-data-collection">ë°ì´í„° ìˆ˜ì§‘ (Data Collection)</a></li>
<li><a href="#ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</a>
<ul>
<li><a href="#edge-detection">Edge Detection</a></li>
</ul></li>
<li><a href="#ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</a>
<ul>
<li><a href="#ì •ê·œí™”-normalization">ì •ê·œí™” (Normalization)</a></li>
<li><a href="#ì´ì§„-ë¶„ë¥˜-binary-classification">ì´ì§„ ë¶„ë¥˜ (Binary Classification)</a></li>
</ul></li>
<li><a href="#cnn-ëª¨ë¸ë§-cnn-modeling">CNN ëª¨ë¸ë§ (CNN Modeling)</a>
<ul>
<li><a href="#convolutional-layer">Convolutional Layer</a>
<ul>
<li><a href="#í•„í„°-filter">í•„í„° (Filter)</a></li>
<li><a href="#íŒ¨ë”©-padding">íŒ¨ë”© (Padding)</a></li>
</ul></li>
<li><a href="#activation-layer">Activation Layer</a></li>
<li><a href="#pooling-layer">Pooling Layer</a>
<ul>
<li><a href="#dropout">Dropout</a></li>
</ul></li>
<li><a href="#fc-layer">FC Layer</a></li>
<li><a href="#output-layer">Output Layer</a></li>
<li><a href="#ì •ë¦¬">ì •ë¦¬</a></li>
</ul></li>
<li><a href="#ì¼€ë¼ìŠ¤-keras-ë¡œ-ëª¨ë¸ë§-modeling">ì¼€ë¼ìŠ¤(Keras)ë¡œ ëª¨ë¸ë§(Modeling)</a>
<ul>
<li><a href="#ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</a></li>
<li><a href="#ëª¨ë¸-í›ˆë ¨-train-model">ëª¨ë¸ í›ˆë ¨ (Train Model)</a></li>
<li><a href="#ì •í™•ë„-í‰ê°€-test-model">ì •í™•ë„ í‰ê°€ (Test Model)</a></li>
</ul></li>
<li><a href="#í•´ê²°-solution">í•´ê²° (Solution)</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<p>ì˜ìƒ ì¸ì‹ì˜ í˜ëª…!  ì»¨ë³¼ë£¨ì…˜ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Convolutional Neural Network) ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!</p>

<p>ì‹¤ì œë¡œ ëŒë ¤ ë³´ê³  ì‹¶ìœ¼ë©´ êµ¬ê¸€ ì½”ë©ìœ¼ë¡œ ~</p>

<p><a href="https://colab.research.google.com/github/skettee/notebooks/blob/master/convolutional_neural_network.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

<h2 id="ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</h2>

<p>ğŸ’° ê³ ê°</p>

<blockquote>
<p>ê³ ì–‘ì´ì™€ ê°•ì•„ì§€ ì‚¬ì§„ì„ êµ¬ë¶„í•˜ëŠ” í”„ë¡œê·¸ë¨ì´ í•„ìš”í•´ìš”~</p>
</blockquote>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë„¤~ ê³ ê°ë‹˜</p>

<p>CNNëª¨ë¸ë§ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•˜ì!</p>
</blockquote>

<h2 id="ë°ì´í„°-ìˆ˜ì§‘-data-collection">ë°ì´í„° ìˆ˜ì§‘ (Data Collection)</h2>

<p>ëª¨ë¸ í›ˆë ¨ì„ ìœ„í•´ì„œ CIFAR10ì—ì„œ ê³ ì–‘ì´ì™€ ê°•ì•„ì§€ì˜ ì´ë¯¸ì§€ë¥¼ ê³¨ë¼ì„œ ì‚¬ìš©í•œë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras.datasets <span style="color:#f92672">import</span> cifar10

(train_image, train_label), (test_image, test_label) <span style="color:#f92672">=</span> cifar10<span style="color:#f92672">.</span>load_data()</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd

CAT_VALUE <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
DOG_VALUE <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>

condition_train <span style="color:#f92672">=</span> (train_label[:,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">==</span>CAT_VALUE) <span style="color:#f92672">|</span> (train_label[:,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">==</span>DOG_VALUE)
condition_test <span style="color:#f92672">=</span> (test_label[:,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">==</span>CAT_VALUE) <span style="color:#f92672">|</span> (test_label[:,<span style="color:#ae81ff">0</span>]<span style="color:#f92672">==</span>DOG_VALUE)

x_train <span style="color:#f92672">=</span> train_image[condition_train]
y_train <span style="color:#f92672">=</span> train_label[condition_train]
x_test <span style="color:#f92672">=</span> test_image[condition_test]
y_test <span style="color:#f92672">=</span> test_label[condition_test]

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;x_train shape is &#39;</span>, x_train<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;y_train shape is &#39;</span>, y_train<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">x_test shape is &#39;</span>, x_test<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;y_test shape is &#39;</span>, y_test<span style="color:#f92672">.</span>shape)</code></pre></div>
<pre><code>x_train shape is  (10000, 32, 32, 3)
y_train shape is  (10000, 1)

x_test shape is  (2000, 32, 32, 3)
y_test shape is  (2000, 1)
</code></pre>

<h2 id="ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</h2>

<p>ê³ ì–‘ì´ì™€ ê°•ì•„ì§€ì˜ ë°ì´í„°ì…‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ul>
<li>x_train: 32x32x3(RGB), 10,000ê°œì˜ í›ˆë ¨ì„ ìœ„í•œ ê³ ì–‘ì´ì™€ ê°•ì•„ì§€ì˜ ì´ë¯¸ì§€<br /></li>
<li>y_train: 10,000ê°œì˜ ì´ë¯¸ì§€ë¥¼ ê³ ì–‘ì´(3), ê°•ì•„ì§€(5)ì˜ ë‘ê°€ì§€ ì •ìˆ˜ ê°’ìœ¼ë¡œ ë¼ë²¨ë§</li>
<li>x_test: 32x32x3(RGB), 2,000ê°œì˜ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ê³ ì–‘ì´ì™€ ê°œì˜ ì´ë¯¸ì§€</li>

<li><p>y_test:  2,000ê°œì˜ ì´ë¯¸ì§€ë¥¼ ê³ ì–‘ì´(3), ê°•ì•„ì§€(5)ì˜ ë‘ê°€ì§€ ì •ìˆ˜ ê°’ìœ¼ë¡œ ë¼ë²¨ë§</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>matplotlib inline
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">90</span>))
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">10</span>,i<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>)
plt<span style="color:#f92672">.</span>imshow(x_train[i])
plt<span style="color:#f92672">.</span>xticks([])
plt<span style="color:#f92672">.</span>yticks([])
plt<span style="color:#f92672">.</span>show()</code></pre></div></li>
</ul>

<p><img src="output_7_0.png" alt="png" /></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">y_train[:<span style="color:#ae81ff">10</span>]</code></pre></div>
<pre><code>array([[3],
       [3],
       [3],
       [3],
       [5],
       [3],
       [3],
       [3],
       [3],
       [5]], dtype=uint8)
</code></pre>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì»¬ëŸ¬(RGB)ì´ë¯¸ì§€ì˜ ëª¨ë“  í”½ì…€ê°’ì„ í”¼ì³(íŠ¹ì§•ê°’)ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ë¬´ë¦¬ë‹¤.<br />
ì˜ˆë¥¼ ë“¤ì–´ì„œ 1000X1000ì˜ ì»¬ëŸ¬ ì´ë¯¸ì§€ì˜ ì…ë ¥ í”¼ì³ ê°œìˆ˜ëŠ” ë¬´ë ¤<br />
3,000,000ê°œê°€ ëœë‹¤.<br />
ì»´í“¨í„°ê°€ ì‹«ì–´í•œë‹¤&hellip;<br />
ê·¸ë˜ì„œ ì—”ì§€ë‹ˆì–´ë“¤ì€<br />
í”¼ì³ ê°œìˆ˜ë¥¼ ì¤„ì´ë©´ì„œë„<br />
ì´ë¯¸ì§€ì˜ íŠ¹ì§•ì„ ì˜ ë³´ì—¬ì£¼ëŠ”<br />
ì—£ì§€(Edge) ìˆëŠ” ë°©ë²•ì„ ì°¾ì•„ ëƒˆë‹¤.<br />
ê·¸ê²ƒì€ ë°”ë¡œ&hellip;</p>
</blockquote>

<h3 id="edge-detection">Edge Detection</h3>

<p>ì—”ì§€ë‹ˆì–´ë“¤ì€ ì´ë¯¸ì§€ì˜ íŠ¹ì§•ì„ ì¶”ì¶œí•˜ê¸° ìœ„í•´ì„œ ì»¨ë²Œë£¨ì…˜(Convolution)ì´ë¼ëŠ” ê¸°ë²•ì„ ê°œë°œí–ˆë‹¤.<br />
ì»¨ë²Œë£¨ì…˜ì€ ì´ë¯¸ì§€ì— 3X3ì´ë‚˜ 5X5 í•„í„°ë¥¼ ì˜¤ë¥¸ìª½ê³¼ ì•„ë˜ë¡œ ì´ë™í•˜ë©° ì ìš©í•˜ëŠ” ê¸°ìˆ ì´ë‹¤.<br />
<img src="http://deeplearning.stanford.edu/wiki/images/6/6c/Convolution_schematic.gif" alt="ì»¨ë²Œë£¨ì…˜" />
ì¶œì²˜: <a href="http://deeplearning.stanford.edu/wiki">Stanford Deep Learning</a></p>

<p>í•„í„°ì— ë“¤ì–´ê°€ëŠ” ê°’ì— ë”°ë¼ì„œ ë‹¤ì–‘í•œ ì´ë¯¸ì§€ì˜ íŠ¹ì§•ë“¤ì„ ë³´ì—¬ì¤€ë‹¤.</p>

<p>ì•„ë˜ëŠ” sobel_h, sobel_v í•„í„°ë§ ì ìš© ì˜ˆë‹¤.</p>

<p>\(sobel_h = \begin{bmatrix}
1 &amp; 2 &amp; 1  \\
0 &amp; 0 &amp; 0  \\
-1 &amp; -2 &amp; -1
\end{bmatrix}
\quad
sobel_v =  \begin{bmatrix}
1 &amp; 0 &amp; -1  \\
2 &amp; 0 &amp; -2  \\
1 &amp; 0 &amp; -1
\end{bmatrix}\)</p>

<p>ì™¼ìª½ì€ ì›ë³¸ ì´ë¯¸ì§€, ì¤‘ê°„ì€ ë¬¼ì²´ì˜ ê°€ë¡œ ê²½ê³„ì„ ì´ ê°•ì¡°ë˜ëŠ” sobel_h í•„í„°ë¥¼ ì ìš©í•œ ì´ë¯¸ì§€, ì˜¤ë¥¸ìª½ì€ ë¬¼ì²´ì˜ ì„¸ë¡œ ê²½ê³„ì„ ì´ ê°•ì¡°ë˜ëŠ” sobel_v í•„í„°ë¥¼ ì ìš©í•œ ì´ë¯¸ì§€ë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> skimage.data <span style="color:#f92672">import</span> chelsea
<span style="color:#f92672">from</span> skimage.filters <span style="color:#f92672">import</span> sobel_h, sobel_v
<span style="color:#f92672">from</span> skimage.color <span style="color:#f92672">import</span> rgb2gray

<span style="color:#75715e"># INPUT</span>
image <span style="color:#f92672">=</span> chelsea()
grey_image <span style="color:#f92672">=</span> rgb2gray(image)

<span style="color:#75715e"># CONV</span>
edge_h <span style="color:#f92672">=</span> sobel_h(grey_image)
edge_v <span style="color:#f92672">=</span> sobel_v(grey_image)

<span style="color:#75715e"># ReLU</span>
edge_h <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(edge_h <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, edge_h)
edge_v <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(edge_v <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, edge_v)

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">12</span>,<span style="color:#ae81ff">4</span>))
plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>)
plt<span style="color:#f92672">.</span>imshow(image)
plt<span style="color:#f92672">.</span>xticks([])
plt<span style="color:#f92672">.</span>yticks([])
plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">2</span>)
plt<span style="color:#f92672">.</span>imshow(edge_h, cmap<span style="color:#f92672">=</span>plt<span style="color:#f92672">.</span>cm<span style="color:#f92672">.</span>gray)
plt<span style="color:#f92672">.</span>xticks([])
plt<span style="color:#f92672">.</span>yticks([])
plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>)
plt<span style="color:#f92672">.</span>imshow(edge_v, cmap<span style="color:#f92672">=</span>plt<span style="color:#f92672">.</span>cm<span style="color:#f92672">.</span>gray)
plt<span style="color:#f92672">.</span>xticks([])
plt<span style="color:#f92672">.</span>yticks([])
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_10_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ë¥¼ ì´ìš©í•˜ë©´<br />
ì—¬ëŸ¬ê°œì˜ í•„í„° ê»ë°ê¸°ë¥¼ ì¤€ë¹„í•˜ê³ <br />
í•„í„°ì— ë“¤ì–´ê°€ëŠ” ê°’ì„ \(w\) ë¡œ ë†“ìœ¼ë©´<br />
í•™ìŠµì„ í•˜ë©´ì„œ<br />
ë‹¤ë¥¸ ì‚¬ë¬¼ê³¼ êµ¬ë¶„ë˜ëŠ”<br />
ê³ ì–‘ì´ë§Œì˜ íŠ¹ì§•ì„ ë‚˜íƒ€ë‚´ëŠ”<br />
í•„í„° ê°’ë“¤ì„<br />
ìŠ¤ìŠ¤ë¡œ ìµœì í™” í•˜ì§€ ì•Šì„ê¹Œ?</p>
</blockquote>

<h2 id="ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</h2>

<h3 id="ì •ê·œí™”-normalization">ì •ê·œí™” (Normalization)</h3>

<p>ì…ë ¥ ì´ë¯¸ì§€ì— ëŒ€í•´ì„œ <code>ì •ê·œê°’ = (í˜„ì¬ê°’ - ìµœì†Œê°’) / (ìµœëŒ€ê°’-ìµœì†Œê°’)</code> ìœ¼ë¡œ ì •ê·œí™” í•œë‹¤!<br />
ìµœì†Œê°’ì´ 0ì´ê³ , ìµœëŒ€ê°’ì´ 255ì´ë‹ˆê¹Œ í˜„ì¬ê°’ì—ì„œ /255 ë¥¼ í•´ ì£¼ë©´ ëœë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x_train <span style="color:#f92672">=</span> x_train<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float32&#39;</span>)
x_test <span style="color:#f92672">=</span> x_test<span style="color:#f92672">.</span>astype(<span style="color:#e6db74">&#39;float32&#39;</span>)
x_train <span style="color:#f92672">/=</span> <span style="color:#ae81ff">255</span>
x_test <span style="color:#f92672">/=</span> <span style="color:#ae81ff">255</span></code></pre></div>
<h3 id="ì´ì§„-ë¶„ë¥˜-binary-classification">ì´ì§„ ë¶„ë¥˜ (Binary Classification)</h3>

<p>ê³ ì–‘ì´ëƒ ê°•ì•„ì§€ëƒë¥¼ ì„ íƒí•˜ëŠ” 0ê³¼ 1ì˜ ë¬¸ì œë‹¤. ë”°ë¼ì„œ ì¶œë ¥ ë ˆì´ì–´(output layer)ì˜ í™œì„±í™” í•¨ìˆ˜(activation function)ëŠ” ë‹¹ê·¼ ì‹œê·¸ëª¨ì´ë“œ(Sigmoid)ë¥¼ ì‚¬ìš©í•œë‹¤. ë”°ë¼ì„œ ê³ ì–‘ì´ë¥¼ 0, ê°•ì•„ì§€ë¥¼ 1ë¡œ ë³€í™˜í•œë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">y_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(y_train<span style="color:#f92672">==</span><span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
y_test <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>where(y_test<span style="color:#f92672">==</span><span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>)
y_train[:<span style="color:#ae81ff">10</span>]</code></pre></div>
<pre><code>array([[0],
       [0],
       [0],
       [0],
       [1],
       [0],
       [0],
       [0],
       [0],
       [1]])
</code></pre>

<h2 id="cnn-ëª¨ë¸ë§-cnn-modeling">CNN ëª¨ë¸ë§ (CNN Modeling)</h2>

<h3 id="convolutional-layer">Convolutional Layer</h3>

<p>ì´ë¯¸ì§€ì— ì»¨ë²Œë£¨ì…˜(Convolution)ì„ ìˆ˜í–‰í•˜ëŠ” ë ˆì´ì–´ë‹¤.<br />
í•„í„°ì˜ ê°œìˆ˜, í•„í„°ì˜ í¬ê¸°, íŒ¨ë”© ë°©ë²•ì„ ì •ì˜í•œë‹¤.<br />
ì˜ˆë¥¼ ë“¤ì–´ì„œ (32, 32, 3) ì´ë¯¸ì§€ì— (3, 3) í•„í„° 64ê°œë¥¼ ì ìš©í•˜ë©´ (30, 30, 64)ì˜ ì´ë¯¸ì§€ê°€ ì¶œë ¥ ëœë‹¤.<br />
ì…ë ¥ ì´ë¯¸ì§€ì™€ ì¶œë ¥ ì´ë¯¸ì§€ì˜ í•´ìƒë„ê°€ ë‹¬ë¼ì§€ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ì„œ íŒ¨ë”©(Padding)ì„ ì…ë ¥ ì´ë¯¸ì§€ì— ì ìš©í•œë‹¤.</p>

<h4 id="í•„í„°-filter">í•„í„° (Filter)</h4>

<p>ì¼ë°˜ì ìœ¼ë¡œ 3X3, 5X5 í•„í„°ë¥¼ ì‚¬ìš©í•œë‹¤.<br />
ë³´í†µ í•„í„°ì˜ ê°œìˆ˜ëŠ” ë ˆì´ì–´ê°€ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ë‘ë°°ë¡œ ëŠ˜ë¦°ë‹¤.</p>

<h4 id="íŒ¨ë”©-padding">íŒ¨ë”© (Padding)</h4>

<p>ì…ë ¥ ì´ë¯¸ì§€ ë§¤íŠ¸ë¦­ìŠ¤ì˜ ìƒí•˜, ì¢Œìš°ë¡œ &lsquo;0&rsquo;ì„ ì¶”ê°€í•˜ëŠ” ê²ƒì„ íŒ¨ë”©ì´ë¼ê³  í•œë‹¤.<br />
\(f\)ë¥¼ í•„í„° ì‚¬ì´ì¦ˆë¼ê³  í•˜ê³  \(p\)ë¥¼ íŒ¨ë”© ì‚¬ì´ì¦ˆë¼ê³  í•˜ë©´, ì…ë ¥ ì´ë¯¸ì§€ì™€ ì¶œë ¥ ì´ë¯¸ì§€ì˜ í•´ìƒë„ë¥¼ ê°™ê²Œ í•´ ì£¼ê¸° ìœ„í•´ì„œëŠ”<br />
\(p= {{f-1} \over 2}\) ë¡œ í•œë‹¤.</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ì„œ (32, 32, 3) ì´ë¯¸ì§€ì— (3, 3) í•„í„° 64ê°œë¥¼ ì ìš©í•˜ê³  íŒ¨ë”©ì„ 1ë¡œ í•˜ë©´ (32, 32, 64)ì˜ ì´ë¯¸ì§€ê°€ ì¶œë ¥ ëœë‹¤.</p>

<h3 id="activation-layer">Activation Layer</h3>

<p>0ë³´ë‹¤ ì‘ì€ ê°’ì€ 0ìœ¼ë¡œ ë§Œë“¤ì–´ì„œ ì‚¬ë¬¼ì˜ ê²½ê³„ì„ ë§Œì„ íŠ¹ì§•ìœ¼ë¡œ ì„ íƒí•œë‹¤. ë”°ë¼ì„œ ë ë£¨(ReLU)ë¥¼ ì‚¬ìš©í•œë‹¤.</p>

<h3 id="pooling-layer">Pooling Layer</h3>

<p>ë³´í†µ ë ˆì´ì–´ê°€ ì¶”ê°€ë  ë•Œë§ˆë‹¤ í•„í„° ê°œìˆ˜ëŠ” ë‘ë°°ë¡œ ëŠ˜ë¦¬ê³  í•´ìƒë„ëŠ” ë°˜ìœ¼ë¡œ ì¤„ì´ë„ë¡ ì„¤ê³„ë¥¼ í•œë‹¤.
ì‚¬ë¬¼ì˜ íŠ¹ì§•ì„ ë³´ì¡´í•˜ë©´ì„œ í•´ìƒë„ë¥¼ ì¤„ì´ëŠ” ì—­í™œì„ ìˆ˜í–‰í•œë‹¤.<br />
Max poolingì€ í•„í„°ê°’ì´ ì—†ëŠ” ìœˆë„ìš°ê°€ ì´ë¯¸ì§€ ìœ„ì—ì„œ ì´ë™í•˜ë©´ì„œ ë‚´ë¶€ì˜ ê°’ë“¤ ì¤‘ì— ìµœëŒ€ê°’ì„ ì„ íƒí•˜ëŠ” ë°©ì‹ì´ë‹¤.</p>

<p><img src="http://cs231n.github.io/assets/cnn/maxpool.jpeg" alt="Pooling" />
ì¶œì²˜: <a href="http://cs231n.github.io/convolutional-networks/">cs231n Convolutional Neural Networks</a></p>

<h4 id="dropout">Dropout</h4>

<p>ê³¼ëŒ€ì í•©(Overfitting)ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ë°©ë²•ìœ¼ë¡œì„œ ì£¼ì–´ì§„ í™•ë¥ ë¡œ ëœë¤í•˜ê²Œ ìœ ë‹›(unit)ì„ ì„ íƒí•´ì„œ êº¼ë²„ë¦°ë‹¤.<br />
ì˜ˆë¥¼ ë“¤ì–´ ë ˆì´ì–´ì˜ ìœ ë‹› ìˆ˜ê°€ 32ê°œì´ê³  Dropoutì˜ í™•ë¥ ì´ 0.25ì´ë©´ ì…ë ¥ì´ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ 8ê°œì˜ ìœ ë‹›ì„ ëœë¤í•˜ê²Œ ì„ íƒí•´ì„œ êº¼ë²„ë¦°ë‹¤.<br />
í›ˆë ¨ ê³¼ì •ì—ì„œë§Œ ì ìš©í•´ì•¼ í•œë‹¤.</p>

<h3 id="fc-layer">FC Layer</h3>

<p>íˆë“  ë ˆì´ì–´(Hidden layer)ë¡œì„œ ëª¨ë“  ìœ ë‹›ì´ ë¹ ì§ì—†ì´ ì—°ê²°ë˜ì–´ ìˆë‹¤.<br />
Fully Connected Layerë¡œì„œ ë´ìŠ¤(Dense)í•˜ê²Œ ì—°ê²° ë˜ì–´ ìˆë‹¤ëŠ” ëœ».</p>

<h3 id="output-layer">Output Layer</h3>

<p>ê³ ì–‘ì´ëƒ ê°•ì•„ì§€ëƒ, 0ê³¼ 1ì˜ ë¬¸ì œì„ìœ¼ë¡œ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.</p>

<h3 id="ì •ë¦¬">ì •ë¦¬</h3>

<ol>
<li>CONV = 3X3 filter, padding = &lsquo;same&rsquo;, activation=&lsquo;relu&rsquo; ë¡œ ì •ì˜í•œë‹¤.</li>
<li>[CONV 32] X2 : 32ê°œì˜ í•„í„°ë¡œ CONVë¥¼ ë‘ë²ˆ ìˆ˜í–‰í•œë‹¤.<br /></li>
<li>POOL = 2X2 window, dropout = 0.25 ë¡œ ì •ì˜í•œë‹¤.<br /></li>
<li>[POOL] : POOLì„ ìˆ˜í–‰í•œë‹¤. <sup>1</sup>&frasl;<sub>4</sub> í™•ë¥ ë¡œ ëœë¤í•˜ê²Œ ìœ ë‹›ì„ êº¼ë²„ë¦°ë‹¤.<br /></li>
<li>[CONV 64] X2 : 64ê°œì˜ í•„í„°ë¡œ CONVë¥¼ ë‘ë²ˆ ìˆ˜í–‰í•œë‹¤.<br /></li>
<li>[POOL] : POOLì„ ìˆ˜í–‰í•œë‹¤. <sup>1</sup>&frasl;<sub>4</sub> í™•ë¥ ë¡œ ëœë¤í•˜ê²Œ ìœ ë‹›ì„ êº¼ë²„ë¦°ë‹¤.</li>
<li>FC = activation=&lsquo;relu&rsquo;, 3. dropout = 0.25 ë¡œ ì •ì˜í•œë‹¤.<br /></li>
<li>[FC 512] : 512ê°œì˜ unitsë¡œ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ ë ˆì´ì–´ë¥¼ ì •ì˜í•œë‹¤. <sup>1</sup>&frasl;<sub>4</sub> í™•ë¥ ë¡œ ëœë¤í•˜ê²Œ ìœ ë‹›ì„ êº¼ë²„ë¦°ë‹¤.</li>
<li>[OUTPUT] : ì‹œê·¸ëª¨ì´ë“œ(Sigmoid)ë¡œ ì¶œë ¥ ë ˆì´ì–´ë¥¼ ì •ì˜í•œë‹¤.</li>
</ol>

<h2 id="ì¼€ë¼ìŠ¤-keras-ë¡œ-ëª¨ë¸ë§-modeling">ì¼€ë¼ìŠ¤(Keras)ë¡œ ëª¨ë¸ë§(Modeling)</h2>

<h3 id="ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow <span style="color:#f92672">import</span> keras
<span style="color:#f92672">from</span> tensorflow.keras.models <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> Dense, Dropout, Activation, Flatten
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> Conv2D, MaxPooling2D

<span style="color:#f92672">import</span> os

save_dir <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getcwd()
model_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;keras_catdog_trained_model.h5&#39;</span>

batch_size <span style="color:#f92672">=</span> <span style="color:#ae81ff">32</span>
epochs <span style="color:#f92672">=</span> <span style="color:#ae81ff">100</span>

model <span style="color:#f92672">=</span> Sequential()
<span style="color:#75715e"># CONV 32 X2</span>
model<span style="color:#f92672">.</span>add(Conv2D(<span style="color:#ae81ff">32</span>, (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>), padding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;same&#39;</span>,
                 input_shape<span style="color:#f92672">=</span>x_train<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>:]))
model<span style="color:#f92672">.</span>add(Activation(<span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(Conv2D(<span style="color:#ae81ff">32</span>, (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>)))
model<span style="color:#f92672">.</span>add(Activation(<span style="color:#e6db74">&#39;relu&#39;</span>))
<span style="color:#75715e"># POOL</span>
model<span style="color:#f92672">.</span>add(MaxPooling2D(pool_size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)))
model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.25</span>))

<span style="color:#75715e"># CONV 64 X2</span>
model<span style="color:#f92672">.</span>add(Conv2D(<span style="color:#ae81ff">64</span>, (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>), padding<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;same&#39;</span>))
model<span style="color:#f92672">.</span>add(Activation(<span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(Conv2D(<span style="color:#ae81ff">64</span>, (<span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">3</span>)))
model<span style="color:#f92672">.</span>add(Activation(<span style="color:#e6db74">&#39;relu&#39;</span>))
<span style="color:#75715e"># POOL</span>
model<span style="color:#f92672">.</span>add(MaxPooling2D(pool_size<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>)))
model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.25</span>))

<span style="color:#75715e"># Vectorize</span>
model<span style="color:#f92672">.</span>add(Flatten())
<span style="color:#75715e"># FC 512</span>
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">512</span>))
model<span style="color:#f92672">.</span>add(Activation(<span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(Dropout(<span style="color:#ae81ff">0.5</span>))
<span style="color:#75715e"># OUTPUT</span>
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">1</span>))
model<span style="color:#f92672">.</span>add(Activation(<span style="color:#e6db74">&#39;sigmoid&#39;</span>))

model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;binary_crossentropy&#39;</span>,
              optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>,
              metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>])</code></pre></div>
<pre><code>WARNING: Logging before flag parsing goes to stderr.
W0911 13:45:49.768144 140002765248320 deprecation.py:506] From /home/dataman/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/init_ops.py:1251: calling VarianceScaling.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
W0911 13:45:49.971888 140002765248320 deprecation.py:323] From /home/dataman/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/nn_impl.py:180: add_dispatch_support.&lt;locals&gt;.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
</code></pre>

<h3 id="ëª¨ë¸-í›ˆë ¨-train-model">ëª¨ë¸ í›ˆë ¨ (Train Model)</h3>

<p>ëª¨ë¸ì˜ í›ˆë ¨ ê²°ê³¼ë¥¼ íŒŒì¼ë¡œ ì €ì¥í•´ì„œ í•„ìš”í•  ë•Œ ì¬í›ˆë ¨ ì—†ì´ ë¶ˆëŸ¬ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì•„&hellip;<br />
GPU ì—†ìœ¼ë©´ í•œì‹œê°„ ì´ìƒ ê±¸ë¦°ë‹¤&hellip;<br />
ì»¤í”¼ í•œì” í•˜ê³  ì˜¤ì„¸ì—¬~</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">hist <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(x_train, y_train,
              batch_size<span style="color:#f92672">=</span>batch_size,
              epochs<span style="color:#f92672">=</span>epochs,
              shuffle<span style="color:#f92672">=</span>True,
              verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)

<span style="color:#75715e"># Save model and weights</span>
model_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(save_dir, model_name)
model<span style="color:#f92672">.</span>save(model_path)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Saved trained model at </span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> &#39;</span> <span style="color:#f92672">%</span> model_path)

train_acc <span style="color:#f92672">=</span> hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;acc&#39;</span>][<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
train_loss <span style="color:#f92672">=</span>  hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>][<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;train accuracy: &#39;</span>, train_acc)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;train loss: &#39;</span>, train_loss)</code></pre></div>
<pre><code>Saved trained model at /home/dataman/myWork/deeplearning/keras_catdog_trained_model.h5 
train accuracy:  0.9818
train loss:  0.05223268212089315
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>plot(hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;epoch&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;loss&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_22_0.png" alt="png" /></p>

<h3 id="ì •í™•ë„-í‰ê°€-test-model">ì •í™•ë„ í‰ê°€ (Test Model)</h3>

<p>í›ˆë ¨ ì •í™•ë„ì™€ í…ŒìŠ¤íŠ¸ ì •í™•ë„ì˜ ì°¨ì´ê°€ ë§ì´ ë‚œë‹¤.<br />
ê³¼ëŒ€ì í•©(Overfitting) í˜„ìƒì´ë‹¤.</p>

<p>ê·¸ë˜ë„ 10ë§ˆë¦¬ ì¤‘ 8ë§ˆë¦¬ëŠ” ë§ì¶˜ë‹¤ëŠ”&hellip;</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">test_loss, test_acc <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>evaluate(x_test, y_test, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Test loss:&#39;</span>, test_loss)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Test accuracy:&#39;</span>, test_acc)</code></pre></div>
<pre><code>Test loss: 0.7301398019790649
Test accuracy: 0.807
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd

df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data<span style="color:#f92672">=</span>[[train_acc, test_acc]], 
                  index <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;CNN&#39;</span>],
                  columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;train accuracy&#39;</span>, <span style="color:#e6db74">&#39;test accuracy&#39;</span>])
df</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>train accuracy</th>
      <th>test accuracy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CNN</td>
      <td>0.9818</td>
      <td>0.807</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="í•´ê²°-solution">í•´ê²° (Solution)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ê³ ê°ë‹˜~ ì›í•˜ì‹œëŠ” ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.<br />
test_imageì— ì´ë¯¸ì§€ë¥¼ ì…ë ¥í•˜ì‹œë©´<br />
ê³ ì–‘ì´, ê°•ì•„ì§€ë¥¼ ì¸ì‹í•´ì„œ ì•Œë ¤ ë“œë¦½ë‹ˆë‹¤</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span>  tensorflow.keras.models <span style="color:#f92672">import</span> load_model
<span style="color:#f92672">import</span> os

load_dir <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>getcwd()
model_name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;keras_catdog_trained_model.h5&#39;</span>
model_path <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>join(load_dir, model_name)

pick_image <span style="color:#f92672">=</span> <span style="color:#ae81ff">30</span> <span style="color:#75715e"># 0 ~ 9,999</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">predict_catdog</span>(x, model):
    x_data <span style="color:#f92672">=</span>(np<span style="color:#f92672">.</span>expand_dims(x, <span style="color:#ae81ff">0</span>))
    predict <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(x_data)
    <span style="color:#75715e">#print(predict)</span>
    <span style="color:#66d9ef">if</span> predict <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0.5</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;cat&#39;</span>
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;dog&#39;</span>

test_data <span style="color:#f92672">=</span> x_test[pick_image]
model <span style="color:#f92672">=</span> load_model(model_path)

result <span style="color:#f92672">=</span> predict_catdog(test_data, model)

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>))
plt<span style="color:#f92672">.</span>imshow(test_data)
plt<span style="color:#f92672">.</span>xticks([])
plt<span style="color:#f92672">.</span>yticks([])
plt<span style="color:#f92672">.</span>show()
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;This is a &#39;</span>, result)</code></pre></div>
<p><img src="output_28_0.png" alt="png" /></p>

<pre><code>This is a  dog
</code></pre>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/convolution/" rel="tag">Convolution</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/padding/" rel="tag">Padding</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/pooling/" rel="tag">Pooling</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/dropout/" rel="tag">Dropout</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/neural_network_mnist/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (NN) - MNIST</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/post/latent_factor_model/" rel="next"><span class="post-nav__caption">Next&thinsp;Â»</span><p class="post-nav__post-title">ì ì¬ ì¸ìˆ˜ ëª¨ë¸ (Latent Factor Model)</p></a>
	</div>
</nav>
<script src="https://utteranc.es/client.js"
        repo="skettee/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 skettee.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>