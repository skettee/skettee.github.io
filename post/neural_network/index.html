<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (Neural Network) - ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (Neural Network)" />
<meta property="og:description" content="ë”¥ëŸ¬ë‹ì˜ ì„¸ê³„ë¡œ ë“¤ì–´ê°€ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•˜ëŠ” ì„¸ë²ˆì§¸ ëª¨ë¸ì¸ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Neural Network)ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/neural_network/" />
<meta property="article:published_time" content="2019-08-29T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-08-29T00:00:00+00:00" />

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ" rel="home">
				<div class="logo__title">ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</div>
				<div class="logo__tagline">ë”¥ëŸ¬ë‹ ëª¨ë¸ë§</div>
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (Neural Network)</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2019-08-29T00:00:00">2019-08-29</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/deep-learning" rel="category">Deep Learning</a>, <a class="meta__link" href="/categories/neural-network" rel="category">Neural Network</a></span>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</a></li>
<li><a href="#ë‰´ëŸ´-ë„¤íŠ¸ì›Œí¬-neural-network-êµ¬ì„±">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Neural Network) êµ¬ì„±</a>
<ul>
<li><a href="#ë‰´ëŸ°-ëª¨ë¸-neuron-model">ë‰´ëŸ° ëª¨ë¸ (Neuron model)</a></li>
<li><a href="#ë‰´ëŸ´-ë„¤íŠ¸ì›ŒíŠ¸-neural-network">ë‰´ëŸ´ ë„¤íŠ¸ì›ŒíŠ¸ (Neural Network)</a></li>
</ul></li>
<li><a href="#ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</a></li>
<li><a href="#ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</a>
<ul>
<li><a href="#ì›-í•«-ì¸ì½”ë”©-one-hot-encoding">ì›-í•« ì¸ì½”ë”© (One-hot encoding)</a></li>
</ul></li>
<li><a href="#ë‰´ëŸ´-ë„¤íŠ¸ì›Œí¬-ëª¨ë¸ë§-nn-modeling">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ ëª¨ë¸ë§ (NN Modeling)</a>
<ul>
<li><a href="#ì†Œí”„íŠ¸ë§¥ìŠ¤-íšŒê·€-softmax-regression">ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ (Softmax Regression)</a></li>
<li><a href="#ì •ë¦¬">ì •ë¦¬</a></li>
</ul></li>
<li><a href="#ì¼€ë¼ìŠ¤-keras-ë¡œ-ëª¨ë¸ë§-modeling">ì¼€ë¼ìŠ¤(Keras)ë¡œ ëª¨ë¸ë§(Modeling)</a>
<ul>
<li><a href="#ì •ê·œí™”-normalization">ì •ê·œí™” (Normalization)</a></li>
<li><a href="#ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</a></li>
<li><a href="#ì†ì‹¤ê°’ì˜-ë³€í™”ë¥¼-ê·¸ë˜í”„ë¡œ-í™•ì¸">ì†ì‹¤ê°’ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”„ë¡œ í™•ì¸</a></li>
</ul></li>
<li><a href="#í•´ê²°-solution">í•´ê²° (Solution)</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<p>ë”¥ëŸ¬ë‹ì˜ ì„¸ê³„ë¡œ ë“¤ì–´ê°€ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•˜ëŠ” ì„¸ë²ˆì§¸ ëª¨ë¸ì¸ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Neural Network)ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!</p>

<p>ì‹¤ì œë¡œ ëŒë ¤ ë³´ê³  ì‹¶ìœ¼ë©´ êµ¬ê¸€ ì½”ë©ìœ¼ë¡œ ~</p>

<p><a href="https://colab.research.google.com/github/skettee/notebooks/blob/master/neural_network.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

<h2 id="ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</h2>

<p>ğŸ’° ê³ ê°</p>

<blockquote>
<p>ë•ë¶„ì— ì¹œì¶”ê°€ ë˜ì—ˆì–´ìš”. ê³ ë§ˆì›Œìš”~</p>

<p>ê·¸ ì¹œêµ¬ê°€ ìˆ™ì œë¥¼ ë¶€íƒí–ˆëŠ”ë°&hellip; í•´ê²°í•´ ì£¼ì„¸ìš”.</p>

<p>ì•„ë˜ì™€ ê°™ì´ ì…ë ¥ê³¼ ì¶œë ¥ì„ í•˜ëŠ” í”„ë¡œê·¸ë¨ì´ í•„ìš”í•´ìš”.</p>

<p>ì…ë ¥: 1 0 0 0 0 0 0 0 0 0, ì¶œë ¥: 0<br />
ì…ë ¥: 0 1 0 0 0 0 0 0 0 0, ì¶œë ¥: 1<br />
ì…ë ¥: 0 0 1 0 0 0 0 0 0 0, ì¶œë ¥: 2<br />
ì…ë ¥: 0 0 0 1 0 0 0 0 0 0, ì¶œë ¥: 3<br />
ì…ë ¥: 0 0 0 0 1 0 0 0 0 0, ì¶œë ¥: 4<br />
ì…ë ¥: 0 0 0 0 0 1 0 0 0 0, ì¶œë ¥: 5<br />
ì…ë ¥: 0 0 0 0 0 0 1 0 0 0, ì¶œë ¥: 6<br />
ì…ë ¥: 0 0 0 0 0 0 0 1 0 0, ì¶œë ¥: 7<br />
ì…ë ¥: 0 0 0 0 0 0 0 0 1 0, ì¶œë ¥: 8<br />
ì…ë ¥: 0 0 0 0 0 0 0 0 0 1, ì¶œë ¥: 9</p>

<p>ë°ì´í„°ëŠ” ì•„ë˜ì— ìˆì–´ìš”.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">input_data <span style="color:#f92672">=</span> [
    [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>],
]

output_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>]</code></pre></div>
<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ê±´ ì œê°€ ì½”ë”©í•´ì„œ ë°”ë¡œ ë§Œë“¤ì–´ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">human_coding</span>(x):
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(x)):
        <span style="color:#66d9ef">if</span> x[i] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            <span style="color:#66d9ef">return</span> i
    <span style="color:#66d9ef">return</span> None

test_data <span style="color:#f92672">=</span>  [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]
result <span style="color:#f92672">=</span> human_coding(test_data)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;input data is {} and ouput is {}&#39;</span><span style="color:#f92672">.</span>format(test_data, result))</code></pre></div>
<pre><code>input data is [0, 0, 0, 0, 0, 1, 0, 0, 0, 0] and ouput is 5
</code></pre>

<p>ğŸ’° ê³ ê°</p>

<blockquote>
<p>ì•„&hellip; ì¡°ê±´ì´ ìˆì–´ìš”.</p>

<p>2-ë ˆì´ì–´ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(NN)ë¡œ ë§Œë“¤ì–´ ì£¼ì„¸ìš”.<br />
íˆë“  ë ˆì´ì–´(hidden layer)ëŠ” 3ê°œì˜ ìœ ë‹›ë“¤(units)ë¡œ êµ¬ì„±ë˜ê²Œ í•´ ì£¼ì„¸ìš”.</p>
</blockquote>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ã……ã…‚</p>
</blockquote>

<h2 id="ë‰´ëŸ´-ë„¤íŠ¸ì›Œí¬-neural-network-êµ¬ì„±">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Neural Network) êµ¬ì„±</h2>

<h3 id="ë‰´ëŸ°-ëª¨ë¸-neuron-model">ë‰´ëŸ° ëª¨ë¸ (Neuron model)</h3>

<p>ë‰´ëŸ°(Neuron) ëª¨ë¸ ì€ ì•ì—ì„œ í•™ìŠµí•œ ë¡œì§€ìŠ¤í‹± ëª¨ë¸ê³¼ ê°™ë‹¤.<br />
ì˜ˆë¥¼ ë“¤ì–´ì„œ 3ê°œì˜ ë³€ìˆ˜(\(x_1\), \(x_2\), \(x_3\))ë¥¼ ì…ë ¥ ë°›ì„ ê²½ìš°<br />
\(z=w_{1}x_{1} + w_{2}x_{2} + w_{3}x_{3} + b\)ê°€ ë˜ê³ <br />
\(a=\sigma(z)\) ê°€ ëœë‹¤.<br />
ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ í‘œí˜„ ëœë‹¤.</p>

<p><img src="https://skettee.github.io/post/neural_network/neuron_model.png" alt="ë‰´ëŸ° ëª¨ë¸" /></p>

<h3 id="ë‰´ëŸ´-ë„¤íŠ¸ì›ŒíŠ¸-neural-network">ë‰´ëŸ´ ë„¤íŠ¸ì›ŒíŠ¸ (Neural Network)</h3>

<p>ë‰´ëŸ´ ë„¤íŠ¸ì›ŒíŠ¸(Neural Network)ëŠ”<br />
í•˜ë‚˜ì˜ ë‰´ëŸ°, ì¦‰ ë¡œì§€ìŠ¤í‹± ëª¨ë¸ì„ <strong>ìœ ë‹›(Unit)</strong> ì´ë¼ê³  í•˜ê³ <br />
ìœ ë‹›ë“¤ì„ ì„œë¡œ ì—°ê²°í•œ êµ¬ì¡°ì´ë‹¤.<br />
ìœ ë‹›ë“¤ì„ ëª¨ì•„ì„œ <strong>ë ˆì´ì–´(Layer)</strong> ë¥¼ í˜•ì„±í•˜ê³ <br />
ë ˆì´ì–´ë¥¼ ê³„ì†í•´ì„œ ìŒ“ì•„ê°€ëŠ” ëª¨ì–‘ì„ ê°€ì§€ê³  ìˆë‹¤.</p>

<p>ì•„ë˜ ê·¸ë¦¼ì€<br />
2-ë ˆì´ì–´ (2-layer) ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ì´ë‹¤.<br />
4ê°œì˜ ìœ ë‹›(4-units)ë“¤ë¡œ êµ¬ì„±ëœ íˆë“  ë ˆì´ì–´(hidden layer) 1ê°œì™€<br />
1ê°œì˜ ìœ ë‹›(1-unit)ìœ¼ë¡œ êµ¬ì„±ëœ ì¶œë ¥ ë ˆì´ì–´(output layer) 1ê°œë¡œ ë˜ì–´ ìˆë‹¤.</p>

<p><img src="https://skettee.github.io/post/neural_network/neural_network.png" alt="ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬" /></p>

<h2 id="ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</h2>

<p>ì´ ë¬¸ì œëŠ” ë°ì´í„°ì˜ ê·œì¹™ì— ë”°ë¼ ì¶œë ¥ê°’ì„ ê²°ì •í•˜ëŠ” ê²ƒì´ë‹¤.</p>

<p>10ê°œì˜ ì…ë ¥ê°’ ì¤‘ì—<br />
- ì²«ë²ˆì§¸ ì…ë ¥ê°’ì´ 1ì´ê³  ë‚˜ë¨¸ì§€ê°€ 0ì´ë©´ ì¶œë ¥ê°’ì€ 0<br />
- ë‘ë²ˆì§¸ ì…ë ¥ê°’ì´ 1ì´ê³  ë‚˜ë¨¸ì§€ê°€ 0ì´ë©´ ì¶œë ¥ê°’ì€ 1<br />
-   &hellip;</p>

<p>ì´ ê·œì¹™ì„ í•™ìŠµ ì‹œì¼œì„œ ì›í•˜ëŠ” ì¶œë ¥ê°’ìœ¼ë¡œ ë¶„ë¥˜í•˜ëŠ” ê²ƒì´ ëª©í‘œë‹¤.</p>

<h2 id="ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</h2>

<p>Kerasê°€ ì›í•˜ëŠ” ì…ë ¥ê³¼ ì¶œë ¥ì˜ ëª¨ì–‘(shape)ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<ul>
<li>(batch_size, input_dimension)<br /></li>
<li>batch_sizeëŠ” í•™ìŠµí•  ë°ì´í„°ì˜ ê°œìˆ˜ì´ë‹¤.<br /></li>
<li>input_demensionì€ í•™ìŠµì„ í•  ë•Œì— ì‚¬ìš©í•  ì…ë ¥ ë³€ìˆ˜ì˜ ê°œìˆ˜ì´ë‹¤.<br /></li>
</ul>

<p><strong>ì…ë ¥ ë°ì´í„° ë³€í™˜</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;batch_size= &#39;</span>, len(input_data))</code></pre></div>
<pre><code>batch_size=  10
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;input_dimension= &#39;</span>, len(input_data[<span style="color:#ae81ff">0</span>]))</code></pre></div>
<pre><code>input_dimension=  10
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(input_data)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;x.shape is &#39;</span>, x<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">x is </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, x)</code></pre></div>
<pre><code>x.shape is  (10, 10)

x is 
 [[1 0 0 0 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0 0 0]
 [0 0 1 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 0 0]
 [0 0 0 0 1 0 0 0 0 0]
 [0 0 0 0 0 1 0 0 0 0]
 [0 0 0 0 0 0 1 0 0 0]
 [0 0 0 0 0 0 0 1 0 0]
 [0 0 0 0 0 0 0 0 1 0]
 [0 0 0 0 0 0 0 0 0 1]]
</code></pre>

<p><strong>ì¶œë ¥ ë°ì´í„° ë³€í™˜</strong></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>yes or no ë¬¸ì œë¼ë©´ 0ê³¼ 1ë¡œ ë³€í™˜ í•˜ë©´ ëœë‹¤.<br />
ì´ë²ˆ ë¬¸ì œëŠ” 0ì—ì„œ 9ê¹Œì§€ 10ê°œë‹¤.<br />
ì¶œë ¥ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ë³€í™˜í•´ì•¼ í• ê¹Œ?</p>
</blockquote>

<h3 id="ì›-í•«-ì¸ì½”ë”©-one-hot-encoding">ì›-í•« ì¸ì½”ë”© (One-hot encoding)</h3>

<p>&lsquo;ê°•ì•„ì§€&rsquo;, &lsquo;ê³ ì–‘ì´&rsquo;, &lsquo;í† ë¼&rsquo;ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë¬¸ì œê°€ ìˆë‹¤ê³  í•˜ì<br />
ì†ì‹¤ í•¨ìˆ˜(loss function)ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œëŠ” ì¶œë ¥ ë°ì´í„°ë¥¼ ìˆ«ìë¡œ í‘œì‹œ í•´ì•¼ í•œë‹¤.</p>

<table>
<thead>
<tr>
<th>Label</th>
<th>ìˆ«ì</th>
</tr>
</thead>

<tbody>
<tr>
<td>ê°•ì•„ì§€</td>
<td>0</td>
</tr>

<tr>
<td>ê³ ì–‘ì´</td>
<td>1</td>
</tr>

<tr>
<td>í† ë¼</td>
<td>2</td>
</tr>
</tbody>
</table>

<p>ì‹œê·¸ëª¨ì´ë“œ(Sigmoid)ë‚˜ ì†Œí”„íŠ¸ë§¥ìŠ¤(softmax)ì™€ ê°™ì€ í™œì„± í•¨ìˆ˜(activation function)ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ê° ë ˆì´ë¸”(label)ì´ 0ê³¼ 1ë¡œ í‘œí˜„ ë˜ì–´ì•¼ í•œë‹¤. ì›-í•«-ì¸ì½”ë”©ì€ &lsquo;ê°•ì•„ì§€&rsquo;, &lsquo;ê³ ì–‘ì´&rsquo;, &lsquo;í† ë¼&rsquo;ë¥¼ 0ê³¼ 1ë¡œ í‘œí˜„í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<table>
<thead>
<tr>
<th>Label</th>
<th>ìˆ«ì</th>
<th>ì›-í•« ë²¡í„°</th>
</tr>
</thead>

<tbody>
<tr>
<td>ê°•ì•„ì§€</td>
<td>0</td>
<td>[1, 0, 0]</td>
</tr>

<tr>
<td>ê³ ì–‘ì´</td>
<td>1</td>
<td>[0, 1, 0]</td>
</tr>

<tr>
<td>í† ë¼</td>
<td>2</td>
<td>[0, 0, 1]</td>
</tr>
</tbody>
</table>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì•„í•˜~<br />
0ì—ì„œ 9ê¹Œì§€ì˜ ê°’ì„<br />
ì›-í•« ë²¡í„° (one-hot vector)ë¡œ í‘œì‹œí•˜ë©´ ë˜ê² êµ°</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras.utils <span style="color:#f92672">import</span> to_categorical

y <span style="color:#f92672">=</span> to_categorical(output_data)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;y.shape is &#39;</span>, y<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">one-hot encoded y is </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, y)</code></pre></div>
<pre><code>y.shape is  (10, 10)

one-hot encoded y is 
 [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]
</code></pre>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì—‡&hellip; ì–´ì–´&hellip; ì…ë ¥ ë°ì´í„°ì™€ ì¶œë ¥ ë°ì´í„°ê°€ ???</p>
</blockquote>

<h2 id="ë‰´ëŸ´-ë„¤íŠ¸ì›Œí¬-ëª¨ë¸ë§-nn-modeling">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ ëª¨ë¸ë§ (NN Modeling)</h2>

<p>ì…ë ¥ ë ˆì´ì–´(input layer)ëŠ” \(x_1\)ì—ì„œ \(x_{10}\)ê¹Œì§€ 10ê°œë¡œ ë˜ì–´ ìˆë‹¤.<br />
íˆë“  ë ˆì´ì–´(hidden layer)ëŠ” 3ê°œì˜ unitsë¡œ êµ¬ì„± í•œë‹¤.<br />
ì¶œë ¥ ë ˆì´ì–´(output layer)ëŠ” 10ê°œì˜ unitsë¡œ êµ¬ì„± í•œë‹¤.<br />
ê·¸ë¦¼ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì„ ë“¤ì´ ë¹ ì§ ì—†ì´ ì¡°ë°€í•˜ê²Œ ì—°ê²° ë˜ì–´ ìˆë‹¤.<br />
ìŒ&hellip; <strong>ë´ìŠ¤(Dense)</strong> í•˜ê²Œ ì—°ê²° ë˜ì–´ìˆêµ°&hellip;</p>
</blockquote>

<p><img src="https://skettee.github.io/post/neural_network/auto_coding_model.png" alt="ì˜¤í†  ì½”ë”© ëª¨ë¸" /></p>

<p>íˆë“  ë ˆì´ì–´ì— ìˆëŠ” ìœ ë‹›ë“¤ì˜ í™œì„±í•¨ìˆ˜(activation function)ëŠ” sigmoidë¡œ í•œë‹¤.<br />
ì¶œë ¥ ë ˆì´ì–´ì— ìˆëŠ” ìœ ë‹›ë“¤ì˜ í™œì„±í•¨ìˆ˜(activation function)ë¥¼ sigmoidë¡œ í•˜ë©´ <del>ã…ˆëœë‹¤</del>ì•ˆëœë‹¤.<br />
ì™œëƒí•˜ë©´<br />
ê° í™•ë¥ ì˜ ì´í•©ì€ 1ì´ ë‚˜ì™€ì•¼ í•˜ëŠ”ë°<br />
sigmoidëŠ”<br />
\(\hat y_{1}+\hat y_{2}+\hat y_{3}+&hellip;+\hat y_{9}+\hat y_{10}=1\) ì„ ë§Œì¡±í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ê±±ì •ë§ˆë¼.  ì—”ì§€ë‹ˆì–´ë¥¼ ê°ˆì•„ì„œ ë§Œë“  ê²ƒì´ ìˆë‹¤.<br />
 ê·¸ê²ƒì€ ë°”ë¡œ&hellip;</p>
</blockquote>

<h3 id="ì†Œí”„íŠ¸ë§¥ìŠ¤-íšŒê·€-softmax-regression">ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ (Softmax Regression)</h3>

<p>0ê³¼ 1, ë‘ê°€ì§€ì˜ ê²½ìš°ì— ëŒ€í•œ ë¶„ë¥˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€(logistic regression)ë¡œ ëª¨ë¸ë§ì„ í•œë‹¤.<br />
ì„¸ê°€ì§€ ì´ìƒì— ëŒ€í•œ ë¶„ë¥˜ëŠ” ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€(softmax regression)ë¡œ ëª¨ë¸ë§ì„ í•œë‹¤.<br />
ì†Œí”„íŠ¸ë§¥ìŠ¤ì˜ í™œì„± í•¨ìˆ˜(activation function)ëŠ” ì•„ë˜ì™€ ê°™ì´ ì •ì˜í•œë‹¤.</p>

<p>\(\begin{align}
z &amp; = w^{T}x+b, \\
a &amp; =\sigma(z) = {\dfrac{e^z}{\sum_{j=1}^{m} e^z}},
\end{align}\)</p>

<p>\(m\) = number of classes (ë¶„ë¥˜ ê°œìˆ˜)</p>

<p><strong>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ë¥¼ ì´ìš©í•œ ë¶„ë¥˜</strong></p>

<p>3ê°œë¡œ ë¶„ë¥˜ëœ ì•„ë˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  10X10 ê³µê°„ì„ 3ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•´ ë³´ì.<br />
ì—¬ê¸°ì„œ <strong>í´ë˜ìŠ¤(Class)</strong> ë€ &lsquo;ê³µí†µì ì¸ ì„±ì§ˆì„ ê°€ì§„ ì¢…ë¥˜&rsquo;ë¼ëŠ” ëœ»ì´ë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

x_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([
    (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>), (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">9</span>), 
    (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">9</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">9</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">9</span>), (<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">9</span>),
    (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">3</span>), (<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">1</span>),
    (<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">4</span>), (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">3</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">4</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">8</span>)
])

y_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([
    [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], 
    [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]
])

label_data <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;red&#39;</span>, <span style="color:#e6db74">&#39;green&#39;</span>, <span style="color:#e6db74">&#39;blue&#39;</span>]</code></pre></div>
<p>x_dataë¥¼ ê·¸ë˜í”„ë¡œ í‘œì‹œí•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.<br />
y_dataì—ì„œ [1,0,0]ì€ ë¹¨ê°•, [0,1,0]ì€ ì´ˆë¡, [0,0,1]ì€ íŒŒë‘ìœ¼ë¡œ í´ë˜ìŠ¤ë¥¼ êµ¬ë¶„í•œë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>matplotlib inline
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt

plt<span style="color:#f92672">.</span>scatter([x[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> x_data ], [x[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> x_data], color<span style="color:#f92672">=</span>[label_data[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> [np<span style="color:#f92672">.</span>argmax(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> y_data]])
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_25_0.png" alt="png" /></p>

<p>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì€ Kerasë¡œ ê°„ë‹¨í•˜ê²Œ ëª¨ë¸ë§í•  ìˆ˜ ìˆë‹¤.</p>

<p><img src="https://skettee.github.io/post/neural_network/softmax_regression.png" alt="ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸" /></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> Dense, Activation

<span style="color:#75715e"># ëª¨ë¸ì„ ì¤€ë¹„í•œë‹¤.</span>
model <span style="color:#f92672">=</span> Sequential()
<span style="color:#75715e"># ì…ë ¥ ë³€ìˆ˜ xê°€ 2ê°œ, unit ê°œìˆ˜ê°€ 3ê°œì¸ output layerë¥¼ ìƒì„±í•œë‹¤.</span>
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">3</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2</span>,), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;softmax&#39;</span>))
<span style="color:#75715e"># Loss funtionê³¼ Optimizerë¥¼ ì„ íƒí•œë‹¤.</span>
model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;categorical_crossentropy&#39;</span>, optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;rmsprop&#39;</span>)
<span style="color:#75715e"># epochsë§Œí¼ ë°˜ë³µí•´ì„œ ì†ì‹¤ê°’ì´ ìµœì €ê°€ ë˜ë„ë¡ ëª¨ë¸ì„ í›ˆë ¨í•œë‹¤.</span>
hist <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(x_data, y_data, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)</code></pre></div>
<p>ë°˜ë³µ í•™ìŠµí•  ìˆ˜ë¡ ì†ì‹¤ ê°’ì´ 0ì— ê°€ê¹ê²Œ ì¤„ì–´ ë“ ë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>plot(hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;epoch&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;loss&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_29_0.png" alt="png" /></p>

<p>ì²«ë²ˆì§¸ x ë°ì´í„° (1,4)ì— ëŒ€í•´ì„œ ì†Œí”„íŠ¸ë§¥ìŠ¤ê°€ ì˜ˆì¸¡í•œ ë°ì´í„°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.<br />
ì˜ˆì¸¡ëœ í™•ë¥ ì„ ëª¨ë‘ ë”í•˜ë©´ 1ì´ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">predict <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(x_data[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;y data is &#39;</span>, y_data[<span style="color:#ae81ff">0</span>])
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;predicted y data is &#39;</span>, predict[<span style="color:#ae81ff">0</span>])
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;sum of probability is &#39;</span>, np<span style="color:#f92672">.</span>sum(predict[<span style="color:#ae81ff">0</span>]))</code></pre></div>
<pre><code>y data is  [1 0 0]
predicted y data is  [0.980123   0.0051288  0.01474817]
sum of probability is  0.99999994
</code></pre>

<p>í•™ìŠµì´ ì™„ë£Œëœ ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì„ ì´ìš©í•´ì„œ<br />
10X10 ê³µê°„ì„ 3ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•œ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ ë³´ì.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x_data <span style="color:#f92672">=</span> []
y_data <span style="color:#f92672">=</span> []
c_data <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
        x_data<span style="color:#f92672">.</span>append(i)
        y_data<span style="color:#f92672">.</span>append(j)
        c_data<span style="color:#f92672">.</span>append(label_data[np<span style="color:#f92672">.</span>argmax(model<span style="color:#f92672">.</span>predict(np<span style="color:#f92672">.</span>array([i, j])<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>))[<span style="color:#ae81ff">0</span>])])

plt<span style="color:#f92672">.</span>scatter(x_data, y_data, color<span style="color:#f92672">=</span>c_data)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_33_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ìŠ¤ìŠ¤ë¡œ í•™ìŠµí•´ì„œ<br />
ê·¼ì²˜ì— ìˆëŠ” ë•…ì„ ìê¸°ê²ƒìœ¼ë¡œ ë§Œë“¤ë©´ì„œ<br />
ì²œí•˜ì‚¼ë¶„ì§€ê³„ í•˜ê³  ìˆë‹¤!!!</p>
</blockquote>

<h3 id="ì •ë¦¬">ì •ë¦¬</h3>

<p>ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ ëª¨ë¸(Neural Network model)ì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì •ë¦¬í•´ ë³´ì.</p>

<ol>
<li>ë°ì´í„°ë¥¼ ë³€í™˜í•œë‹¤.<br />

<ol>
<li>ì…ë ¥ ë°ì´í„°ì˜ í˜•ì‹ê³¼ ëª¨ì–‘ì„ ë³€í™˜í•œë‹¤.<br /></li>
<li>ì¶œë ¥ ë°ì´í„°ì˜ í˜•ì‹ê³¼ ëª¨ì–‘ì„ ë³€í™˜í•œë‹¤. <strong>ì›-í•« ì¸ì½”ë”©(one-hot encoding)</strong> ì„ ì‚¬ìš©í•œë‹¤.<br /></li>
</ol></li>
<li><strong>íˆë“  ë ˆì´ì–´(hidden layer)</strong>  ì •ì˜<br />

<ol>
<li>íˆë“  ë ˆì´ì–´ ê°œìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” 1-hidden layerë¥¼ ì‚¬ìš©í•œë‹¤.<br /></li>
<li>íˆë“  ë ˆì´ì–´ ìœ ë‹› ê°œìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” 3ê°œì´ ìœ ë‹›ì„ ì‚¬ìš©í•œë‹¤.<br /></li>
<li>í™œì„± í•¨ìˆ˜(activation function)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>ì‹œê·¸ëª¨ì´ë“œ(sigmoid)</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.<br /></li>
</ol></li>
<li><strong>ì¶œë ¥ ë ˆì´ì–´(output layer)</strong>  ì •ì˜<br />

<ol>
<li>ì¶œë ¥ ë ˆì´ì–´ ìœ ë‹› ê°œìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” 10ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•´ì•¼ ë˜ë‹ˆê¹Œ 10ê°œì˜ ìœ ë‹›ì„ ì‚¬ìš©í•œë‹¤.<br /></li>
<li>í™œì„± í•¨ìˆ˜(activation function)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>ì†Œí”„íŠ¸ë§¥ìŠ¤(softmax)</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.</li>
</ol></li>
<li>ì†ì‹¤ í•¨ìˆ˜ (Loss function)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>í¬ë¡œìŠ¤-ì—”íŠ¸ë¡œí”¼ ì†ì‹¤(cross-entropy loss)</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.<br /></li>
<li>ì˜µí‹°ë§ˆì´ì €(Optimizer)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>RMSProp</strong> ì„ ì‚¬ìš©í•œë‹¤.<br /></li>
<li>ë°˜ë³µí•  íšŒìˆ˜(epoch)ë¥¼ ê²°ì •í•œë‹¤.<br /></li>
<li>ì£¼ì–´ì§„ ì¡°ê±´ìœ¼ë¡œ ëª¨ë¸ì„ ìµœì í™”(fit) ì‹œí‚¨ë‹¤.<br /></li>
</ol>

<h2 id="ì¼€ë¼ìŠ¤-keras-ë¡œ-ëª¨ë¸ë§-modeling">ì¼€ë¼ìŠ¤(Keras)ë¡œ ëª¨ë¸ë§(Modeling)</h2>

<h3 id="ì •ê·œí™”-normalization">ì •ê·œí™” (Normalization)</h3>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì •ê·œí™” í• ê±° ì—†ìŒ!<br />
0ê³¼ 1ë¡œ ë˜ì–´ ìˆëŠ”ë° ë­”&hellip; í•„ìš”???</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">X_train <span style="color:#f92672">=</span> x
Y_train <span style="color:#f92672">=</span> y</code></pre></div>
<h3 id="ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</h3>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>5ì¤„ë¡œ ëª¨ë¸ë§ì´ ê°€ëŠ¥í•˜ë‹¤!</p>

<p>í”„ë‘ì†Œì™€ ìˆ„ë ˆ ë§Œì„¸!</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> Dense

<span style="color:#75715e"># ëª¨ë¸ì„ ì¤€ë¹„í•œë‹¤.</span>
model <span style="color:#f92672">=</span> Sequential()
<span style="color:#75715e"># unit ê°œìˆ˜ê°€ 3ì´ê³  ì…ë ¥ ë³€ìˆ˜ xê°€ 10ê°œì¸  hidden layerë¥¼ ìƒì„±í•˜ê³  denseí•˜ê²Œ ì—°ê²°í•œë‹¤.</span>
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">3</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sigmoid&#39;</span>))
<span style="color:#75715e"># unit ê°œìˆ˜ê°€ 10ì¸ output layerë¥¼ ìƒì„±í•˜ê³  denseí•˜ê²Œ ì—°ê²°í•œë‹¤.</span>
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">10</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;softmax&#39;</span>))
<span style="color:#75715e"># Loss funtionê³¼ Optimizerë¥¼ ì„ íƒí•œë‹¤.</span>
model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;categorical_crossentropy&#39;</span>, optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;rmsprop&#39;</span>)
<span style="color:#75715e"># epochsë§Œí¼ ë°˜ë³µí•´ì„œ ì†ì‹¤ê°’ì´ ìµœì €ê°€ ë˜ë„ë¡ ëª¨ë¸ì„ í›ˆë ¨í•œë‹¤.</span>
hist <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(X_train, Y_train, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)</code></pre></div>
<h3 id="ì†ì‹¤ê°’ì˜-ë³€í™”ë¥¼-ê·¸ë˜í”„ë¡œ-í™•ì¸">ì†ì‹¤ê°’ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”„ë¡œ í™•ì¸</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>plot(hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;epoch&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;loss&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_41_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë°˜ë³µì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ë¡ ì†ì‹¤(Loss)ì´ 0ì— ê°€ê¹ê²Œ ëœë‹¤.<br />
ë‚˜ì´ìŠ¤!</p>
</blockquote>

<h2 id="í•´ê²°-solution">í•´ê²° (Solution)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ê³ ê°ë‹˜~ ì›í•˜ì‹œëŠ” ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.<br />
test_dataì— ì›í•˜ì‹œëŠ” ê°’ì„ ì…ë ¥í•˜ì‹œë©´<br />
ì›í•˜ì‹œëŠ” ê²°ê³¼ê°’ì´ ì¶œë ¥ ë©ë‹ˆë‹¤.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">auto_coding</span>(x):
    input_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(x)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>)
    predict <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(input_data)
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>argmax(predict[<span style="color:#ae81ff">0</span>])

test_data <span style="color:#f92672">=</span>  [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]
result <span style="color:#f92672">=</span> auto_coding(test_data)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;input data is {} and ouput is {}&#39;</span><span style="color:#f92672">.</span>format(test_data, result))</code></pre></div>
<pre><code>input data is [0, 0, 0, 0, 0, 1, 0, 0, 0, 0] and ouput is 5
</code></pre>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë‚´ê°€ ë§Œë“  human_codingê³¼<br />
ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤</p>

<p>ì´ê²ƒì€<br />
íˆë“  ë ˆì´ì–´ì—ì„œ<br />
í•™ìŠµì— ì˜í•´ì„œ<br />
ìë™ìœ¼ë¡œ ì½”ë”©ì´ ë˜ì—ˆë‹¤ëŠ” ê²ƒì´ë‹¤.</p>

<p>ì—¬ê¸°ì„œ ë¬¸ì œëŠ”<br />
íˆë“  ë ˆì´ì–´ì—ì„œì˜ \(w\)ì™€ \(b\) ê°’ë“¤ì´<br />
ì™œ ì´ëŸ° ê°’ì„ ê°€ì§€ëŠ”ì§€<br />
ì¸ê°„ì€ ëª¨ë¥¸ë‹¤ëŠ” ê²ƒì´ë‹¤.<br />
ê·¸ë˜ì„œ<br />
Hidden(ìˆ¨ì€) ë ˆì´ì–´ ë¼ê³  í•œë‹¤.</p>
</blockquote>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/neuron/" rel="tag">Neuron</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/one-hot-encoding/" rel="tag">One-hot encoding</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/softmax/" rel="tag">Softmax</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/logistic_regression/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">ë¡œì§€ìŠ¤í‹± íšŒê·€ (Logistic Regression)</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/post/neural_network_mnist/" rel="next"><span class="post-nav__caption">Next&thinsp;Â»</span><p class="post-nav__post-title">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (NN) - MNIST</p></a>
	</div>
</nav>
<script src="https://utteranc.es/client.js"
        repo="skettee/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 skettee.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>