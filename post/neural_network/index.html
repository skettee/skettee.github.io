<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>뉴럴 네트워크 (Neural Network) - 막돼먹은 엔지니어의 머신런닝 개발</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="뉴럴 네트워크 (Neural Network)" />
<meta property="og:description" content="딥러닝의 세계로 들어가기 위해 알아야 하는 세번째 모델인 뉴럴 네트워크(Neural Network)에 대해 알아보고 keras를 이용해서 모델링을 해보자!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/neural_network/" />
<meta property="article:published_time" content="2019-08-29T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-08-29T00:00:00+00:00" />

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="막돼먹은 엔지니어의 머신런닝 개발" rel="home">
				<div class="logo__title">막돼먹은 엔지니어의 머신런닝 개발</div>
				<div class="logo__tagline">딥러닝 모델링</div>
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">뉴럴 네트워크 (Neural Network)</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2019-08-29T00:00:00">2019-08-29</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/deep-learning" rel="category">Deep Learning</a>, <a class="meta__link" href="/categories/neural-network" rel="category">Neural Network</a></span>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#문제-problem">문제 (Problem)</a></li>
<li><a href="#뉴럴-네트워크-neural-network-구성">뉴럴 네트워크(Neural Network) 구성</a>
<ul>
<li><a href="#뉴런-모델-neuron-model">뉴런 모델 (Neuron model)</a></li>
<li><a href="#뉴럴-네트워트-neural-network">뉴럴 네트워트 (Neural Network)</a></li>
</ul></li>
<li><a href="#데이터-분석-data-analysis">데이터 분석 (Data Analysis)</a></li>
<li><a href="#데이터-변환-data-transformation">데이터 변환 (Data Transformation)</a>
<ul>
<li><a href="#원-핫-인코딩-one-hot-encoding">원-핫 인코딩 (One-hot encoding)</a></li>
</ul></li>
<li><a href="#뉴럴-네트워크-모델링-nn-modeling">뉴럴 네트워크 모델링 (NN Modeling)</a>
<ul>
<li><a href="#소프트맥스-회귀-softmax-regression">소프트맥스 회귀 (Softmax Regression)</a></li>
<li><a href="#정리">정리</a></li>
</ul></li>
<li><a href="#케라스-keras-로-모델링-modeling">케라스(Keras)로 모델링(Modeling)</a>
<ul>
<li><a href="#정규화-normalization">정규화 (Normalization)</a></li>
<li><a href="#모델링-modeling">모델링 (Modeling)</a></li>
<li><a href="#손실값의-변화를-그래프로-확인">손실값의 변화를 그래프로 확인</a></li>
</ul></li>
<li><a href="#해결-solution">해결 (Solution)</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<p>딥러닝의 세계로 들어가기 위해 알아야 하는 세번째 모델인 뉴럴 네트워크(Neural Network)에 대해 알아보고 keras를 이용해서 모델링을 해보자!</p>

<p>실제로 돌려 보고 싶으면 구글 코랩으로 ~</p>

<p><a href="https://colab.research.google.com/github/skettee/notebooks/blob/master/neural_network.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

<h2 id="문제-problem">문제 (Problem)</h2>

<p>💰 고객</p>

<blockquote>
<p>덕분에 친추가 되었어요. 고마워요~</p>

<p>그 친구가 숙제를 부탁했는데&hellip; 해결해 주세요.</p>

<p>아래와 같이 입력과 출력을 하는 프로그램이 필요해요.</p>

<p>입력: 1 0 0 0 0 0 0 0 0 0, 출력: 0<br />
입력: 0 1 0 0 0 0 0 0 0 0, 출력: 1<br />
입력: 0 0 1 0 0 0 0 0 0 0, 출력: 2<br />
입력: 0 0 0 1 0 0 0 0 0 0, 출력: 3<br />
입력: 0 0 0 0 1 0 0 0 0 0, 출력: 4<br />
입력: 0 0 0 0 0 1 0 0 0 0, 출력: 5<br />
입력: 0 0 0 0 0 0 1 0 0 0, 출력: 6<br />
입력: 0 0 0 0 0 0 0 1 0 0, 출력: 7<br />
입력: 0 0 0 0 0 0 0 0 1 0, 출력: 8<br />
입력: 0 0 0 0 0 0 0 0 0 1, 출력: 9</p>

<p>데이터는 아래에 있어요.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">input_data <span style="color:#f92672">=</span> [
    [<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>],
]

output_data <span style="color:#f92672">=</span> [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">3</span>, <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">5</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">7</span>, <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">9</span>]</code></pre></div>
<p>⚙️ 엔지니어</p>

<blockquote>
<p>이건 제가 코딩해서 바로 만들어 드릴 수 있습니다!</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">human_coding</span>(x):
    <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(x)):
        <span style="color:#66d9ef">if</span> x[i] <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span>:
            <span style="color:#66d9ef">return</span> i
    <span style="color:#66d9ef">return</span> None

test_data <span style="color:#f92672">=</span>  [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]
result <span style="color:#f92672">=</span> human_coding(test_data)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;input data is {} and ouput is {}&#39;</span><span style="color:#f92672">.</span>format(test_data, result))</code></pre></div>
<pre><code>input data is [0, 0, 0, 0, 0, 1, 0, 0, 0, 0] and ouput is 5
</code></pre>

<p>💰 고객</p>

<blockquote>
<p>아&hellip; 조건이 있어요.</p>

<p>2-레이어 뉴럴 네트워크(NN)로 만들어 주세요.<br />
히든 레이어(hidden layer)는 3개의 유닛들(units)로 구성되게 해 주세요.</p>
</blockquote>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>ㅅㅂ</p>
</blockquote>

<h2 id="뉴럴-네트워크-neural-network-구성">뉴럴 네트워크(Neural Network) 구성</h2>

<h3 id="뉴런-모델-neuron-model">뉴런 모델 (Neuron model)</h3>

<p>뉴런(Neuron) 모델 은 앞에서 학습한 로지스틱 모델과 같다.<br />
예를 들어서 3개의 변수(\(x_1\), \(x_2\), \(x_3\))를 입력 받을 경우<br />
\(z=w_{1}x_{1} + w_{2}x_{2} + w_{3}x_{3} + b\)가 되고<br />
\(a=\sigma(z)\) 가 된다.<br />
아래 그림과 같이 표현 된다.</p>

<p><img src="https://skettee.github.io/post/neural_network/neuron_model.png" alt="뉴런 모델" /></p>

<h3 id="뉴럴-네트워트-neural-network">뉴럴 네트워트 (Neural Network)</h3>

<p>뉴럴 네트워트(Neural Network)는<br />
하나의 뉴런, 즉 로지스틱 모델을 <strong>유닛(Unit)</strong> 이라고 하고<br />
유닛들을 서로 연결한 구조이다.<br />
유닛들을 모아서 <strong>레이어(Layer)</strong> 를 형성하고<br />
레이어를 계속해서 쌓아가는 모양을 가지고 있다.</p>

<p>아래 그림은<br />
2-레이어 (2-layer) 뉴럴 네트워크이다.<br />
4개의 유닛(4-units)들로 구성된 히든 레이어(hidden layer) 1개와<br />
1개의 유닛(1-unit)으로 구성된 출력 레이어(output layer) 1개로 되어 있다.</p>

<p><img src="https://skettee.github.io/post/neural_network/neural_network.png" alt="뉴럴 네트워크" /></p>

<h2 id="데이터-분석-data-analysis">데이터 분석 (Data Analysis)</h2>

<p>이 문제는 데이터의 규칙에 따라 출력값을 결정하는 것이다.</p>

<p>10개의 입력값 중에<br />
- 첫번째 입력값이 1이고 나머지가 0이면 출력값은 0<br />
- 두번째 입력값이 1이고 나머지가 0이면 출력값은 1<br />
-   &hellip;</p>

<p>이 규칙을 학습 시켜서 원하는 출력값으로 분류하는 것이 목표다.</p>

<h2 id="데이터-변환-data-transformation">데이터 변환 (Data Transformation)</h2>

<p>Keras가 원하는 입력과 출력의 모양(shape)는 다음과 같다.</p>

<ul>
<li>(batch_size, input_dimension)<br /></li>
<li>batch_size는 학습할 데이터의 개수이다.<br /></li>
<li>input_demension은 학습을 할 때에 사용할 입력 변수의 개수이다.<br /></li>
</ul>

<p><strong>입력 데이터 변환</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;batch_size= &#39;</span>, len(input_data))</code></pre></div>
<pre><code>batch_size=  10
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;input_dimension= &#39;</span>, len(input_data[<span style="color:#ae81ff">0</span>]))</code></pre></div>
<pre><code>input_dimension=  10
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(input_data)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;x.shape is &#39;</span>, x<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">x is </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, x)</code></pre></div>
<pre><code>x.shape is  (10, 10)

x is 
 [[1 0 0 0 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0 0 0]
 [0 0 1 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 0 0]
 [0 0 0 0 1 0 0 0 0 0]
 [0 0 0 0 0 1 0 0 0 0]
 [0 0 0 0 0 0 1 0 0 0]
 [0 0 0 0 0 0 0 1 0 0]
 [0 0 0 0 0 0 0 0 1 0]
 [0 0 0 0 0 0 0 0 0 1]]
</code></pre>

<p><strong>출력 데이터 변환</strong></p>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>yes or no 문제라면 0과 1로 변환 하면 된다.<br />
이번 문제는 0에서 9까지 10개다.<br />
출력 데이터를 어떻게 변환해야 할까?</p>
</blockquote>

<h3 id="원-핫-인코딩-one-hot-encoding">원-핫 인코딩 (One-hot encoding)</h3>

<p>&lsquo;강아지&rsquo;, &lsquo;고양이&rsquo;, &lsquo;토끼&rsquo;를 분류하는 문제가 있다고 하자<br />
손실 함수(loss function)를 계산하기 위해서는 출력 데이터를 숫자로 표시 해야 한다.</p>

<table>
<thead>
<tr>
<th>Label</th>
<th>숫자</th>
</tr>
</thead>

<tbody>
<tr>
<td>강아지</td>
<td>0</td>
</tr>

<tr>
<td>고양이</td>
<td>1</td>
</tr>

<tr>
<td>토끼</td>
<td>2</td>
</tr>
</tbody>
</table>

<p>시그모이드(Sigmoid)나 소프트맥스(softmax)와 같은 활성 함수(activation function)을 사용하기 위해서는 각 레이블(label)이 0과 1로 표현 되어야 한다. 원-핫-인코딩은 &lsquo;강아지&rsquo;, &lsquo;고양이&rsquo;, &lsquo;토끼&rsquo;를 0과 1로 표현하는 방법이다.</p>

<table>
<thead>
<tr>
<th>Label</th>
<th>숫자</th>
<th>원-핫 벡터</th>
</tr>
</thead>

<tbody>
<tr>
<td>강아지</td>
<td>0</td>
<td>[1, 0, 0]</td>
</tr>

<tr>
<td>고양이</td>
<td>1</td>
<td>[0, 1, 0]</td>
</tr>

<tr>
<td>토끼</td>
<td>2</td>
<td>[0, 0, 1]</td>
</tr>
</tbody>
</table>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>아하~<br />
0에서 9까지의 값을<br />
원-핫 벡터 (one-hot vector)로 표시하면 되겠군</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras.utils <span style="color:#f92672">import</span> to_categorical

y <span style="color:#f92672">=</span> to_categorical(output_data)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;y.shape is &#39;</span>, y<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">one-hot encoded y is </span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span>, y)</code></pre></div>
<pre><code>y.shape is  (10, 10)

one-hot encoded y is 
 [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]
</code></pre>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>엇&hellip; 어어&hellip; 입력 데이터와 출력 데이터가 ???</p>
</blockquote>

<h2 id="뉴럴-네트워크-모델링-nn-modeling">뉴럴 네트워크 모델링 (NN Modeling)</h2>

<p>입력 레이어(input layer)는 \(x_1\)에서 \(x_{10}\)까지 10개로 되어 있다.<br />
히든 레이어(hidden layer)는 3개의 units로 구성 한다.<br />
출력 레이어(output layer)는 10개의 units로 구성 한다.<br />
그림으로 나타내면 다음과 같다.</p>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>선들이 빠짐 없이 조밀하게 연결 되어 있다.<br />
음&hellip; <strong>덴스(Dense)</strong> 하게 연결 되어있군&hellip;</p>
</blockquote>

<p><img src="https://skettee.github.io/post/neural_network/auto_coding_model.png" alt="오토 코딩 모델" /></p>

<p>히든 레이어에 있는 유닛들의 활성함수(activation function)는 sigmoid로 한다.<br />
출력 레이어에 있는 유닛들의 활성함수(activation function)를 sigmoid로 하면 <del>ㅈ된다</del>안된다.<br />
왜냐하면<br />
각 확률의 총합은 1이 나와야 하는데<br />
sigmoid는<br />
\(\hat y_{1}+\hat y_{2}+\hat y_{3}+&hellip;+\hat y_{9}+\hat y_{10}=1\) 을 만족하지 않는다.</p>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>걱정마라.  엔지니어를 갈아서 만든 것이 있다.<br />
 그것은 바로&hellip;</p>
</blockquote>

<h3 id="소프트맥스-회귀-softmax-regression">소프트맥스 회귀 (Softmax Regression)</h3>

<p>0과 1, 두가지의 경우에 대한 분류는 로지스틱 회귀(logistic regression)로 모델링을 한다.<br />
세가지 이상에 대한 분류는 소프트맥스 회귀(softmax regression)로 모델링을 한다.<br />
소프트맥스의 활성 함수(activation function)는 아래와 같이 정의한다.</p>

<p>\(\begin{align}
z &amp; = w^{T}x+b, \\
a &amp; =\sigma(z) = {\dfrac{e^z}{\sum_{j=1}^{m} e^z}},
\end{align}\)</p>

<p>\(m\) = number of classes (분류 개수)</p>

<p><strong>소프트맥스 회귀를 이용한 분류</strong></p>

<p>3개로 분류된 아래 데이터를 가지고 10X10 공간을 3개의 클래스로 분류해 보자.<br />
여기서 <strong>클래스(Class)</strong> 란 &lsquo;공통적인 성질을 가진 종류&rsquo;라는 뜻이다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

x_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([
    (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">4</span>), (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">9</span>), 
    (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">9</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">9</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">8</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">9</span>), (<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">9</span>),
    (<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">3</span>), (<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">6</span>,<span style="color:#ae81ff">2</span>), (<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">1</span>), (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">1</span>),
    (<span style="color:#ae81ff">7</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">4</span>), (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">3</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">4</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">5</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">6</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">7</span>), (<span style="color:#ae81ff">9</span>,<span style="color:#ae81ff">8</span>)
])

y_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([
    [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], 
    [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">0</span>],
    [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>], [<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">1</span>]
])

label_data <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;red&#39;</span>, <span style="color:#e6db74">&#39;green&#39;</span>, <span style="color:#e6db74">&#39;blue&#39;</span>]</code></pre></div>
<p>x_data를 그래프로 표시하면 아래와 같다.<br />
y_data에서 [1,0,0]은 빨강, [0,1,0]은 초록, [0,0,1]은 파랑으로 클래스를 구분한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>matplotlib inline
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt

plt<span style="color:#f92672">.</span>scatter([x[<span style="color:#ae81ff">0</span>] <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> x_data ], [x[<span style="color:#ae81ff">1</span>] <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> x_data], color<span style="color:#f92672">=</span>[label_data[i] <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> [np<span style="color:#f92672">.</span>argmax(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> y_data]])
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_25_0.png" alt="png" /></p>

<p>소프트맥스 회귀 모델은 Keras로 간단하게 모델링할 수 있다.</p>

<p><img src="https://skettee.github.io/post/neural_network/softmax_regression.png" alt="소프트맥스 회귀 모델" /></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> Dense, Activation

<span style="color:#75715e"># 모델을 준비한다.</span>
model <span style="color:#f92672">=</span> Sequential()
<span style="color:#75715e"># 입력 변수 x가 2개, unit 개수가 3개인 output layer를 생성한다.</span>
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">3</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">2</span>,), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;softmax&#39;</span>))
<span style="color:#75715e"># Loss funtion과 Optimizer를 선택한다.</span>
model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;categorical_crossentropy&#39;</span>, optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;rmsprop&#39;</span>)
<span style="color:#75715e"># epochs만큼 반복해서 손실값이 최저가 되도록 모델을 훈련한다.</span>
hist <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(x_data, y_data, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">1000</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)</code></pre></div>
<p>반복 학습할 수록 손실 값이 0에 가깝게 줄어 든다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>plot(hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;epoch&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;loss&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_29_0.png" alt="png" /></p>

<p>첫번째 x 데이터 (1,4)에 대해서 소프트맥스가 예측한 데이터는 다음과 같다.<br />
예측된 확률을 모두 더하면 1이 되는 것을 확인할 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">predict <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(x_data[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>))
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;y data is &#39;</span>, y_data[<span style="color:#ae81ff">0</span>])
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;predicted y data is &#39;</span>, predict[<span style="color:#ae81ff">0</span>])
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;sum of probability is &#39;</span>, np<span style="color:#f92672">.</span>sum(predict[<span style="color:#ae81ff">0</span>]))</code></pre></div>
<pre><code>y data is  [1 0 0]
predicted y data is  [0.980123   0.0051288  0.01474817]
sum of probability is  0.99999994
</code></pre>

<p>학습이 완료된 소프트맥스 회귀 모델을 이용해서<br />
10X10 공간을 3개의 클래스로 분류한 그래프를 그려 보자.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x_data <span style="color:#f92672">=</span> []
y_data <span style="color:#f92672">=</span> []
c_data <span style="color:#f92672">=</span> []
<span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
    <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">10</span>):
        x_data<span style="color:#f92672">.</span>append(i)
        y_data<span style="color:#f92672">.</span>append(j)
        c_data<span style="color:#f92672">.</span>append(label_data[np<span style="color:#f92672">.</span>argmax(model<span style="color:#f92672">.</span>predict(np<span style="color:#f92672">.</span>array([i, j])<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">2</span>))[<span style="color:#ae81ff">0</span>])])

plt<span style="color:#f92672">.</span>scatter(x_data, y_data, color<span style="color:#f92672">=</span>c_data)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_33_0.png" alt="png" /></p>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>스스로 학습해서<br />
근처에 있는 땅을 자기것으로 만들면서<br />
천하삼분지계 하고 있다!!!</p>
</blockquote>

<h3 id="정리">정리</h3>

<p>뉴럴 네트워크 모델(Neural Network model)을 만드는 방법을 정리해 보자.</p>

<ol>
<li>데이터를 변환한다.<br />

<ol>
<li>입력 데이터의 형식과 모양을 변환한다.<br /></li>
<li>출력 데이터의 형식과 모양을 변환한다. <strong>원-핫 인코딩(one-hot encoding)</strong> 을 사용한다.<br /></li>
</ol></li>
<li><strong>히든 레이어(hidden layer)</strong>  정의<br />

<ol>
<li>히든 레이어 개수를 정의한다. 여기서는 1-hidden layer를 사용한다.<br /></li>
<li>히든 레이어 유닛 개수를 정의한다. 여기서는 3개이 유닛을 사용한다.<br /></li>
<li>활성 함수(activation function)를 정의한다. 여기서는 <strong>시그모이드(sigmoid)</strong> 를 사용한다.<br /></li>
</ol></li>
<li><strong>출력 레이어(output layer)</strong>  정의<br />

<ol>
<li>출력 레이어 유닛 개수를 정의한다. 여기서는 10개의 클래스로 분류해야 되니까 10개의 유닛을 사용한다.<br /></li>
<li>활성 함수(activation function)를 정의한다. 여기서는 <strong>소프트맥스(softmax)</strong> 를 사용한다.</li>
</ol></li>
<li>손실 함수 (Loss function)를 정의한다. 여기서는 <strong>크로스-엔트로피 손실(cross-entropy loss)</strong> 를 사용한다.<br /></li>
<li>옵티마이저(Optimizer)를 정의한다. 여기서는 <strong>RMSProp</strong> 을 사용한다.<br /></li>
<li>반복할 회수(epoch)를 결정한다.<br /></li>
<li>주어진 조건으로 모델을 최적화(fit) 시킨다.<br /></li>
</ol>

<h2 id="케라스-keras-로-모델링-modeling">케라스(Keras)로 모델링(Modeling)</h2>

<h3 id="정규화-normalization">정규화 (Normalization)</h3>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>정규화 할거 없음!<br />
0과 1로 되어 있는데 뭔&hellip; 필요???</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">X_train <span style="color:#f92672">=</span> x
Y_train <span style="color:#f92672">=</span> y</code></pre></div>
<h3 id="모델링-modeling">모델링 (Modeling)</h3>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>5줄로 모델링이 가능하다!</p>

<p>프랑소와 숄레 만세!</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> Dense

<span style="color:#75715e"># 모델을 준비한다.</span>
model <span style="color:#f92672">=</span> Sequential()
<span style="color:#75715e"># unit 개수가 3이고 입력 변수 x가 10개인  hidden layer를 생성하고 dense하게 연결한다.</span>
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">3</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">10</span>,), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sigmoid&#39;</span>))
<span style="color:#75715e"># unit 개수가 10인 output layer를 생성하고 dense하게 연결한다.</span>
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">10</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;softmax&#39;</span>))
<span style="color:#75715e"># Loss funtion과 Optimizer를 선택한다.</span>
model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;categorical_crossentropy&#39;</span>, optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;rmsprop&#39;</span>)
<span style="color:#75715e"># epochs만큼 반복해서 손실값이 최저가 되도록 모델을 훈련한다.</span>
hist <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(X_train, Y_train, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)</code></pre></div>
<h3 id="손실값의-변화를-그래프로-확인">손실값의 변화를 그래프로 확인</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>plot(hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;epoch&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;loss&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_41_0.png" alt="png" /></p>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>반복적으로 학습할 수록 손실(Loss)이 0에 가깝게 된다.<br />
나이스!</p>
</blockquote>

<h2 id="해결-solution">해결 (Solution)</h2>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>고객님~ 원하시는 솔루션입니다.<br />
test_data에 원하시는 값을 입력하시면<br />
원하시는 결과값이 출력 됩니다.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">auto_coding</span>(x):
    input_data <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(x)<span style="color:#f92672">.</span>reshape(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">10</span>)
    predict <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(input_data)
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>argmax(predict[<span style="color:#ae81ff">0</span>])

test_data <span style="color:#f92672">=</span>  [<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">0</span>]
result <span style="color:#f92672">=</span> auto_coding(test_data)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;input data is {} and ouput is {}&#39;</span><span style="color:#f92672">.</span>format(test_data, result))</code></pre></div>
<pre><code>input data is [0, 0, 0, 0, 0, 1, 0, 0, 0, 0] and ouput is 5
</code></pre>

<p>⚙️ 엔지니어</p>

<blockquote>
<p>내가 만든 human_coding과<br />
같은 결과가 나온다</p>

<p>이것은<br />
히든 레이어에서<br />
학습에 의해서<br />
자동으로 코딩이 되었다는 것이다.</p>

<p>여기서 문제는<br />
히든 레이어에서의 \(w\)와 \(b\) 값들이<br />
왜 이런 값을 가지는지<br />
인간은 모른다는 것이다.<br />
그래서<br />
Hidden(숨은) 레이어 라고 한다.</p>
</blockquote>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/neuron/" rel="tag">Neuron</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/one-hot-encoding/" rel="tag">One-hot encoding</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/softmax/" rel="tag">Softmax</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/logistic_regression/" rel="prev"><span class="post-nav__caption">«&thinsp;Previous</span><p class="post-nav__post-title">로지스틱 회귀 (Logistic Regression)</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/post/neural_network_mnist/" rel="next"><span class="post-nav__caption">Next&thinsp;»</span><p class="post-nav__post-title">뉴럴 네트워크 (NN) - MNIST</p></a>
	</div>
</nav>
<script src="https://utteranc.es/client.js"
        repo="skettee/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 skettee.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>