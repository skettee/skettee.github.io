<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (Neural Network) - ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œê¸°</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (Neural Network)" />
<meta property="og:description" content="ë”¥ëŸ¬ë‹ì˜ ì„¸ê³„ë¡œ ë“¤ì–´ê°€ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•˜ëŠ” ì„¸ë²ˆì§¸ ëª¨ë¸ì¸ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Neural Network)ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/neural_network/" />


	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/agate.min.css">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
	<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js"></script>
  	<script>hljs.initHighlightingOnLoad();</script>
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œê¸°" rel="home">
				<div class="logo__title">ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œê¸°</div>
				<div class="logo__tagline">ë”¥ëŸ¬ë‹ ëª¨ë¸ë§</div>
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (Neural Network)</h1>
			<div class="post__meta meta">
<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/deep-learning" rel="category">Deep Learning</a>, <a class="meta__link" href="/categories/neural-network" rel="category">Neural Network</a></span>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</a></li>
<li><a href="#ë‰´ëŸ´-ë„¤íŠ¸ì›Œí¬-neural-network-êµ¬ì„±">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Neural Network) êµ¬ì„±</a></li>
<li><a href="#ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</a></li>
<li><a href="#ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</a>
<ul>
<li><a href="#ì›-í•«-ì¸ì½”ë”©-one-hot-encoding">ì›-í•« ì¸ì½”ë”© (One-hot encoding)</a></li>
</ul></li>
<li><a href="#ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</a>
<ul>
<li><a href="#ì†Œí”„íŠ¸ë§¥ìŠ¤-íšŒê·€-softmax-regression">ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ (Softmax Regression)</a></li>
<li><a href="#ì •ë¦¬">ì •ë¦¬</a></li>
</ul></li>
<li><a href="#í…ì„œí”Œë¡œìš°-tensorflow-ë¡œ-ëª¨ë¸ë§-modeling">í…ì„œí”Œë¡œìš°(Tensorflow)ë¡œ ëª¨ë¸ë§(Modeling)</a>
<ul>
<li><a href="#ì •ê·œí™”-normalization"><del>ì •ê·œí™” (Normalization)</del></a></li>
<li><a href="#kerasë¥¼-ê°€ì§€ê³ -ëª¨ë¸ë§-modeling-í•˜ê¸°">Kerasë¥¼ ê°€ì§€ê³  ëª¨ë¸ë§(Modeling)í•˜ê¸°</a></li>
<li><a href="#ì†ì‹¤ê°’ì˜-ë³€í™”ë¥¼-ê·¸ë˜í”„ë¡œ-í™•ì¸">ì†ì‹¤ê°’ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”„ë¡œ í™•ì¸</a></li>
</ul></li>
<li><a href="#í•´ê²°-solution">í•´ê²° (Solution)</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<p>ë”¥ëŸ¬ë‹ì˜ ì„¸ê³„ë¡œ ë“¤ì–´ê°€ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•˜ëŠ” ì„¸ë²ˆì§¸ ëª¨ë¸ì¸ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Neural Network)ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!</p>

<p>ì‹¤ì œë¡œ ëŒë ¤ ë³´ê³  ì‹¶ìœ¼ë©´ êµ¬ê¸€ ì½”ë©ìœ¼ë¡œ ~</p>

<p><a href="https://colab.research.google.com/github/skettee/notebooks/blob/master/neural_network.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

<h2 id="ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</h2>

<p>ğŸ’° ê³ ê°</p>

<blockquote>
<p>ë•ë¶„ì— ì¹œì¶”ê°€ ë˜ì—ˆì–´ìš”. ê³ ë§ˆì›Œìš”~</p>

<p>ê·¸ ì¹œêµ¬ê°€ ìˆ™ì œë¥¼ ë¶€íƒí–ˆëŠ”ë°&hellip; í•´ê²°í•´ ì£¼ì„¸ìš”.</p>

<p>ì•„ë˜ì™€ ê°™ì´ ì…ë ¥ê³¼ ì¶œë ¥ì„ í•˜ëŠ” í”„ë¡œê·¸ë¨ì´ í•„ìš”í•´ìš”.</p>

<p>ì…ë ¥: 1 0 0 0 0 0 0 0 0 0, ì¶œë ¥: 0<br />
ì…ë ¥: 0 1 0 0 0 0 0 0 0 0, ì¶œë ¥: 1<br />
ì…ë ¥: 0 0 1 0 0 0 0 0 0 0, ì¶œë ¥: 2<br />
ì…ë ¥: 0 0 0 1 0 0 0 0 0 0, ì¶œë ¥: 3<br />
ì…ë ¥: 0 0 0 0 1 0 0 0 0 0, ì¶œë ¥: 4<br />
ì…ë ¥: 0 0 0 0 0 1 0 0 0 0, ì¶œë ¥: 5<br />
ì…ë ¥: 0 0 0 0 0 0 1 0 0 0, ì¶œë ¥: 6<br />
ì…ë ¥: 0 0 0 0 0 0 0 1 0 0, ì¶œë ¥: 7<br />
ì…ë ¥: 0 0 0 0 0 0 0 0 1 0, ì¶œë ¥: 8<br />
ì…ë ¥: 0 0 0 0 0 0 0 0 0 1, ì¶œë ¥: 9</p>

<p>ë°ì´í„°ëŠ” ì•„ë˜ì— ìˆì–´ìš”.</p>
</blockquote>

<pre><code class="language-python">input_data = [
    [1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 1, 0, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 1, 0, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 1, 0, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 1, 0, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 1, 0, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 1, 0, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 1, 0],
    [0, 0, 0, 0, 0, 0, 0, 0, 0, 1],
]

output_data = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
</code></pre>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ê±´ ì œê°€ ì½”ë”©í•´ì„œ ë°”ë¡œ ë§Œë“¤ì–´ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤!</p>
</blockquote>

<pre><code class="language-python">import numpy as np

def human_coding(x):
    for i in range(len(x)):
        if x[i] == 1:
            return i
    return None

test_data =  [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]
result = human_coding(test_data)
print('input data is {} and ouput is {}'.format(test_data, result))
</code></pre>

<pre><code>input data is [0, 0, 0, 0, 0, 1, 0, 0, 0, 0] and ouput is 5
</code></pre>

<p>ğŸ’° ê³ ê°</p>

<blockquote>
<p>ì•„&hellip; ì¡°ê±´ì´ ìˆì–´ìš”.</p>

<p>2-ë ˆì´ì–´ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(NN)ë¡œ ë§Œë“¤ì–´ ì£¼ì„¸ìš”.<br />
íˆë“  ë ˆì´ì–´(hidden layer)ëŠ” 3ê°œì˜ ìœ ë‹›ë“¤(units)ë¡œ êµ¬ì„±ë˜ê²Œ í•´ ì£¼ì„¸ìš”.</p>
</blockquote>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ã……ã…‚</p>
</blockquote>

<h2 id="ë‰´ëŸ´-ë„¤íŠ¸ì›Œí¬-neural-network-êµ¬ì„±">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Neural Network) êµ¬ì„±</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p><strong>ë‰´ëŸ°(Neuron) ëª¨ë¸</strong> ì€ ì•ì—ì„œ í•™ìŠµí•œ ë¡œì§€ìŠ¤í‹± ëª¨ë¸ê³¼ ê°™ë‹¤.<br />
ì˜ˆë¥¼ ë“¤ì–´ì„œ 3ê°œì˜ ë³€ìˆ˜(\(x_1\), \(x_2\), \(x_3\))ë¥¼ ì…ë ¥ ë°›ì„ ê²½ìš°<br />
\(z=w_{1}x_{1} + w_{2}x_{2} + w_{3}x_{3} + b\)ê°€ ë˜ê³ <br />
\(a=\sigma(z)\) ê°€ ëœë‹¤.<br />
ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ì´ í‘œí˜„ ëœë‹¤.</p>
</blockquote>

<p><img src="https://skettee.github.io/post/neural_network/neuron_model.png" alt="ë‰´ëŸ° ëª¨ë¸" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p><strong>ë‰´ëŸ´ ë„¤íŠ¸ì›ŒíŠ¸(Neural Network)</strong> ëŠ”<br />
í•˜ë‚˜ì˜ ë‰´ëŸ°, ì¦‰ ë¡œì§€ìŠ¤í‹± ëª¨ë¸ì„ <strong>ìœ ë‹›(Unit)</strong> ì´ë¼ê³  í•˜ê³ <br />
ìœ ë‹›ë“¤ì„ ì„œë¡œ ì—°ê²°í•œ êµ¬ì¡°ì´ë‹¤.<br />
ìœ ë‹›ë“¤ì„ ëª¨ì•„ì„œ <strong>ë ˆì´ì–´(Layer)</strong> ë¥¼ í˜•ì„±í•˜ê³ <br />
ë ˆì´ì–´ë¥¼ (ì˜¤ë¥¸ìª½ìœ¼ë¡œ) ê³„ì†í•´ì„œ ìŒ“ì•„ê°€ëŠ” ëª¨ì–‘ì„ ê°€ì§€ê³  ìˆë‹¤.</p>

<p>ì•„ë˜ ê·¸ë¦¼ì€<br />
2-ë ˆì´ì–´ (2-layer) ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ì´ë‹¤.<br />
4ê°œì˜ ìœ ë‹›(4-units)ë“¤ë¡œ êµ¬ì„±ëœ íˆë“  ë ˆì´ì–´(hidden layer) 1ê°œì™€<br />
1ê°œì˜ ìœ ë‹›(1-unit)ìœ¼ë¡œ êµ¬ì„±ëœ ì¶œë ¥ ë ˆì´ì–´(output layer) 1ê°œë¡œ ë˜ì–´ ìˆë‹¤.</p>
</blockquote>

<p><img src="https://skettee.github.io/post/neural_network/neural_network.png" alt="ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬" /></p>

<h2 id="ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ ë¬¸ì œëŠ” ë°ì´í„°ì˜ ê·œì¹™ì— ë”°ë¼ ì¶œë ¥ê°’ì„ ê²°ì •í•˜ëŠ” ê²ƒì´ë‹¤.<br />
&gt;    10ê°œì˜ ì…ë ¥ê°’ ì¤‘ì—<br />
&gt;    ì²«ë²ˆì§¸ ì…ë ¥ê°’ì´ 1ì´ê³  ë‚˜ë¨¸ì§€ê°€ 0ì´ë©´ ì¶œë ¥ê°’ì€ 0<br />
&gt;    ë‘ë²ˆì§¸ ì…ë ¥ê°’ì´ 1ì´ê³  ë‚˜ë¨¸ì§€ê°€ 0ì´ë©´ ì¶œë ¥ê°’ì€ 1<br />
&gt;    &hellip;</p>

<p>ì´ ê·œì¹™ì„ í•™ìŠµ ì‹œì¼œì„œ ì›í•˜ëŠ” ì¶œë ¥ê°’ìœ¼ë¡œ ë¶„ë¥˜í•˜ëŠ” ê²ƒì´ ëª©í‘œë‹¤.</p>
</blockquote>

<h2 id="ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</h2>

<p>Keras, tensorflowë“±ì˜ ë¨¸ì‹ ëŸ°ë‹ í”„ë ˆì„ì›Œí¬ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ”<br />
ê°ê°ì´ ìš”êµ¬í•˜ëŠ” ë°ì´í„°ì˜ í˜•ì‹ ë° ëª¨ì–‘ì— ë§ì¶”ì–´ì„œ ë³€í™˜ì„ í•´ ì£¼ì–´ì•¼ í•œë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>Kerasê°€ ì›í•˜ëŠ” ì…ë ¥ê³¼ ì¶œë ¥ì˜ ëª¨ì–‘(shape)ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.<br />
(batch_size, input_dimension)<br />
batch_sizeëŠ” í•™ìŠµí•  ë°ì´í„°ì˜ ê°œìˆ˜ì´ë‹¤.<br />
input_demensionì€ í•™ìŠµì„ í•  ë•Œì— ì‚¬ìš©í•  ì…ë ¥ ë³€ìˆ˜ì˜ ê°œìˆ˜ì´ë‹¤.</p>
</blockquote>

<p><strong>ì…ë ¥ ë°ì´í„° ë³€í™˜</strong></p>

<pre><code class="language-python">print('batch_size= ', len(input_data))
</code></pre>

<pre><code>batch_size=  10
</code></pre>

<pre><code class="language-python">print('input_dimension= ', len(input_data[0]))
</code></pre>

<pre><code>input_dimension=  10
</code></pre>

<pre><code class="language-python">import numpy as np

x = np.array(input_data)
print('x.shape is ', x.shape)
print('\nx is \n', x)
</code></pre>

<pre><code>x.shape is  (10, 10)

x is 
 [[1 0 0 0 0 0 0 0 0 0]
 [0 1 0 0 0 0 0 0 0 0]
 [0 0 1 0 0 0 0 0 0 0]
 [0 0 0 1 0 0 0 0 0 0]
 [0 0 0 0 1 0 0 0 0 0]
 [0 0 0 0 0 1 0 0 0 0]
 [0 0 0 0 0 0 1 0 0 0]
 [0 0 0 0 0 0 0 1 0 0]
 [0 0 0 0 0 0 0 0 1 0]
 [0 0 0 0 0 0 0 0 0 1]]
</code></pre>

<p><strong>ì¶œë ¥ ë°ì´í„° ë³€í™˜</strong></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>yes or no ë¬¸ì œë¼ë©´ 0ê³¼ 1ë¡œ ë³€í™˜ í•˜ë©´ ëœë‹¤.<br />
ì´ë²ˆ ë¬¸ì œëŠ” 0ì—ì„œ 9ê¹Œì§€ 10ê°œë‹¤.<br />
ì¶œë ¥ ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ ë³€í™˜í•´ì•¼ í• ê¹Œ?</p>
</blockquote>

<h3 id="ì›-í•«-ì¸ì½”ë”©-one-hot-encoding">ì›-í•« ì¸ì½”ë”© (One-hot encoding)</h3>

<p>&lsquo;ê°•ì•„ì§€&rsquo;, &lsquo;ê³ ì–‘ì´&rsquo;, &lsquo;í† ë¼&rsquo;ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë¬¸ì œê°€ ìˆë‹¤ê³  í•˜ì<br />
ì†ì‹¤ í•¨ìˆ˜(loss function)ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œëŠ” ì¶œë ¥ ë°ì´í„°ë¥¼ ìˆ«ìë¡œ í‘œì‹œ í•´ì•¼ í•œë‹¤.</p>

<table>
<thead>
<tr>
<th>Label</th>
<th>ìˆ«ì</th>
</tr>
</thead>

<tbody>
<tr>
<td>ê°•ì•„ì§€</td>
<td>0</td>
</tr>

<tr>
<td>ê³ ì–‘ì´</td>
<td>1</td>
</tr>

<tr>
<td>í† ë¼</td>
<td>2</td>
</tr>
</tbody>
</table>

<p>ì‹œê·¸ëª¨ì´ë“œ(Sigmoid)ë‚˜ ì†Œí”„íŠ¸ë§¥ìŠ¤(softmax)ì™€ ê°™ì€ í™œì„± í•¨ìˆ˜(activation function)ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ê° ë ˆì´ë¸”(label)ì´ 0ê³¼ 1ë¡œ í‘œí˜„ ë˜ì–´ì•¼ í•œë‹¤. ì›-í•«-ì¸ì½”ë”©ì€ &lsquo;ê°•ì•„ì§€&rsquo;, &lsquo;ê³ ì–‘ì´&rsquo;, &lsquo;í† ë¼&rsquo;ë¥¼ 0ê³¼ 1ë¡œ í‘œí˜„í•˜ëŠ” ë°©ë²•ì´ë‹¤.</p>

<table>
<thead>
<tr>
<th>Label</th>
<th>ìˆ«ì</th>
<th>ì›-í•« ë²¡í„°</th>
</tr>
</thead>

<tbody>
<tr>
<td>ê°•ì•„ì§€</td>
<td>0</td>
<td>[1, 0, 0]</td>
</tr>

<tr>
<td>ê³ ì–‘ì´</td>
<td>1</td>
<td>[0, 1, 0]</td>
</tr>

<tr>
<td>í† ë¼</td>
<td>2</td>
<td>[0, 0, 1]</td>
</tr>
</tbody>
</table>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì•„í•˜~<br />
0ì—ì„œ 9ê¹Œì§€ì˜ ê°’ì„<br />
ì›-í•« ë²¡í„° (one-hot vector)ë¡œ í‘œì‹œí•˜ë©´ ë˜ê² êµ°</p>
</blockquote>

<pre><code class="language-python">from tensorflow.keras.utils import to_categorical

y = to_categorical(output_data)
print('y.shape is ', y.shape)
print('\none-hot encoded y is \n', y)
</code></pre>

<pre><code>y.shape is  (10, 10)

one-hot encoded y is 
 [[1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 1. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 1. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 1. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 1. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]
</code></pre>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì—‡&hellip; ì–´ì–´&hellip; ì…ë ¥ ë°ì´í„°ì™€ ì¶œë ¥ ë°ì´í„°ê°€ ???</p>
</blockquote>

<h2 id="ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì…ë ¥ ë ˆì´ì–´(input layer)ëŠ” \(x_1\)ì—ì„œ \(x_{10}\)ê¹Œì§€ 10ê°œë¡œ ë˜ì–´ ìˆë‹¤.<br />
íˆë“  ë ˆì´ì–´(hidden layer)ëŠ” 3ê°œì˜ unitsë¡œ êµ¬ì„± í•œë‹¤.<br />
ì¶œë ¥ ë ˆì´ì–´(output layer)ëŠ” 10ê°œì˜ unitsë¡œ êµ¬ì„± í•œë‹¤.<br />
ê·¸ë¦¼ìœ¼ë¡œ ë‚˜íƒ€ë‚´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<p>ì„ ë“¤ì´ ë¹ ì§ ì—†ì´ ì¡°ë°€í•˜ê²Œ ì—°ê²° ë˜ì–´ ìˆë‹¤.<br />
ìŒ&hellip; <strong>ë´ìŠ¤(Dense)</strong> í•˜ê²Œ ì—°ê²° ë˜ì–´ìˆêµ°&hellip;</p>
</blockquote>

<p><img src="https://skettee.github.io/post/neural_network/auto_coding_model.png" alt="ì˜¤í†  ì½”ë”© ëª¨ë¸" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>íˆë“  ë ˆì´ì–´ì— ìˆëŠ” ìœ ë‹›ë“¤ì˜ í™œì„±í•¨ìˆ˜(activation function)ëŠ” sigmoidë¡œ í•œë‹¤.<br />
ì¶œë ¥ ë ˆì´ì–´ì— ìˆëŠ” ìœ ë‹›ë“¤ì˜ í™œì„±í•¨ìˆ˜(activation function)ë¥¼ sigmoidë¡œ í•˜ë©´ <del>ã…ˆëœë‹¤</del>ì•ˆëœë‹¤.<br />
ì™œëƒí•˜ë©´<br />
ê° í™•ë¥ ì˜ ì´í•©ì€ 1ì´ ë‚˜ì™€ì•¼ í•˜ëŠ”ë°<br />
sigmoidëŠ”<br />
\(\hat y_{1}+\hat y_{2}+\hat y_{3}+\hat y_{4}+\hat y_{5}+\hat y_{6}+\hat y_{7}+\hat y_{8}+\hat y_{9}+\hat y_{10}=1\) ì„ ë§Œì¡±í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>

<p>ê±±ì •ë§ˆë¼.  ì—”ì§€ë‹ˆì–´ë¥¼ ê°ˆì•„ì„œ ë§Œë“  ê²ƒì´ ìˆë‹¤.<br />
 ê·¸ê²ƒì€ ë°”ë¡œ&hellip;</p>
</blockquote>

<h3 id="ì†Œí”„íŠ¸ë§¥ìŠ¤-íšŒê·€-softmax-regression">ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ (Softmax Regression)</h3>

<p>0ê³¼ 1, ë‘ê°€ì§€ì˜ ê²½ìš°ì— ëŒ€í•œ ë¶„ë¥˜ëŠ” ë¡œì§€ìŠ¤í‹± íšŒê·€(logistic regression)ë¡œ ëª¨ë¸ë§ì„ í•œë‹¤.<br />
ì„¸ê°€ì§€ ì´ìƒì— ëŒ€í•œ ë¶„ë¥˜ëŠ” ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€(softmax regression)ë¡œ ëª¨ë¸ë§ì„ í•œë‹¤.<br />
ì†Œí”„íŠ¸ë§¥ìŠ¤ì˜ í™œì„± í•¨ìˆ˜(activation function)ëŠ” ì•„ë˜ì™€ ê°™ì´ ì •ì˜í•œë‹¤.</p>

<p>\(z=w^{T}x+b\),<br />
\(a=\sigma(z) = {{e^z}\over{\sum_{j=1}^{m} e^z}}\),<br />
\(m=\) number of classes (ë¶„ë¥˜ ê°œìˆ˜)</p>

<p><strong>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ë¥¼ ì´ìš©í•œ ë¶„ë¥˜</strong></p>

<p>3ê°œë¡œ ë¶„ë¥˜ëœ ì•„ë˜ ë°ì´í„°ë¥¼ ê°€ì§€ê³  10X10 ê³µê°„ì„ 3ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•´ ë³´ì.<br />
ì—¬ê¸°ì„œ <strong>í´ë˜ìŠ¤(Class)</strong> ë€ &lsquo;ê³µí†µì ì¸ ì„±ì§ˆì„ ê°€ì§„ ì¢…ë¥˜&rsquo;ë¼ëŠ” ëœ»ì´ë‹¤.</p>

<pre><code class="language-python">import numpy as np

x_data = np.array([
    (1,4), (1,5), (1,6), (1,7), (1,8), (2,5), (2,6), (2,7), (2,8), (2,9), 
    (3,6), (3,7), (3,8), (3,9), (4,7), (4,8), (4,9), (5,8), (5,9), (6,9),
    (3,1), (4,1), (4,2), (5,1), (5,2), (5,3), (6,1), (6,2), (7,1), (8,1),
    (7,5), (8,4), (8,5), (8,6), (9,3), (9,4), (9,5), (9,6), (9,7), (9,8)
])

y_data = np.array([
    [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], 
    [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0], [1,0,0],
    [0,1,0], [0,1,0], [0,1,0], [0,1,0], [0,1,0], [0,1,0], [0,1,0], [0,1,0], [0,1,0], [0,1,0],
    [0,0,1], [0,0,1], [0,0,1], [0,0,1], [0,0,1], [0,0,1], [0,0,1], [0,0,1], [0,0,1], [0,0,1]
])

color_data = ['red', 'green', 'blue']
</code></pre>

<p>x_dataë¥¼ ê·¸ë˜í”„ë¡œ í‘œì‹œí•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.<br />
y_dataì—ì„œ [1,0,0]ì€ ë¹¨ê°•, [0,1,0]ì€ ì´ˆë¡, [0,0,1]ì€ íŒŒë‘ìœ¼ë¡œ í´ë˜ìŠ¤ë¥¼ êµ¬ë¶„í•œë‹¤.</p>

<pre><code class="language-python">%matplotlib inline
import matplotlib.pyplot as plt

plt.scatter([x[0] for x in x_data ], [x[1] for x in x_data], color=[color_data[i] for i in [np.argmax(x) for x in y_data]])
plt.show()
</code></pre>

<p><img src="output_25_0.png" alt="png" /></p>

<p>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì€ Kerasë¡œ ê°„ë‹¨í•˜ê²Œ ëª¨ë¸ë§í•  ìˆ˜ ìˆë‹¤.</p>

<pre><code class="language-python">from tensorflow.keras import Sequential
from tensorflow.keras.layers import Dense, Activation

model = Sequential()
model.add(Dense(3, input_shape=(2,), activation='softmax'))
model.compile(loss='categorical_crossentropy', optimizer='rmsprop')
hist = model.fit(x_data, y_data, epochs=1000, verbose=0)
</code></pre>

<pre><code>WARNING: Logging before flag parsing goes to stderr.
W0829 22:06:08.064495 140062107961152 deprecation.py:506] From /home/dataman/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/init_ops.py:1251: calling VarianceScaling.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
</code></pre>

<p>ë°˜ë³µ í•™ìŠµí•  ìˆ˜ë¡ ì†ì‹¤ ê°’ì´ 0ì— ê°€ê¹ê²Œ ì¤„ì–´ ë“ ë‹¤.</p>

<pre><code class="language-python">plt.plot(hist.history['loss'])
plt.xlabel('epoch')
plt.ylabel('loss')
plt.show()
</code></pre>

<p><img src="output_29_0.png" alt="png" /></p>

<p>í•™ìŠµì´ ì™„ë£Œëœ ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì„ ì´ìš©í•´ì„œ<br />
10X10 ê³µê°„ì„ 3ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•œ ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ ë³´ì.</p>

<pre><code class="language-python">x_data = []
y_data = []
c_data = []
for i in range(10):
    for j in range(10):
        x_data.append(i)
        y_data.append(j)
        c_data.append(color_data[np.argmax(model.predict(np.array([i, j]).reshape(1, 2))[0])])

plt.scatter(x_data, y_data, color=c_data)
plt.show()
</code></pre>

<p><img src="output_31_0.png" alt="png" /></p>

<p>ì†Œí”„íŠ¸ë§¥ìŠ¤ íšŒê·€ ëª¨ë¸ì„ ì´ìš©í•´ì„œ<br />
10X10ê³µê°„ì„ 3ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜ê°€ ì˜ ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<h3 id="ì •ë¦¬">ì •ë¦¬</h3>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ ëª¨ë¸(Neural Network model)ì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì •ë¦¬í•´ ë³´ì.<br />
1. ë°ì´í„°ë¥¼ ë³€í™˜í•œë‹¤.<br />
  1. ì…ë ¥ ë°ì´í„°ì˜ í˜•ì‹ê³¼ ëª¨ì–‘ì„ ë³€í™˜í•œë‹¤.<br />
  2. ì¶œë ¥ ë°ì´í„°ì˜ í˜•ì‹ê³¼ ëª¨ì–‘ì„ ë³€í™˜í•œë‹¤. <strong>ì›-í•« ì¸ì½”ë”©(one-hot encoding)</strong> ì„ ì‚¬ìš©í•œë‹¤.<br />
2. <strong>íˆë“  ë ˆì´ì–´(hidden layer)</strong>  ì •ì˜<br />
  1. íˆë“  ë ˆì´ì–´ ê°œìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” 1-hidden layerë¥¼ ì‚¬ìš©í•œë‹¤.<br />
  2. íˆë“  ë ˆì´ì–´ ìœ ë‹› ê°œìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” 3ê°œì´ ìœ ë‹›ì„ ì‚¬ìš©í•œë‹¤.<br />
  3. í™œì„± í•¨ìˆ˜(activation function)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>ì‹œê·¸ëª¨ì´ë“œ(sigmoid)</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.<br />
3. <strong>ì¶œë ¥ ë ˆì´ì–´(output layer)</strong>  ì •ì˜<br />
  1. ì¶œë ¥ ë ˆì´ì–´ ìœ ë‹› ê°œìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” 10ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•´ì•¼ ë˜ë‹ˆê¹Œ 10ê°œì˜ ìœ ë‹›ì„ ì‚¬ìš©í•œë‹¤.<br />
  2. í™œì„± í•¨ìˆ˜(activation function)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>ì†Œí”„íŠ¸ë§¥ìŠ¤(softmax)</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.
4. ì†ì‹¤ í•¨ìˆ˜ (Loss function)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>í¬ë¡œìŠ¤-ì—”íŠ¸ë¡œí”¼ ì†ì‹¤(cross-entropy loss)</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.<br />
5. ì˜µí‹°ë§ˆì´ì €(Optimizer)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>RMSProp</strong> ì„ ì‚¬ìš©í•œë‹¤.<br />
4. ë°˜ë³µí•  íšŒìˆ˜(epoch)ë¥¼ ê²°ì •í•œë‹¤.<br />
5. ì£¼ì–´ì§„ ì¡°ê±´ìœ¼ë¡œ ëª¨ë¸ì„ ìµœì í™”(fit) ì‹œí‚¨ë‹¤.</p>
</blockquote>

<h2 id="í…ì„œí”Œë¡œìš°-tensorflow-ë¡œ-ëª¨ë¸ë§-modeling">í…ì„œí”Œë¡œìš°(Tensorflow)ë¡œ ëª¨ë¸ë§(Modeling)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì¢‹ì•˜ì–´!</p>

<p>ì´ì œ ë˜ë¦¬ í˜ì´ì§€(Larry Page)ê°€ ëƒ ëƒ í•œ<br />
<strong>ì¼€ë¼ìŠ¤(Keras)</strong>ë¥¼ ì´ìš©í•´ì„œ êµ¬í˜„ì„ í•´ë³´ì!</p>
</blockquote>

<h3 id="ì •ê·œí™”-normalization"><del>ì •ê·œí™” (Normalization)</del></h3>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì •ê·œí™” í• ê±° ì—†ìŒ!<br />
0ê³¼ 1ë¡œ ë˜ì–´ ìˆëŠ”ë° ë­”&hellip; í•„ìš”???</p>
</blockquote>

<pre><code class="language-python">X_train = x
Y_train = y
</code></pre>

<h3 id="kerasë¥¼-ê°€ì§€ê³ -ëª¨ë¸ë§-modeling-í•˜ê¸°">Kerasë¥¼ ê°€ì§€ê³  ëª¨ë¸ë§(Modeling)í•˜ê¸°</h3>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>5ì¤„ë¡œ ëª¨ë¸ë§ì´ ê°€ëŠ¥í•˜ë‹¤!</p>

<p>í”„ë‘ì†Œì™€ ìˆ„ë ˆ ë§Œë§Œì„¸!</p>
</blockquote>

<pre><code class="language-python">from tensorflow.keras import Sequential
from tensorflow.keras.layers import Dense, Activation

# ëª¨ë¸ì„ ì¤€ë¹„í•œë‹¤.
model = Sequential()
# unit ê°œìˆ˜ê°€ 3ì´ê³  ì…ë ¥ ë³€ìˆ˜ xê°€ 10ê°œì¸  hidden layerë¥¼ ìƒì„±í•˜ê³  denseí•˜ê²Œ ì—°ê²°í•œë‹¤.
model.add(Dense(3, input_shape=(10,), activation='sigmoid'))
# unit ê°œìˆ˜ê°€ 10ì¸ output layerë¥¼ ìƒì„±í•˜ê³  denseí•˜ê²Œ ì—°ê²°í•œë‹¤.
model.add(Dense(10, activation='softmax'))
# Loss funtionê³¼ Optimizerë¥¼ ì„ íƒí•œë‹¤.
model.compile(loss='categorical_crossentropy', optimizer='rmsprop')
# epochsë§Œí¼ ë°˜ë³µí•´ì„œ ì†ì‹¤ê°’ì´ ìµœì €ê°€ ë˜ë„ë¡ ëª¨ë¸ì„ í›ˆë ¨í•œë‹¤.
hist = model.fit(X_train, Y_train, epochs=10000, verbose=0)
</code></pre>

<h3 id="ì†ì‹¤ê°’ì˜-ë³€í™”ë¥¼-ê·¸ë˜í”„ë¡œ-í™•ì¸">ì†ì‹¤ê°’ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”„ë¡œ í™•ì¸</h3>

<pre><code class="language-python">plt.plot(hist.history['loss'])
plt.xlabel('epoch')
plt.ylabel('loss')
plt.show()
</code></pre>

<p><img src="output_40_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë°˜ë³µì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ë¡ ì†ì‹¤(Loss)ì´ 0ì— ê°€ê¹ê²Œ ëœë‹¤.<br />
ë‚˜ì´ìŠ¤!</p>
</blockquote>

<h2 id="í•´ê²°-solution">í•´ê²° (Solution)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ê³ ê°ë‹˜~ ì›í•˜ì‹œëŠ” ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.<br />
test_dataì— ì›í•˜ì‹œëŠ” ê°’ì„ ì…ë ¥í•˜ì‹œë©´<br />
ì›í•˜ì‹œëŠ” ê²°ê³¼ê°’ì´ ì¶œë ¥ ë©ë‹ˆë‹¤.</p>
</blockquote>

<pre><code class="language-python">def auto_coding(x):
    input_data = np.array(x).reshape(1, 10)
    predict = model.predict(input_data)
    return np.argmax(predict[0])

test_data =  [0, 0, 0, 0, 0, 1, 0, 0, 0, 0]
result = auto_coding(test_data)
print('input data is {} and ouput is {}'.format(test_data, result))
</code></pre>

<pre><code>input data is [0, 0, 0, 0, 0, 1, 0, 0, 0, 0] and ouput is 5
</code></pre>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë‚´ê°€ ë§Œë“  human_codingê³¼<br />
ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤</p>

<p>ì´ê²ƒì€<br />
íˆë“  ë ˆì´ì–´ì—ì„œ<br />
í•™ìŠµì— ì˜í•´ì„œ<br />
ìë™ìœ¼ë¡œ ì½”ë”©ì´ ë˜ì—ˆë‹¤ëŠ” ê²ƒì´ë‹¤.</p>

<p>ì—¬ê¸°ì„œ ë¬¸ì œëŠ”<br />
íˆë“  ë ˆì´ì–´ì—ì„œì˜ \(w\)ì™€ \(b\) ê°’ë“¤ì´<br />
ì™œ ì´ëŸ° ê°’ì„ ê°€ì§€ëŠ”ì§€<br />
ëª¨ë¥¸ë‹¤ëŠ” ê²ƒì´ë‹¤.<br />
ê·¸ë˜ì„œ<br />
Hidden(ìˆ¨ì€) ë ˆì´ì–´ ë¼ê³  í•œë‹¤.</p>
</blockquote>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/%EB%94%A5%EB%9F%AC%EB%8B%9D/" rel="tag">ë”¥ëŸ¬ë‹</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/%EB%89%B4%EB%9F%B4-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC/" rel="tag">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/%EC%9B%90-%ED%95%AB-%EC%9D%B8%EC%BD%94%EB%94%A9/" rel="tag">ì›-í•« ì¸ì½”ë”©</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/%EC%86%8C%ED%94%84%ED%8A%B8%EB%A7%A5%EC%8A%A4/" rel="tag">ì†Œí”„íŠ¸ë§¥ìŠ¤</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/logistic_regression/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">ë¡œì§€ìŠ¤í‹± íšŒê·€ (Logistic Regression)</p></a>
	</div>
</nav>
<script src="https://utteranc.es/client.js"
        repo="skettee/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œê¸°.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>