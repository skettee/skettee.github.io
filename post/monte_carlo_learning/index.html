<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Monte Carlo Learning - ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="Monte Carlo Learning" />
<meta property="og:description" content="ê°•í™” í•™ìŠµ(Reinforcement Learning)ì—ì„œ ì‚¬ìš©í•˜ëŠ” Monte Carloì— ëŒ€í•´ì„œ ì•Œì•„ ë³´ê³  Gymì—ì„œ ì œê³µí•˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì•Œê³ ë¦¬ë“¬ì„ ë§Œë“¤ì–´ ë³´ì." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/monte_carlo_learning/" />
<meta property="article:published_time" content="2019-09-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-09-23T00:00:00+00:00" />

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ" rel="home">
				<div class="logo__title">ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</div>
				<div class="logo__tagline">ë”¥ëŸ¬ë‹ ëª¨ë¸ë§</div>
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Monte Carlo Learning</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2019-09-23T00:00:00">2019-09-23</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/reinforcement-learning" rel="category">Reinforcement Learning</a>, <a class="meta__link" href="/categories/monte-carlo-learning" rel="category">Monte-Carlo Learning</a></span>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</a></li>
<li><a href="#ë¬¸ì œ-ë¶„ì„-problem-anaysis">ë¬¸ì œ ë¶„ì„ (Problem Anaysis)</a></li>
<li><a href="#í™˜ê²½-environment">í™˜ê²½ (Environment)</a>
<ul>
<li><a href="#ì•¡ì…˜-action">ì•¡ì…˜ (Action)</a></li>
<li><a href="#ìƒíƒœ-state">ìƒíƒœ (State)</a></li>
<li><a href="#ë³´ìƒ-reward">ë³´ìƒ (Reward)</a>
<ul>
<li><a href="#return-ë¯¸ë˜-ë³´ìƒì˜-í•©">Return (ë¯¸ë˜ ë³´ìƒì˜ í•©)</a></li>
</ul></li>
</ul></li>
<li><a href="#ì—ì´ì „íŠ¸-agent">ì—ì´ì „íŠ¸ (Agent)</a>
<ul>
<li><a href="#ì •ì±…-policy">ì •ì±… (Policy)</a></li>
<li><a href="#ìƒíƒœ-ê°€ì¹˜-state-value">ìƒíƒœ ê°€ì¹˜ (State Value)</a></li>
<li><a href="#q-value-state-action-value">Q-value (State Action Value)</a></li>
<li><a href="#ìµœì -ê°€ì¹˜-optimal-value">ìµœì  ê°€ì¹˜ (Optimal Value)</a></li>
<li><a href="#ìµœì -ì •ì±…-optimal-policy">ìµœì  ì •ì±… (Optimal Policy)</a></li>
<li><a href="#ë©”ëª¨ë¦¬-memory">ë©”ëª¨ë¦¬ (Memory)</a></li>
<li><a href="#monte-carlo-ëª¬í…Œ-ì¹´ë¥¼ë¡œ">Monte Carlo (ëª¬í…Œ ì¹´ë¥¼ë¡œ)</a>
<ul>
<li><a href="#target">Target</a></li>
<li><a href="#error-ë¸íƒ€">Error (ë¸íƒ€)</a></li>
</ul></li>
</ul></li>
<li><a href="#í•™ìŠµ-learning">í•™ìŠµ (Learning)</a></li>
<li><a href="#í•´ê²°-solution">í•´ê²° (Solution)</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<p>ê°•í™” í•™ìŠµ(Reinforcement Learning)ì—ì„œ ì‚¬ìš©í•˜ëŠ” Monte Carloì— ëŒ€í•´ì„œ ì•Œì•„ ë³´ê³  Gymì—ì„œ ì œê³µí•˜ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•œ ì•Œê³ ë¦¬ë“¬ì„ ë§Œë“¤ì–´ ë³´ì.</p>

<p>ì‹¤ì œë¡œ ëŒë ¤ ë³´ê³  ì‹¶ìœ¼ë©´ êµ¬ê¸€ ì½”ë©ìœ¼ë¡œ ~</p>

<p><a href="https://colab.research.google.com/github/skettee/notebooks/blob/master/monte_carlo_learning.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

<h2 id="ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</h2>

<p>ğŸ‘¤ ìƒì‚¬</p>

<blockquote>
<p>ì¸ê³µì§€ëŠ¥ ê²Œì„ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•œë‹¤.<br />
ê²Œì„ì„ ë§Œë“¤ë ¤ë©´ &lsquo;ê°•í™”í•™ìŠµ&rsquo;ì´ë¼ëŠ” ê²ƒì„ ì•Œì•„ì•¼ í•œë‹¤ëŠ”ë°&hellip;<br />
ì•„ë˜ ì²´ìœ¡ê´€(Gym)ì— ê°€ì„œ<br />
&lsquo;ì–¼ìŒ í˜¸ìˆ˜&rsquo; ë¬¸ì œë¥¼ í•œë²ˆ í’€ì–´ë³´ê²Œ</p>

<p><a href="https://gym.openai.com/envs/FrozenLake-v0/">https://gym.openai.com/envs/FrozenLake-v0/</a></p>
</blockquote>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì˜¤~ ê²Œì„ì´ë¼<br />
ë”¥ëŸ¬ë‹ì— ì°Œë“  ë¨¸ë¦¬ê°€ ê°‘ìê¸° ë§‘ì•„ì§„ë‹¤~<br />
ìƒˆë¡œìš´ ë§ˆìŒìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•´ ë³´ì!</p>
</blockquote>

<h2 id="ë¬¸ì œ-ë¶„ì„-problem-anaysis">ë¬¸ì œ ë¶„ì„ (Problem Anaysis)</h2>

<p>ì¼ë‹¨ Gymì„ ì„¤ì¹˜í•˜ê³  ëŒë ¤ ë³´ì!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>pip install gym</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> gym
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">from</span> time <span style="color:#f92672">import</span> sleep
<span style="color:#f92672">from</span> IPython.display <span style="color:#f92672">import</span> display, clear_output, Pretty


<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_optimal_value</span>(state, action, reward):
    <span style="color:#66d9ef">return</span> None

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">get_optimal_action</span>():
    <span style="color:#66d9ef">return</span> env<span style="color:#f92672">.</span>action_space<span style="color:#f92672">.</span>sample()</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#</span>
<span style="color:#75715e"># Environment</span>
<span style="color:#75715e">#</span>
env <span style="color:#f92672">=</span> gym<span style="color:#f92672">.</span>make(<span style="color:#e6db74">&#39;FrozenLake-v0&#39;</span>, is_slippery<span style="color:#f92672">=</span>False) <span style="color:#75715e"># ì–¼ìŒìœ„ì—ì„œ ë¯¸ë„ëŸ¬ì§€ì§€ ì•Šë„ë¡ ì„¤ì •</span>
state <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>reset()

<span style="color:#75715e"># Initial world display</span>
world <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>render(mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ansi&#39;</span>)
display(Pretty(world))
sleep(<span style="color:#ae81ff">0.5</span>)

<span style="color:#75715e">#</span>
<span style="color:#75715e"># Agent</span>
<span style="color:#75715e">#</span>
<span style="color:#66d9ef">for</span> step <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">100</span>):
    action <span style="color:#f92672">=</span> get_optimal_action()
    next_state, reward, done, info <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>step(action)    
    get_optimal_value(state, action, reward)
    state <span style="color:#f92672">=</span> next_state
    
    <span style="color:#75715e"># updated world display</span>
    world <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>render(mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ansi&#39;</span>)
    clear_output(wait<span style="color:#f92672">=</span>True)
    display(Pretty(world))
    sleep(<span style="color:#ae81ff">0.5</span>)
    
    <span style="color:#66d9ef">if</span> done: <span style="color:#75715e"># an episode finished</span>
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#34;Episode finished after {} timesteps&#34;</span><span style="color:#f92672">.</span>format(step<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>))
        <span style="color:#66d9ef">break</span></code></pre></div>
<pre><code>  (Down)
SFFF
F[41mH[0mFH
FFFH
HFFG



Episode finished after 6 timesteps
</code></pre>

<p>4X4 ë§¤íŠ¸ë¦­ìŠ¤ì—ì„œ <code>S</code>(Start)ì—ì„œ ì‹œì‘í•´ì„œ <code>H</code>(Hole)ë¥¼ í”¼í•´ì„œ <code>G</code>(Goal)ê¹Œì§€ ë„ì°©í•˜ëŠ” ìµœì ì˜ ê¸¸ì„ ì°¾ëŠ” ê²Œì„ì´ë‹¤.  ì½”ë“œë¥¼ ë³´ë©´ &hellip;</p>

<ol>
<li>í™˜ê²½(Environemnt)ê³¼ ì—ì´ì ¼íŠ¸(Agent)ë¡œ ë‚˜ëˆ„ì–´ì ¸ ìˆê³ ,<br /></li>
<li>ì—ì´ì ¼íŠ¸ëŠ” í™˜ê²½ìœ¼ë¡œ ë¶€í„° ìƒíƒœ(state)ë¥¼ ì–»ì–´ ì˜¤ê³ <br /></li>
<li>ìµœì ì˜ ì•¡ì…˜(action)ì„ ê²°ì •í•˜ê³ <br /></li>
<li>ì•¡ì…˜ì„ ì‹¤í–‰í•˜ê³  ê·¸ ê²°ê³¼ë¡œ ë‹¤ìŒ ìƒíƒœ, ë³´ìƒ(Reward)ì„ ì–»ì–´ ì˜¤ê³ <br /></li>
<li>ìƒíƒœ, ì•¡ì…˜, ë³´ìƒì„ ì´ìš©í•´ì„œ ìµœì ì˜ ê°€ì¹˜(Value)ë¥¼ ê³„ì‚°í•˜ê³ <br /></li>
<li>3,4,5ë¥¼ ë°˜ë³µí•˜ëŠ”<br /></li>
</ol>

<p>&hellip; êµ¬ì¡°ë¡œ ë˜ì–´ ìˆë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ê±°&hellip;<br />
ë”¥ëŸ¬ë‹í•˜ê³ ëŠ” ì™„ì „ ë‹¤ë¥¸ ë¬¸ì œë‹¤&hellip;<br />
ë”¥ëŸ¬ë‹ì€ ë°ì´í„°ë¥¼ ì£¼ê³  ì‚¬ëŒë³´ë‹¤ ë›°ì–´ë‚œ ë¶„ë¥˜ì™€ ì˜ˆì¸¡ì„ í•˜ë„ë¡ <strong>ëª¨ë¸ë§</strong> ì„ í•˜ëŠ” ê²ƒì´ë‹¤.<br />
ê°•í™”í•™ìŠµì€ í™˜ê²½ê³¼ ì—ì´ì ¼íŠ¸ë¥¼ ì£¼ê³  ì‚¬ëŒë³´ë‹¤ ë›°ì–´ë‚œ í–‰ë™ì„ í•˜ë„ë¡ <strong>ì•Œê³ ë¦¬ë“¬</strong> ì„ ë§Œë“œëŠ” ê²ƒì´ë‹¤.</p>

<p>ìš°ì„  í™˜ê²½(Environment)ì— ëŒ€í•´ì„œ ì•Œì•„ ë³´ì</p>
</blockquote>

<h2 id="í™˜ê²½-environment">í™˜ê²½ (Environment)</h2>

<p>&lsquo;ì–¼ìŒí˜¸ìˆ˜&rsquo;ì˜ í™˜ê²½ì€ 16ê°œì˜ ìƒíƒœ(State)ì™€ 4ê°œì˜ ì•¡ì…˜(Action)ìœ¼ë¡œ êµ¬ì„± ë˜ì–´ ìˆë‹¤.</p>

<h3 id="ì•¡ì…˜-action">ì•¡ì…˜ (Action)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Action Space</span>
env<span style="color:#f92672">.</span>action_space</code></pre></div>
<pre><code>Discrete(4)
</code></pre>

<p>&lsquo;ì–¼ìŒí˜¸ìˆ˜&rsquo;ì—ì„œëŠ” 4ê°œì˜ ì•¡ì…˜ì´ ì¡´ì¬í•œë‹¤. ê·¸ë¦¬ê³  ê°ê°ì˜ ì•¡ì…˜ì´ ë²ˆí˜¸ë¡œ ì§€ì • ë˜ì–´ ìˆë‹¤.</p>

<p>\(A = \{0, 1, 2, 3\}\)</p>

<table>
<thead>
<tr>
<th>Num</th>
<th>Action</th>
</tr>
</thead>

<tbody>
<tr>
<td>0</td>
<td>ì™¼ìª½ìœ¼ë¡œ ì´ë™ (Move Left)</td>
</tr>

<tr>
<td>1</td>
<td>ì•„ë˜ë¡œ ì´ë™ (Move Down)</td>
</tr>

<tr>
<td>2</td>
<td>ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™ (Move Right)</td>
</tr>

<tr>
<td>3</td>
<td>ìœ„ë¡œ ì´ë™ (Move Up)</td>
</tr>
</tbody>
</table>

<h3 id="ìƒíƒœ-state">ìƒíƒœ (State)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># State Space</span>
env<span style="color:#f92672">.</span>observation_space</code></pre></div>
<pre><code>Discrete(16)
</code></pre>

<p>&lsquo;ì–¼ìŒí˜¸ìˆ˜&rsquo;ì˜ ìƒíƒœ(State) \(S\)ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ê° ìƒíƒœê°€ 0ê³¼ 15ê¹Œì§€ ë²ˆí˜¸ë¡œ ì§€ì •ë˜ì–´ ìˆë‹¤.</p>

<p>\(S = \{0, 1, \cdots , 15\}\)</p>

<p>\(\begin{vmatrix}
0 &amp; 1 &amp; 2 &amp; 3 \\
4 &amp; 5 &amp; 6 &amp; 7 \\
8 &amp; 9 &amp; 10 &amp; 11 \\
12 &amp; 13 &amp; 14 &amp; 15
\end{vmatrix}\)</p>

<p>ê·¸ë¦¬ê³  ê° ìƒíƒœë§ˆë‹¤ ì•¡ì…˜(action), í™•ë¥ (probability), ë‹¤ìŒ ìƒíƒœ(next state), ë³´ìƒ(reward), ì¢…ë£Œ(done)ê°€ <code>{action: [(probability, nextstate, reward, done)]}</code> í˜•ì‹ìœ¼ë¡œ ì •ì˜ ë˜ì–´ ìˆë‹¤.</p>

<p>6ë²ˆ ìƒíƒœë¥¼ ê¹Œë³´ì</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">env<span style="color:#f92672">.</span>P[<span style="color:#ae81ff">6</span>]</code></pre></div>
<pre><code>{0: [(1.0, 5, 0.0, True)],
 1: [(1.0, 10, 0.0, False)],
 2: [(1.0, 7, 0.0, True)],
 3: [(1.0, 2, 0.0, False)]}
</code></pre>

<p>í•´ì„ì„ í•´ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<blockquote>
<p>6ë²ˆ ìƒíƒœì—ì„œ<br />
ì™¼ìª½ìœ¼ë¡œ ì´ë™í•˜ë©´ 100%ì˜ í™•ë¥ ë¡œ 5ë²ˆ ìƒíƒœë¡œ ë³€í™˜ë˜ê³ , ë³´ìƒì€ 0.0, ì¢…ë£Œí•œë‹¤.<br />
ì•„ë˜ë¡œ ì´ë™í•˜ë©´ 100%ì˜ í™•ë¥ ë¡œ 10ë²ˆ ìƒíƒœë¡œ ë³€í™˜ë˜ê³ , ë³´ìƒì€ 0.0, ê³„ì†í•œë‹¤.<br />
ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™í•˜ë©´ 100%ì˜ í™•ë¥ ë¡œ 7ë²ˆ ìƒíƒœë¡œ ë³€í™˜ë˜ê³  ë³´ìƒì€ 0.0, ì¢…ë£Œí•œë‹¤.<br />
ìœ„ë¡œ ì´ë™í•˜ë©´ 100%ì˜ í™•ë¥ ë¡œ 2ë²ˆ ìƒíƒœë¡œ ë³€í™˜ë˜ê³  ë³´ìƒì€ 0.0, ê³„ì†í•œë‹¤.</p>
</blockquote>

<h3 id="ë³´ìƒ-reward">ë³´ìƒ (Reward)</h3>

<p>14ë²ˆì˜ ìƒíƒœë„ ê¹Œë³´ì</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">env<span style="color:#f92672">.</span>P[<span style="color:#ae81ff">14</span>]</code></pre></div>
<pre><code>{0: [(1.0, 13, 0.0, False)],
 1: [(1.0, 14, 0.0, False)],
 2: [(1.0, 15, 1.0, True)],
 3: [(1.0, 10, 0.0, False)]}
</code></pre>

<p>14ë²ˆ ìƒíƒœì—ì„œ ì˜¤ë¥¸ìª½ìœ¼ë¡œ ì´ë™í•˜ë©´ 100% í™•ë¥ ë¡œ 15ë²ˆ ìƒíƒœë¡œ ë³€í™˜ë˜ê³  1.0ì„ ë³´ìƒ ë°›ê³  ì¢…ë£Œí•œë‹¤!</p>

<p>ê¸°ëŒ€ ë³´ìƒê°’ì€ ì•„ë˜ì™€ ê°™ì´ ì •ì˜í•œë‹¤.</p>

<p>\(\mathcal R_s^a = \mathbb E [\mathcal R_{t+1} | S_t = s, A_t = a ]\)</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ì„œ 14ë²ˆ ìƒíƒœì—ì„œ, 2ë²ˆ ì•¡ì…˜ì—ì„œì˜ ê¸°ëŒ€ ë³´ìƒê°’ì€ ì•„ë˜ì™€ ê°™ë‹¤.</p>

<p>\(\mathcal R_{14}^{2} = 1.0\)</p>

<h4 id="return-ë¯¸ë˜-ë³´ìƒì˜-í•©">Return (ë¯¸ë˜ ë³´ìƒì˜ í•©)</h4>

<p>ì—ì´ì „íŠ¸ëŠ” ë°”ë¡œ ë‹¤ìŒì˜ ë³´ìƒë§Œì„ ë³´ê³  ì•¡ì…˜ì„ í•˜ë©´ ì•ˆëœë‹¤.  ë¨¼ ë¯¸ë˜ì˜ ìµœì¢… ë³´ìƒì˜ í•©ì„ ì˜ˆìƒí•´ì„œ ì•¡ì…˜ì„ í•´ì•¼ í•œë‹¤.<br />
&lsquo;2ë³´ ì „ì§„ì„ ìœ„í•œ 1ë³´ í›„í‡´&rsquo; ì „ëµì„ êµ¬ì‚¬í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.</p>

<p>ì—ì´ì „íŠ¸ê°€ ì›í•˜ëŠ” ìµœì¢… ê³¨(Goal)ì€ ë‹¤ìŒì˜ ì‹ê³¼ ê°™ì´ ë‹¤ìŒ, ë‹¤ìŒ, ë‹¤ìŒ&hellip;ì˜ ë¯¸ë˜ì˜ ë³´ìƒë“¤ì˜ í•©ì„ ëŒë ¤ ë°›ëŠ”(Return) ê²ƒì´ë‹¤.</p>

<p>\(G_t = R_{t+1} + \gamma R_{t+2} + \cdots + = \sum_{k=0}^{\infty} \gamma^{k} R_{t+k+1}\)</p>

<p>ê·¸ëŸ¬ë‚˜ ì—ì´ì „íŠ¸ë„ ìš•ì‹¬ì´ ìˆì–´ì„œ ë°”ë¡œ ë‹¤ìŒ ë³´ìƒì´ ì»¤ë³´ì¸ë‹¤. ì´ê²ƒì„ ë§Œì¡±ì‹œì¼œ ì£¼ëŠ” ê²ƒì´ ë””ìŠ¤ì¹´ìš´íŠ¸(discount factor) \(\gamma\) ê°’ì´ë‹¤.  \(\gamma\) ëŠ” 0ê³¼ 1ì‚¬ì´ì˜ ê°’ì„ ê°€ì§„ë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë¯¸ë˜ë¡œ ê°ˆ ìˆ˜ë¡ ë³´ìƒì€ ì§€ìˆ˜ì ìœ¼ë¡œ ì‘ì•„ ë³´ì´ê²Œ ëœë‹¤.</p>

<p>\(\gamma \in [0,1]\)</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì—ì´ì „íŠ¸ëŠ”<br />
ë³´ìƒì„ ë°›ê¸° ìœ„í•´<br />
êµ¬ë©ì— ë¹ ì§€ì§€ ì•Šê³  15ë²ˆ ìƒíƒœë¡œ ì´ë™í•˜ê¸° ìœ„í•´<br />
ìµœì ì˜ ì•¡ì…˜ì„ í•´ì•¼ í•œë‹¤.</p>

<p>ìš°ë¦¬ëŠ”<br />
ì—ì´ì „íŠ¸ê°€ ìµœì ì˜ ì•¡ì…˜ì„ í•˜ë„ë¡<br />
ì•Œê³ ë¦¬ë“¬ì„ ë§Œë“¤ì–´ì•¼ í•œë‹¤.<br />
ì–´ë–»ê²Œ ?</p>
</blockquote>

<h2 id="ì—ì´ì „íŠ¸-agent">ì—ì´ì „íŠ¸ (Agent)</h2>

<p>ì—ì´ì „íŠ¸ëŠ” í™˜ê²½ì—ì„œ ë¶€í„° ì£¼ì–´ì§„ ìƒíƒœ(\(S\)), ì•¡ì…˜(\(A\)), ë³´ìƒ(\(R\))ì„ ê°€ì§€ê³  ê°€ì¹˜(Q-value)ë¥¼ ê³„ì‚°í•˜ê³  ì •ì±…(Policy)ì„ ìˆ˜ë¦½í•´ì„œ ìµœì ì˜ ì•¡ì…˜ì„ ìˆ˜í–‰í•´ì•¼ í•œë‹¤.</p>

<h3 id="ì •ì±…-policy">ì •ì±… (Policy)</h3>

<p>ì—ì´ì „íŠ¸ê°€ ì£¼ì–´ì§„ ìƒíƒœì—ì„œ ì•¡ì…˜ì„ ì„ íƒí•˜ëŠ” í™•ë¥ ì´ë‹¤.</p>

<p>\(\pi(s,a) = \pi (a|s) = \mathbb P[A_t = a | S_t = s]\)</p>

<p>ì˜ˆë¥¼ ë“¤ì–´ì„œ \(\pi (1 | 5) = 0.25\) ë¼ëŠ” ê²ƒì€ 5ë²ˆ ìƒíƒœì—ì„œ ì•„ë˜ë¡œ ì´ë™í•˜ëŠ” ì•¡ì…˜(1) ì„ ìˆ˜í–‰í•  í™•ë¥ ì„ 25%ë¡œ ì •í•œë‹¤ëŠ” ëœ»ì´ë‹¤.</p>

<h3 id="ìƒíƒœ-ê°€ì¹˜-state-value">ìƒíƒœ ê°€ì¹˜ (State Value)</h3>

<p>ìƒíƒœ ê°€ì¹˜ëŠ” ìƒíƒœ s ì—ì„œ ê¸°ëŒ€ë˜ëŠ” ë¯¸ë˜ ë³´ìƒì˜ í•©ì´ë‹¤.</p>

<p>\(v_{\pi}(s) = \mathbb E_{\pi} [G_t | S_t = s]\)</p>

<h3 id="q-value-state-action-value">Q-value (State Action Value)</h3>

<p>Q-valueëŠ” ìƒíƒœ s ì—ì„œ ì•¡ì…˜ a ë¥¼ ìˆ˜í–‰í•  ê²½ìš°ì— ê¸°ëŒ€ë˜ëŠ” ë¯¸ë˜ ë³´ìƒì˜ í•©ì´ë‹¤.</p>

<p>\(q_{\pi}(s,a) = \mathbb E_{\pi} [G_t | S_t = s, A_t = a]\)</p>

<h3 id="ìµœì -ê°€ì¹˜-optimal-value">ìµœì  ê°€ì¹˜ (Optimal Value)</h3>

<p>ìƒíƒœ s ì—ì„œ ê°€ì¥ í° Q-valueì´ë‹¤.</p>

<p>\(q_*(s,a) = \max_{\pi} q_{\pi}(s,a)\)</p>

<h3 id="ìµœì -ì •ì±…-optimal-policy">ìµœì  ì •ì±… (Optimal Policy)</h3>

<p>\(q_*(s,a)\)ê°€ ê²°ì • ë˜ë©´ \(\pi (s, a) = 1\) ì´ ëœë‹¤. ì¦‰ ìƒíƒœ sì¼ë•ŒëŠ” 100% ì•¡ì…˜ aë¥¼ ìˆ˜í–‰ í•œë‹¤.</p>

<p>\( \pi_*(s, a) = \begin{cases}
1 &amp; \text{if } a= \text{argmax}_{a \in A} q_\star(s,a) \\
0 &amp; \text{otherwise}
\end{cases} \)</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì—ì´ì „íŠ¸ëŠ”<br />
ê° ìƒíƒœ(state)ì˜ ì•¡ì…˜(action)ë§ˆë‹¤<br />
Q-valueë¥¼ ê³„ì‚°í•œë‹¤.</p>

<p>ì—ì´ì „íŠ¸ê°€
ìµœì ì˜ ì•¡ì…˜ì„ í•˜ê¸° ìœ„í•´ì„œëŠ”<br />
ê° ìƒíƒœì—ì„œ Q-valueì˜ ìµœê³ ê°’ì„ ê°€ì§„<br />
ì•¡ì…˜ì„ ìˆ˜í–‰í•˜ë©´ ëœë‹¤!</p>

<p>ê·¸ëŸ°ë°<br />
Q-valueë¥¼ ì–´ë–»ê²Œ ì°¾ì§€?</p>
</blockquote>

<h3 id="ë©”ëª¨ë¦¬-memory">ë©”ëª¨ë¦¬ (Memory)</h3>

<p>ëœë¤ ì•¡ì…˜ì—ì„œ ì–»ì€ ë°ì´í„° (\(s_t, a_t\)) ë“¤ì„ ëª¬í…Œ ì¹´ë¥¼ë¡œì—ì„œ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ë©”ëª¨ë¦¬(memory)ì— ì €ì¥í•œë‹¤.</p>

<p>\(\text{memory} = [(s_0, a_0), (s_1, a_1), \cdots]\)</p>

<h3 id="monte-carlo-ëª¬í…Œ-ì¹´ë¥¼ë¡œ">Monte Carlo (ëª¬í…Œ ì¹´ë¥¼ë¡œ)</h3>

<p>&lsquo;ì–¼ìŒí˜¸ìˆ˜&rsquo; ì—ì„œ <code>S</code>(Start)ì—ì„œ ì‹œì‘í•´ì„œ <code>H</code>(Hole)ì— ë¹ ì§€ê±°ë‚˜  <code>G</code>(Goal)ì— ë„ì°©í•˜ë©´ ê²Œì„ì„ ëì´ë‚œë‹¤. ì´ ê²ƒì„ <strong>ì—í”¼ì†Œë“œ(episode)</strong> ë¼ê³  í•œë‹¤.  í•˜ë‚˜ì˜ ì—í”¼ì†Œë“œê°€ ëë‚˜ë©´ ì—í”¼ì†Œë“œì—ì„œ ì§€ë‚˜ì™”ë˜ ìƒíƒœ(state)ì— ëŒ€í•´ì„œ Q-valueë¥¼ êµ¬í•œë‹¤. ê·¸ë¦¬ê³  ê³„ì†í•´ì„œ ì—í”¼ì†Œë“œë¥¼ ì‹¤í–‰ ì‹œí‚¤ë©´ì„œ ì§€ë‚˜ì˜¨ ìƒíƒœ(state)ì— ëŒ€í•œ Q-valueë¥¼ ì—…ë°ì´íŠ¸ í•˜ë©´ ê²°êµ­ ìµœì ì˜ Q-valueë¥¼ êµ¬í•  ìˆ˜ ìˆë‹¤. ì´ê²ƒì´ ëª¬í…Œ ì¹´ë¥¼ë¡œ ë°©ë²•(Monte Carlo method)ì´ë‹¤. ì´ë•Œ ì•¡ì…˜ì€ ëœë¤ìœ¼ë¡œ ê²°ì •í•œë‹¤.</p>

<p>\(\pi(0|\cdot) = \pi(1|\cdot) = \pi(2|\cdot) = \pi(3|\cdot) = 0.25\)</p>

<p>í•˜ë‚˜ì˜ ì—í”¼ì†Œë“œê°€ ëë‚˜ë©´ ì•„ë˜ì™€ ê°™ì´ Q-valueë¥¼ êµ¬í•œë‹¤.</p>

<p>\(k\): Sample kë²ˆì§¸ ì—í”¼ì†Œë“œ</p>

<p>\(\begin{align}
N(S_t, A_t) &amp; \leftarrow N(S_t, A_t) + 1 \\
Q(S_t, A_t) &amp; \leftarrow Q(S_t, A_t) + \dfrac{1}{N(S_t, A_t)} \left( G_t - Q(S_t, A_t) \right)<br />
\end{align}\)</p>

<h4 id="target">Target</h4>

<p>ëª©í‘œë¡œ í•˜ëŠ” ê°’ì´ë‹¤. ì—¬ê¸°ì„œ íƒ€ê²Ÿì€ \(G_t\)ì´ë‹¤.</p>

<h4 id="error-ë¸íƒ€">Error (ë¸íƒ€)</h4>

<p>ëª©í‘œê°’ê³¼ í˜„ì¬ê°’ê³¼ì˜ ì°¨ì´ë¥¼ \(\delta\) ë¼ê³  í•œë‹¤.<br />
\(\delta_t = G_t - Q(S_t, A_t) \)</p>

<p>ê³„ì†í•´ì„œ ì—í”¼ì†Œë“œë¥¼ ì‹¤í–‰ ì‹œí‚¤ë©´ì„œ \(Q(S_t, A_t)\)ì—ë‹¤ê°€ \(\delta_t\) ì˜ í‰ê· ì„ ì—…ë°ì´íŠ¸ í•˜ë©´ ê²°êµ­ \(Q(s, a) \rightarrow q_*(s,a)\)ê°€ ëœë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì•„í•˜! ìµœì ì˜ Q-valueë¥¼  ì°¾ì•„ ê°€ëŠ” ê²ƒì´ ê°•í™” í•™ìŠµ(Reinfocement Learning)í•˜ëŠ” ë°©ë²•ì´êµ¬ë‚˜!</p>
</blockquote>

<h2 id="í•™ìŠµ-learning">í•™ìŠµ (Learning)</h2>

<p>ëª¬í…Œ ì¹´ë¥¼ë¡œë¥¼ ì´ìš©í•´ì„œ ìµœì ì˜ Q-valueë¥¼ ì°¾ì•„ë³´ì!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tqdm <span style="color:#f92672">import</span> tqdm

num_state <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>observation_space<span style="color:#f92672">.</span>n
num_action <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>action_space<span style="color:#f92672">.</span>n
num_episode <span style="color:#f92672">=</span> <span style="color:#ae81ff">5000</span>

<span style="color:#75715e"># Q_table</span>
Q_table <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros((num_state, num_action))
<span style="color:#75715e"># N_table</span>
N_table <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros((num_state, num_action))
<span style="color:#75715e"># R_table</span>
R_table <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>zeros((num_state, num_action))

<span style="color:#66d9ef">for</span> episode <span style="color:#f92672">in</span> tqdm(range(num_episode)):
    memory <span style="color:#f92672">=</span> []    
    state <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>reset()
    
    <span style="color:#66d9ef">for</span> step <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">100</span>):
        action <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>action_space<span style="color:#f92672">.</span>sample()        
        memory<span style="color:#f92672">.</span>append((state, action)) <span style="color:#75715e"># trajectory</span>
        next_state, reward, done, info <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>step(action)
        R_table[state][action] <span style="color:#f92672">=</span> reward
        state <span style="color:#f92672">=</span> next_state
        
        <span style="color:#66d9ef">if</span> done: <span style="color:#75715e"># an episode finished  </span>
            <span style="color:#75715e">#</span>
            <span style="color:#75715e"># Monte Carlo policy evaluation</span>
            <span style="color:#75715e">#</span>
            G_t <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
            <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(len(memory)):
                gamma <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.6</span> <span style="color:#75715e"># discount factor</span>
                <span style="color:#66d9ef">for</span> j <span style="color:#f92672">in</span> range( i, len(memory) ):
                    S_t <span style="color:#f92672">=</span> memory[j][<span style="color:#ae81ff">0</span>]
                    A_t <span style="color:#f92672">=</span> memory[j][<span style="color:#ae81ff">1</span>]
                    <span style="color:#66d9ef">if</span> i<span style="color:#f92672">==</span>j:
                        G_t <span style="color:#f92672">+=</span> R_table[S_t][A_t]
                    <span style="color:#66d9ef">else</span>:
                        G_t <span style="color:#f92672">+=</span> gamma <span style="color:#f92672">*</span> R_table[S_t][A_t]
                        gamma <span style="color:#f92672">=</span> gamma <span style="color:#f92672">*</span> gamma
                S_t <span style="color:#f92672">=</span> memory[i][<span style="color:#ae81ff">0</span>]
                A_t <span style="color:#f92672">=</span> memory[i][<span style="color:#ae81ff">1</span>]
                N_table[S_t][A_t] <span style="color:#f92672">+=</span> <span style="color:#ae81ff">1</span>
                Q_table[S_t][A_t] <span style="color:#f92672">+=</span> (G_t <span style="color:#f92672">-</span> Q_table[S_t][A_t]) <span style="color:#f92672">/</span> N_table[S_t][A_t]
            <span style="color:#66d9ef">break</span></code></pre></div>
<pre><code>100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 5000/5000 [00:00&lt;00:00, 7738.95it/s]
</code></pre>

<h2 id="í•´ê²°-solution">í•´ê²° (Solution)</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">state <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>reset()
done <span style="color:#f92672">=</span> False

<span style="color:#75715e"># Initial world display</span>
world <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>render(mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ansi&#39;</span>)
display(Pretty(world))
sleep(<span style="color:#ae81ff">0.5</span>)

<span style="color:#66d9ef">while</span> <span style="color:#f92672">not</span> done:
    action <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>argmax(Q_table[state]) <span style="color:#75715e"># Optimal Policy</span>
    state, reward, done, info <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>step(action)
    
    <span style="color:#75715e"># updated world display</span>
    world <span style="color:#f92672">=</span> env<span style="color:#f92672">.</span>render(mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;ansi&#39;</span>)
    clear_output(wait<span style="color:#f92672">=</span>True)
    display(Pretty(world))
    sleep(<span style="color:#ae81ff">0.5</span>)
    
    <span style="color:#66d9ef">if</span> done <span style="color:#f92672">and</span> state <span style="color:#f92672">==</span> <span style="color:#ae81ff">15</span>:
        <span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74"> ğŸ‰ğŸ‘ ì„±ê³µ! ğŸºğŸ¥‡&#39;</span>)</code></pre></div>
<pre><code>  (Right)
SFFF
FHFH
FFFH
HFF[41mG[0m




 ğŸ‰ğŸ‘ ì„±ê³µ! ğŸºğŸ¥‡
</code></pre>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/environment/" rel="tag">Environment</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/agent/" rel="tag">Agent</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/state/" rel="tag">State</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/action/" rel="tag">Action</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/reward/" rel="tag">Reward</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/policy/" rel="tag">Policy</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/q-value/" rel="tag">Q-value</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/monte-carlo/" rel="tag">Monte-Carlo</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/long_short_term_memory/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">Long Short-Term Memory (LSTM)</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/post/sarsa_learning/" rel="next"><span class="post-nav__caption">Next&thinsp;Â»</span><p class="post-nav__post-title">SARSA Learning</p></a>
	</div>
</nav>
<script src="https://utteranc.es/client.js"
        repo="skettee/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 skettee.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>