<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ë¡œì§€ìŠ¤í‹± íšŒê·€ (Logistic Regression) - ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="ë¡œì§€ìŠ¤í‹± íšŒê·€ (Logistic Regression)" />
<meta property="og:description" content="ë”¥ëŸ¬ë‹ì˜ ì„¸ê³„ë¡œ ë“¤ì–´ê°€ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•˜ëŠ” ë‘ë²ˆì§¸ ëª¨ë¸ì¸ ë¡œì§€ìŠ¤í‹± íšŒê·€(Logistic Regression)ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/logistic_regression/" />
<meta property="article:published_time" content="2019-08-16T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-08-16T00:00:00+00:00" />

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ" rel="home">
				<div class="logo__title">ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</div>
				<div class="logo__tagline">ë”¥ëŸ¬ë‹ ëª¨ë¸ë§</div>
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ë¡œì§€ìŠ¤í‹± íšŒê·€ (Logistic Regression)</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2019-08-16T00:00:00">2019-08-16</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/deep-learning" rel="category">Deep Learning</a>, <a class="meta__link" href="/categories/logistic-regression" rel="category">Logistic Regression</a></span>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</a></li>
<li><a href="#ë°ì´í„°-ìˆ˜ì§‘-data-collection">ë°ì´í„° ìˆ˜ì§‘ (Data Collection)</a></li>
<li><a href="#ë°ì´í„°-í´ë Œì§•-data-cleansing">ë°ì´í„° í´ë Œì§• (Data Cleansing)</a></li>
<li><a href="#ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</a></li>
<li><a href="#ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</a></li>
<li><a href="#ë¡œì§€ìŠ¤í‹±-ëª¨ë¸ë§-logistic-modeling">ë¡œì§€ìŠ¤í‹± ëª¨ë¸ë§ (Logistic Modeling)</a>
<ul>
<li><a href="#ì‹œê·¸ëª¨ì´ë“œ-í•¨ìˆ˜-sigmoid-function">ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ (Sigmoid function)</a></li>
<li><a href="#ë¶„ë¥˜-classification-ë¥¼-ìœ„í•œ-ì†ì‹¤-í•¨ìˆ˜-cross-entropy-loss">ë¶„ë¥˜(Classification)ë¥¼ ìœ„í•œ ì†ì‹¤ í•¨ìˆ˜: Cross-entropy Loss</a></li>
<li><a href="#rmsprop">RMSProp</a></li>
<li><a href="#ì •ë¦¬">ì •ë¦¬</a></li>
</ul></li>
<li><a href="#ì¼€ë¼ìŠ¤-keras-ë¡œ-ëª¨ë¸ë§-modeling">ì¼€ë¼ìŠ¤(Keras)ë¡œ ëª¨ë¸ë§(Modeling)</a>
<ul>
<li><a href="#ì •ê·œí™”-normalization">ì •ê·œí™” (Normalization)</a></li>
<li><a href="#ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</a></li>
<li><a href="#ì†ì‹¤ê°’ì˜-ë³€í™”ë¥¼-ê·¸ë˜í”„ë¡œ-í™•ì¸">ì†ì‹¤ê°’ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”„ë¡œ í™•ì¸</a></li>
<li><a href="#w-ì™€-b-ê°’ì„-í™•ì¸">\(w\)ì™€ \(b\)ê°’ì„ í™•ì¸</a></li>
<li><a href="#ê·¸ë˜í”„ë¡œ-í™•ì¸">ê·¸ë˜í”„ë¡œ í™•ì¸</a></li>
</ul></li>
<li><a href="#í•´ê²°-solution">í•´ê²° (Solution)</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<p>ë”¥ëŸ¬ë‹ì˜ ì„¸ê³„ë¡œ ë“¤ì–´ê°€ê¸° ìœ„í•´ ì•Œì•„ì•¼ í•˜ëŠ” ë‘ë²ˆì§¸ ëª¨ë¸ì¸ ë¡œì§€ìŠ¤í‹± íšŒê·€(Logistic Regression)ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!</p>

<p>ì‹¤ì œë¡œ ëŒë ¤ ë³´ê³  ì‹¶ìœ¼ë©´ êµ¬ê¸€ ì½”ë©ìœ¼ë¡œ ~</p>

<p><a href="https://colab.research.google.com/github/skettee/notebooks/blob/master/logistic_regression.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

<h2 id="ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</h2>

<p>ğŸ’° ê³ ê°</p>

<blockquote>
<p>ë•ë¶„ì— &lsquo;ëª¸ì§±ë°˜&rsquo;ì— ë“¤ì–´ ê°”ì–´ìš”. ê³ ë§ˆì›Œìš”!</p>

<p>í•™êµì— ì•„ì£¼ ì¸ê¸°ê°€ ë§ì€ ì—¬í•™ìƒì´ ìˆì–´ìš”~<br />
ê·¸ëŸ°ë° ì´ ì—¬í•™ìƒê³¼ ì¹´í†¡ ì¹œêµ¬ ë§ºê¸°ê°€ ì–´ë ¤ì›Œìš”.<br />
ì•„ë§ˆ í‚¤í¬ê¸°ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¹œì¶”ë¥¼ í•˜ëŠ”ê±° ê°™ì•„ìš”.<br />
ì´ ì—¬í•™ìƒì´ ì¹œì¶”í•œ ì‚¬ëŒì˜ í‚¤ì™€ ê±°ì ˆí•œ ì‚¬ëŒì˜ í‚¤ ë°ì´í„°ë¥¼ ê°€ì§€ê³ <br />
ê·¸ ì—¬í•™ìƒì´ ë‚˜ë¥¼ ì¹œì¶”í• ì§€ ê±°ì ˆí• ì§€ ì˜ˆì¸¡í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ì–´ ì£¼ì„¸ìš”.</p>

<p>ë°ì´í„°ëŠ” ì•„ë˜ì— ìˆì–´ìš”.<br />
<a href="https://skettee.github.io/post/linear_regression/chinchu_data.csv">https://skettee.github.io/post/linear_regression/chinchu_data.csv</a></p>
</blockquote>

<h2 id="ë°ì´í„°-ìˆ˜ì§‘-data-collection">ë°ì´í„° ìˆ˜ì§‘ (Data Collection)</h2>

<p>ë°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•œë‹¤.</p>

<p>Kerasì˜ get_fileì„ ì´ìš©í•´ì„œ ë°ì´í„°ë¥¼ ë‹¤ìš´ë¡œë“œ í•œë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras.utils <span style="color:#f92672">import</span> get_file

fname <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;chinchu_data.csv&#39;</span>
origin <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://skettee.github.io/post/logistic_regression/chinchu_data.csv&#39;</span>
path <span style="color:#f92672">=</span> get_file(fname, origin)</code></pre></div>
<p>CSVíŒŒì¼ì„ ì½ì–´ì„œ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜í•œë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd

df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>read_csv(path, index_col<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)

df<span style="color:#f92672">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>chinchu</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>158.9</td>
      <td>no</td>
    </tr>
    <tr>
      <td>1</td>
      <td>152.4</td>
      <td>no</td>
    </tr>
    <tr>
      <td>2</td>
      <td>161.4</td>
      <td>no</td>
    </tr>
    <tr>
      <td>3</td>
      <td>168.7</td>
      <td>no</td>
    </tr>
    <tr>
      <td>4</td>
      <td>167.9</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="ë°ì´í„°-í´ë Œì§•-data-cleansing">ë°ì´í„° í´ë Œì§• (Data Cleansing)</h2>

<p>ë°ì´í„°ê°€ ë¹µê¾¸ë‚œ ê²ƒì´ ì—†ëŠ”ì§€ í™•ì¸í•œë‹¤. ë¹µê¾¸ë‚œ ë°ì´í„°ëŠ” ì œê±°í•œë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Check nan</span>
df<span style="color:#f92672">.</span>isnull()<span style="color:#f92672">.</span>any()</code></pre></div>
<pre><code>height     True
chinchu    True
dtype: bool
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># Remove row with nan</span>
df <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>dropna(axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)<span style="color:#f92672">.</span>sort_values(<span style="color:#e6db74">&#39;height&#39;</span>)<span style="color:#f92672">.</span>reset_index(drop<span style="color:#f92672">=</span>True)

df<span style="color:#f92672">.</span>head()</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>height</th>
      <th>chinchu</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>150.0</td>
      <td>no</td>
    </tr>
    <tr>
      <td>1</td>
      <td>150.8</td>
      <td>no</td>
    </tr>
    <tr>
      <td>2</td>
      <td>151.6</td>
      <td>no</td>
    </tr>
    <tr>
      <td>3</td>
      <td>152.4</td>
      <td>no</td>
    </tr>
    <tr>
      <td>4</td>
      <td>153.2</td>
      <td>no</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">height_data <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>height
chinchu_data <span style="color:#f92672">=</span> df<span style="color:#f92672">.</span>chinchu

<span style="color:#66d9ef">print</span>(height_data<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(chinchu_data<span style="color:#f92672">.</span>shape)</code></pre></div>
<pre><code>(50,)
(50,)
</code></pre>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë°ì´í„° ë¶„ì„ì´ í¬ê²Œ ì˜ë¯¸ê°€ ìˆì„ ê²ƒ ê°™ì§€ê°€ ì•Šê³ &hellip;<br />
ì¼ë‹¨ ì¹œì¶”ë¥¼ ìš”ì²­í•˜ë©´ ê²°ê³¼ë¥¼ ì‰½ê²Œ ì•Œ ìˆ˜ ìˆì„ê²ƒ ê°™ì€ë°&hellip;</p>
</blockquote>

<p>ğŸ’°ğŸ’° ê³ ê°</p>

<blockquote>
<p>ë”ë¸”!</p>
</blockquote>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì§€ê¸ˆ ë°”ë¡œ ë¶„ì„ ë“¤ì–´ê°‘ë‹ˆë‹¤~</p>
</blockquote>

<h2 id="ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</h2>

<p>ë°ì´í„°ê°€ ì–´ë–¤ ëª¨ì–‘ì¸ì§€ í™•ì¸í•´ ë³´ì.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>matplotlib inline

<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt

plt<span style="color:#f92672">.</span>scatter(height_data, chinchu_data)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;height (cm)&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;chinchu (yes or no)&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_13_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì•„&hellip;<br />
ì•ì—ì„œ ë°°ìš´ &lsquo;ì„ í˜• íšŒê·€&rsquo;ë¡œëŠ”<br />
ë‹µì´ ë‚˜ì˜¬ ê²ƒ ê°™ì§€ ì•Šë‹¤&hellip;</p>
</blockquote>

<h2 id="ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</h2>

<p>í‚¤ì™€ ì¹œì¶” ë°ì´í„°ë¥¼ ê°ê° ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ë³€í™˜í•˜ì<br />
 - ì—´ì˜ í¬ê¸°ëŠ” ë°ì´í„°ì˜ ê°œìˆ˜<br />
 - ì»¬ëŸ¼ì˜ í¬ê¸°ëŠ” ì¸¡ì •í•œ í•­ëª©ì˜ ê°œìˆ˜</p>

<p>í‚¤ ê°’ì„ ì…ë ¥í•˜ë©´ &lsquo;ì¹œì¶”&rsquo;ê°€ëŠ¥ ì—¬ë¶€(yes or no)ë¥¼ ì˜ˆì¸¡í•´ì•¼ í•œë‹¤. í‚¤ ë°ì´í„°ë¥¼ ì…ë ¥ xë¼ê³  í•˜ê³  ì¹œì¶” ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ì¶œë ¥ yë¼ê³  í•˜ì</p>

<ul>
<li>í‚¤ ë°ì´í„°ëŠ” 50ê°œì˜ &lsquo;í‚¤&rsquo;ë¥¼ ì¸¡ì •í•œ ë°ì´í„°ê°€ ìˆìœ¼ë¯€ë¡œ 50X1 ë§¤íŠ¸ë¦­ìŠ¤<br /></li>
<li>ì¹œì¶” ë°ì´í„°ëŠ” 50ê°œì˜ &lsquo;ì¹œì¶” ì—¬ë¶€&rsquo;ë¥¼ ì¸¡ì •í•œ ë°ì´í„°ê°€ ìˆìœ¼ë¯€ë¡œ 50X1 ë§¤íŠ¸ë¦­ìŠ¤ì´ë‹¤.<br /></li>
</ul>

<p>ì†ì‹¤ í•¨ìˆ˜(Loss function)ë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ì„œëŠ” &lsquo;yes&rsquo;, &lsquo;no&rsquo;ë¥¼ ê³„ì‚°ì´ ê°€ëŠ¥í•œ ìˆ˜ë¡œ í‘œì‹œí•´ì•¼ í•œë‹¤.<br />
ì—¬ê¸°ì—ì„œëŠ” &lsquo;yes&rsquo;ì™€ &lsquo;no&rsquo; ë‘ê°€ì§€ì˜ ê²°ê³¼ë§Œ ìˆìœ¼ë‹ˆê¹Œ &lsquo;yes&rsquo;ë¥¼ 1ë¡œ, &lsquo;no&rsquo;ë¥¼ 0ìœ¼ë¡œ ë³€í™˜í•œë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">transform_y</span>(y):
    <span style="color:#66d9ef">if</span> y <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;yes&#39;</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>

<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(height_data)<span style="color:#f92672">.</span>reshape(len(height_data), <span style="color:#ae81ff">1</span>)
y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([transform_y(i) <span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> chinchu_data ])<span style="color:#f92672">.</span>reshape(len(chinchu_data), <span style="color:#ae81ff">1</span>)

plt<span style="color:#f92672">.</span>scatter(x, y)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;height (cm)&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;chinchu&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_16_0.png" alt="png" /></p>

<h2 id="ë¡œì§€ìŠ¤í‹±-ëª¨ë¸ë§-logistic-modeling">ë¡œì§€ìŠ¤í‹± ëª¨ë¸ë§ (Logistic Modeling)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë”±ë´ë„ ì„ í˜• íšŒê·€(Linear Regression)ëª¨ë¸ë§ì€ ë‹µì´ ì•„ë‹ˆë‹¤&hellip;<br />
\(y=wx+b\) ë° \(J(w,b)\), ê·¸ë¦¬ê³  ê²½ì‚¬ í•˜ê°•ë²•(Gradient Descent)ì„ ì´ìš©í•˜ë©´ì„œ<br />
ìœ„ì™€ ë¹„ìŠ·í•œ ê·¸ë˜í”„ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆëŠ” ëª¨ë¸ë§ì´<br />
ê³¼ì—° ì¡´ì¬í• ê¹Œ?</p>
</blockquote>

<p><strong>ê³„ë‹¨ í•¨ìˆ˜ (step function)</strong></p>

<p>ìœ„ì˜ ë°ì´í„° ë¶„í¬ì™€ ê°€ì¥ ìœ ì‚¬í•œ ëª¨ì–‘ì„ ê°€ì§€ëŠ” ê³„ë‹¨ í•¨ìˆ˜ë¥¼ ìƒê°í•´ ë³´ì.</p>

<p>\(y=s_{c}(x)\\
\\
s_{c}(x) =
\begin{cases}
0, &amp; x &lt; c \\
1, &amp; x \ge c
\end{cases}\)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>step(x, y)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_19_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì˜¤! ë­”ê°€ ê·¸ëŸ´ì‹¸í•œë°&hellip;<br />
\(z=wx+b\)ë¡œ ë†“ê³ <br />
\(\hat{y}=s_{c}(z)\)ë¡œ ëª¨ë¸ë§í•´ì„œ<br />
\(J(w,b)\) í•¨ìˆ˜ë¥¼ ê·¸ë ¤ë³´ì</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> mean_squared_error
<span style="color:#f92672">from</span> mpl_toolkits <span style="color:#f92672">import</span> mplot3d

<span style="color:#75715e"># w,dì˜ ë²”ìœ„ë¥¼ ê²°ì •í•œë‹¤.</span>
w <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">0.1</span>)
d <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">160</span>, <span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">1</span>)
j_array <span style="color:#f92672">=</span> []

<span style="color:#75715e"># (20, 200) ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ë³€í™˜í•œë‹¤.</span>
W, D <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(w, d)

<span style="color:#75715e"># w, bë¥¼ í•˜ë‚˜ì”© ëŒ€ì‘í•œë‹¤.</span>
<span style="color:#66d9ef">for</span> we, de <span style="color:#f92672">in</span> zip(np<span style="color:#f92672">.</span>ravel(W), np<span style="color:#f92672">.</span>ravel(D)):
    z_hat <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>multiply(we, x)
    y_list <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">for</span> ze <span style="color:#f92672">in</span> z_hat:
        <span style="color:#66d9ef">if</span> ze <span style="color:#f92672">&lt;</span> de:
            y_list<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">0</span>)
        <span style="color:#66d9ef">else</span>:
            y_list<span style="color:#f92672">.</span>append(<span style="color:#ae81ff">1</span>)
    y_hat <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(y_list)
    <span style="color:#75715e"># Cost function</span>
    mse <span style="color:#f92672">=</span> mean_squared_error(y_hat, y) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2.0</span>
    j_array<span style="color:#f92672">.</span>append(mse)

<span style="color:#75715e"># ì†ì‹¤(Loss)ì„ êµ¬í•˜ê³  (20, 200) ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ë³€í™˜í•œë‹¤.</span>
J <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(j_array)<span style="color:#f92672">.</span>reshape(W<span style="color:#f92672">.</span>shape)

<span style="color:#75715e"># ì„œí”¼ìŠ¤ ê·¸ë˜í”„ë¥¼ ê·¸ë¦°ë‹¤.</span>
fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure()
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes(projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;3d&#34;</span>)

ax<span style="color:#f92672">.</span>plot_surface(W, D, J, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;b&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;w&#39;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;d&#39;</span>)
ax<span style="color:#f92672">.</span>set_zlabel(<span style="color:#e6db74">&#39;J&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_21_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë‚´ ì´ëŸ´ì¤„ ì•Œì•˜ë‹¤&hellip;<br />
ê²°ë¡ ì ìœ¼ë¡œ ê³„ë‹¨ í•¨ìˆ˜(Step function)ëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤!<br />
ì™œëƒí•˜ë©´&hellip;</p>

<p>\(J(w,b)\)ê°€ <strong>ë¯¸ë¶„ ë¶ˆê°€ëŠ¥</strong> í•˜ê¸° ë•Œë¬¸ì´ë‹¤!</p>

<p>ë¯¸ë¶„ ê°€ëŠ¥í•˜ë©´ì„œë„ ê³„ë‹¨ í•¨ìˆ˜ì™€ ë¹„ìŠ·í•œ í•¨ìˆ˜ë¥¼ ì°¾ì•„ì•¼ í•œë‹¤&hellip;</p>

<p>ë‹¤í–‰íˆ<br />
<strong>Së¼ì¸</strong>ì˜ ë©‹ì§„ í•¨ìˆ˜ê°€ ìˆë‹¤!</p>

<p>ê·¸ê²ƒì€ ë°”ë¡œ~</p>
</blockquote>

<h3 id="ì‹œê·¸ëª¨ì´ë“œ-í•¨ìˆ˜-sigmoid-function">ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ (Sigmoid function)</h3>

<p>ì—”ì§€ë‹ˆì–´ë“¤ì€ ë¯¸ë¶„ì´ ì˜ ë˜ê³  \(x\)ì— ì–´ë–¤ ê°’ì„ ë„£ì–´ë„ 0ì´ë‚˜ 1ì˜ ê°’ì— ê°€ê¹Œìš´ ê°’ì„ ê°€ì§€ëŠ” í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ ëƒˆë‹¤.<br />
ì´ê²ƒì´ ì‹œê·¸ëª¨ì´ë“œ í•¨ìˆ˜ë‹¤.</p>

<p>\(\sigma(x) = {1 \over {1 + e^{-x}}}\)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">sigmoid <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x: <span style="color:#ae81ff">1.0</span> <span style="color:#f92672">/</span> (<span style="color:#ae81ff">1.0</span> <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>x))

xx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">100</span>)

plt<span style="color:#f92672">.</span>plot(xx, sigmoid(xx))
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_24_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì˜¤! ë©‹ì§„ë°&hellip;<br />
\(z=wx+b\)ë¡œ ë†“ê³ <br />
\(\hat{y}=\sigma(z)\)ë¡œ ëª¨ë¸ë§í•´ì„œ<br />
\(J(w,b)\) í•¨ìˆ˜ë¥¼ ê·¸ë ¤ë³´ì</p>

<p>ì—¬ê¸°ì„œ ìš°ë¦¬ëŠ” ìƒˆë¡œìš´ ì†ì‹¤ í•¨ìˆ˜(Loss function)ë¥¼ ì‚¬ìš©í•  ê²ƒì´ë‹¤.</p>
</blockquote>

<h3 id="ë¶„ë¥˜-classification-ë¥¼-ìœ„í•œ-ì†ì‹¤-í•¨ìˆ˜-cross-entropy-loss">ë¶„ë¥˜(Classification)ë¥¼ ìœ„í•œ ì†ì‹¤ í•¨ìˆ˜: Cross-entropy Loss</h3>

<p>í•˜ë‚˜ì˜ ë°ì´í„° ì„¸íŠ¸(\(x^{(i)}, y^{(i)}\))ë¥¼ ì‚¬ìš©í•´ì„œ ëª¨ë¸ì—ì„œ ì–»ì€ ê°’ê³¼ ì‹¤ì œ ê°’ê³¼ì˜ ì°¨ì´(Loss)ë¥¼ êµ¬í•˜ëŠ” í•¨ìˆ˜ë¥¼ êµ¬í•´ë³´ì.<br />
ì—¬ê¸°ì„œ \(x^{(i)}\)ëŠ” ië²ˆì§¸ \(x\)ê°’ì´ê³  \(y^{(i)}\)ì€ ië²ˆì§¸ \(y\)ê°’ì´ë‹¤.</p>

<p>ì¼ë‹¨ \(w\)ì™€ \(b\)ëŠ” ì„ì˜ì˜ ê°’ìœ¼ë¡œ ë†“ì. ê·¸ë¦¬ê³  ëª¨ë¸ì— \(x^{(i)}\)ì„ ë„£ê³  ê³„ì‚°í•œ ê²°ê³¼ ê°’ \({\hat y}^{(i)}\)ê³¼ ì‹¤ì œ ê°’ \(y^{(i)}\)ì˜ ì°¨ì´ë¥¼ êµ¬í•œë‹¤. ë¡œì§€ìŠ¤í‹± ëª¨ë¸ë§ì—ì„œëŠ” í¬ë¡œìŠ¤ ì—”íŠ¸ë¡œí”¼ ì†ì‹¤(Cross-entropy loss)ì„ ì‚¬ìš©í•œë‹¤.</p>

<p>\(L({\hat y}^{(i)}, y^{(i)})=-\bigl (y^{(i)}log({\hat y}^{(i)}) + (1-y^{(i)})log(1-{\hat y}^{(i)})\bigr)\)</p>

<p>ëª¨ë“  ë°ì´í„°(mê°œì˜ ë°ì´í„° ì„¸íŠ¸)ë¡œ ë¶€í„° ì–»ì€ ê²ƒì„ í‰ê·  í•œê²ƒì´ ì†ì‹¤ í•¨ìˆ˜(Loss function)ì´ë‹¤. ì†ì‹¤ í•¨ìˆ˜ëŠ” \(w\)ì™€ \(b\)ì˜ í•¨ìˆ˜ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤.</p>

<p>\({\large J}(w, b) = {1\over m}\sum_{i=1}^m L({\hat y}^{(i)}, y^{(i)}) \\
\\
\hspace{2.9em}= -{1\over {m}}\sum_{i=1}^m [(y^{(i)}log({\hat y}^{(i)})) + (1-y^{(i)})log(1-{\hat y}^{(i)})]\)</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ì œë¶€í„°<br />
ì„ í˜• íšŒê·€(Linear regression) ëª¨ë¸ì—ì„œ ì‚¬ìš©ëœ ì†ì‹¤ í•¨ìˆ˜ì¸<br />
í‰ê·  ì œê³± ì˜¤ì°¨ (mean squared error)ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³ <br />
ê³ ì–‘ì´ëƒ ê°œëƒ í† ë¼ëƒ, Yes or No ë“±ì˜ ë¶„ë¥˜(Classification) ë¬¸ì œë¥¼ ìœ„í•œ ì†ì‹¤ í•¨ìˆ˜ë¡œì„œ<br />
ì•„ë˜ì˜ ì†ì‹¤ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤.</p>

<p>\({\large J}(w, b) = -{1\over {m}}\sum_{i=1}^m [(y^{(i)}log({\hat y}^{(i)})) + (1-y^{(i)})log(1-{\hat y}^{(i)})]\)</p>

<p>ì—”ì§€ë‹ˆì–´ë¥¼ ê°ˆì•„ì„œ ë§Œë“  ê²ƒì´ë‹ˆ<br />
ìš°ë¦¬ëŠ” ì‚¬ìš©í•˜ê¸°ë§Œ í•˜ë©´ ëœë‹¤</p>
</blockquote>

<p><strong>ì†ì‹¤ í•¨ìˆ˜ (Loss function) ì‹œê°í™”</strong></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ìš°ì„  ì†ì‹¤ í•¨ìˆ˜(Loss function)ê°€ ì–´ë–»ê²Œ ìƒê²¨ ë¨¹ì—ˆëŠ”ì§€ ì‚´í´ ë³´ì.<br />
xì¶•ì„ \(w\)ë¡œ ë†“ê³ , yì¶•ì„ \(b\)ë¡œ ë†“ê³ , zì¶•ì„ ì†ì‹¤ í•¨ìˆ˜ \({\large J}(w, b)\)ë¡œ
ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ ë³´ë©´<br />
ì–´ë–»ê²Œ ìµœì†Œê°’ì„ ì°¾ì„ì§€ ê°ì´ ì˜¬ ê²ƒ ê°™ë‹¤.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.metrics <span style="color:#f92672">import</span> log_loss

cross_entropy_loss <span style="color:#f92672">=</span> True

<span style="color:#75715e"># W,bì˜ ë²”ìœ„ë¥¼ ê²°ì •í•œë‹¤.</span>
w <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">20</span>, <span style="color:#ae81ff">30</span>, <span style="color:#ae81ff">0.1</span>)
b <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#f92672">-</span><span style="color:#ae81ff">4595</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">4585</span>, <span style="color:#ae81ff">0.1</span>)

j_loss <span style="color:#f92672">=</span> []

<span style="color:#75715e"># ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ë³€í™˜í•œë‹¤.</span>
W, B <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(w, b)

<span style="color:#75715e"># w, bë¥¼ í•˜ë‚˜ì”© ëŒ€ì‘í•œë‹¤.</span>
<span style="color:#66d9ef">for</span> we, be <span style="color:#f92672">in</span> zip(np<span style="color:#f92672">.</span>ravel(W), np<span style="color:#f92672">.</span>ravel(B)):
    z <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>add(np<span style="color:#f92672">.</span>multiply(we, x), be)
    y_hat <span style="color:#f92672">=</span> sigmoid(z)
    <span style="color:#75715e"># Loss function</span>
    <span style="color:#66d9ef">if</span> cross_entropy_loss: 
        loss <span style="color:#f92672">=</span> log_loss(y, y_hat) <span style="color:#75715e"># Log loss, aka logistic loss or cross-entropy loss.</span>
        j_loss<span style="color:#f92672">.</span>append(loss)
    <span style="color:#66d9ef">else</span>:
        loss <span style="color:#f92672">=</span> mean_squared_error(y_hat, y) <span style="color:#f92672">/</span> <span style="color:#ae81ff">2.0</span> <span style="color:#75715e"># Mean squred error</span>
        j_loss<span style="color:#f92672">.</span>append(loss)

<span style="color:#75715e"># ì†ì‹¤(Loss)ì„ êµ¬í•œë‹¤.</span>
J <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array(j_loss)<span style="color:#f92672">.</span>reshape(W<span style="color:#f92672">.</span>shape)

<span style="color:#75715e"># ì„œí”¼ìŠ¤ ê·¸ë˜í”„ë¥¼ ê·¸ë¦°ë‹¤.</span>
fig <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>figure()
ax <span style="color:#f92672">=</span> plt<span style="color:#f92672">.</span>axes(projection<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;3d&#34;</span>)
ax<span style="color:#f92672">.</span>plot_surface(W, B, J, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;b&#39;</span>, alpha<span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span>)
ax<span style="color:#f92672">.</span>set_xlabel(<span style="color:#e6db74">&#39;w&#39;</span>)
ax<span style="color:#f92672">.</span>set_ylabel(<span style="color:#e6db74">&#39;b&#39;</span>)
ax<span style="color:#f92672">.</span>set_zlabel(<span style="color:#e6db74">&#39;J&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_28_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>V ëª¨ì–‘ìœ¼ë¡œ êµ¬ë¶€ëŸ¬ì§„ ëª¨ì–‘ì´ë‹¤!<br />
\(w\)ê°€ 27ê·¼ì²˜ì—ì„œ ì†ì‹¤ í•¨ìˆ˜ê°€ ìµœì†Œê°’ì„ ê°€ì§€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>ì†ì‹¤ í•¨ìˆ˜ê°€ ìµœì†Œê°€ ë˜ëŠ” \(w\)ì™€ \(b\)ë¥¼ ë¹ ë¥´ê²Œ ì°¾ê¸° ìœ„í•´ì„œ<br />
ê²½ì‚¬ í•˜ê°•ë²•(Gradient Descent)ë³´ë‹¤ ì„±ëŠ¥ì´ ìš°ìˆ˜í•œ<br />
<strong>RMSProp</strong> ì„ ì‚¬ìš©í•œë‹¤.</p>
</blockquote>

<h3 id="rmsprop">RMSProp</h3>

<p>RMSPropì˜ ì›ë¦¬ëŠ” ê¸‰ê²½ì‚¬ì¸ ê²½ìš°ì—ëŠ” ë³´í­ì„ ë‚®ì¶”ì–´ì„œ ê°€ì¥ ì•„ë˜ì¸ì§€ë¥¼ ì„¸ë°€íˆ ì‚´í”¼ê³ , ì™„ë§Œí•œ ê²½ì‚¬ì¸ ê²½ìš°ì—ëŠ” ë³´í­ì„ ë„“í˜€ì„œ ë¹¨ë¦¬ ì§€ë‚˜ê°€ëŠ” ë°©ì‹ì´ë‹¤.<br />
ì´ ë°©ì‹ì€ ë§¤ìš° ë¹ ë¥´ê²Œ ì†ì‹¤ í•¨ìˆ˜ì˜ ìµœì†Œê°’ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.</p>

<p>\(dw = {\partial {J(w,b)}\over \partial w}\),<br />
\(db = {\partial{J(w,b)}\over \partial b}\)</p>

<p>REPEAT(epoch) {<br />
\(w:=w-\alpha {dw \over {\sqrt {S_{dw}} + \epsilon}}\)</p>

<p>\(b:=b-\alpha {db \over {\sqrt {S_{db}} + \epsilon}}\)<br />
}</p>

<p>\(S_{dw} = \rho S_{dw} + (1-\rho)dw^2\),<br />
\(S_{db} = \rho S_{db} + (1-\rho)db^2\)</p>

<p>\(\alpha=0.001\) : learining rate,<br />
\(\rho=0.9\) : discounting factor,<br />
\(\epsilon=1e-07\) : small value to avoid zero denominator</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ê²ƒë„ ì—”ì§€ë‹ˆì–´ë¥¼ ê°ˆì•„ì„œ ë§Œë“  ê²ƒì´ë‹ˆ<br />
ìš°ë¦¬ëŠ” ì‚¬ìš©í•˜ê¸°ë§Œ í•˜ë©´ ëœë‹¤</p>
</blockquote>

<h3 id="ì •ë¦¬">ì •ë¦¬</h3>

<p>ë¡œì§€ìŠ¤í‹± ëª¨ë¸(Logistic model)ì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì •ë¦¬í•´ ë³´ì.</p>

<ol>
<li>\(z=wx+b\) í•¨ìˆ˜ë¥¼ ì •ì˜í•œë‹¤.<br /></li>
<li>\(a = \sigma(z)\) í•¨ìˆ˜ë¥¼ ì •ì˜í•œë‹¤. \(a\)ë¥¼ <strong>í™œì„± í•¨ìˆ˜(activation function)</strong> ë¼ê³  í•œë‹¤.<br /></li>
<li>\(\hat{y} = a\) ì´ë‹¤.</li>
<li>ì†ì‹¤ í•¨ìˆ˜ (Loss function)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>í¬ë¡œìŠ¤-ì—”íŠ¸ë¡œí”¼ ì†ì‹¤(cross-entropy loss)</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.<br /></li>
<li>ì˜µí‹°ë§ˆì´ì €(Optimizer)ë¥¼ ì„ íƒí•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>RMSProp</strong>ì„ ì‚¬ìš©í•œë‹¤.<br /></li>
<li>ë°˜ë³µí•  íšŒìˆ˜(epoch)ë¥¼ ê²°ì •í•œë‹¤.<br /></li>
<li>ì£¼ì–´ì§„ ì¡°ê±´ìœ¼ë¡œ ëª¨ë¸ì„ ìµœì í™”(fit) ì‹œí‚¨ë‹¤.<br /></li>
</ol>

<h2 id="ì¼€ë¼ìŠ¤-keras-ë¡œ-ëª¨ë¸ë§-modeling">ì¼€ë¼ìŠ¤(Keras)ë¡œ ëª¨ë¸ë§(Modeling)</h2>

<h3 id="ì •ê·œí™”-normalization">ì •ê·œí™” (Normalization)</h3>

<p><code>ì •ê·œê°’ = (í˜„ì¬ê°’ - ìµœì†Œê°’) / (ìµœëŒ€ê°’-ìµœì†Œê°’)</code> ìœ¼ë¡œ ì •ê·œí™” í•œë‹¤!</p>

<p>ê·¸ë˜í”„ë¥¼ ë³´ë©´,<br />
ë°ì´í„°ì˜ ëª¨ì–‘ì€ ê·¸ëŒ€ë¡œ ìœ ì§€í•˜ë©´ì„œë„ \(x\)ì¶•ì˜ ê°’ì´ 0ì—ì„œ 1ì‚¬ì´ë¡œ ë³€í™˜ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ì œ ì •ê·œí™”ëŠ”<br />
ì„ íƒì´ ì•„ë‹Œ <strong>í•„ìˆ˜</strong>!</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn <span style="color:#f92672">import</span> preprocessing

mm_scaler <span style="color:#f92672">=</span> preprocessing<span style="color:#f92672">.</span>MinMaxScaler()
X_train <span style="color:#f92672">=</span> mm_scaler<span style="color:#f92672">.</span>fit_transform(x)
Y_train <span style="color:#f92672">=</span> y

plt<span style="color:#f92672">.</span>scatter(X_train, Y_train)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;scaled-height&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;chinchu&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_33_0.png" alt="png" /></p>

<h3 id="ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</h3>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>4ì¤„ë¡œ ëª¨ë¸ë§ì´ ê°€ëŠ¥í•˜ë‹¤!</p>

<p>ì¼€ë¼ìŠ¤ ë§Œë§Œì„¸!</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> Dense, Activation

<span style="color:#75715e"># ëª¨ë¸ì„ ì¤€ë¹„í•œë‹¤.</span>
model <span style="color:#f92672">=</span> Sequential()

<span style="color:#75715e"># ì…ë ¥ ë³€ìˆ˜ì˜ ê°œìˆ˜ê°€ 1ì´ê³  ì¶œë ¥ ê°œìˆ˜ê°€ 1ì¸ y=sigmoid(wx+b)ë¥¼ ìƒì„±í•œë‹¤.</span>
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">1</span>, input_dim<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;sigmoid&#39;</span>))

<span style="color:#75715e"># Loss funtionê³¼ Optimizerë¥¼ ì„ íƒí•œë‹¤.</span>
model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;binary_crossentropy&#39;</span>, optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;rmsprop&#39;</span>) 

<span style="color:#75715e"># epochsë§Œí¼ ë°˜ë³µí•´ì„œ ì†ì‹¤ê°’ì´ ìµœì €ê°€ ë˜ë„ë¡ ëª¨ë¸ì„ í›ˆë ¨í•œë‹¤.</span>
hist <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(X_train, Y_train, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">10000</span>, batch_size<span style="color:#f92672">=</span><span style="color:#ae81ff">20</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>) </code></pre></div>
<pre><code>WARNING: Logging before flag parsing goes to stderr.
W0914 02:12:17.257588 140325522511680 deprecation.py:506] From /home/dataman/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/init_ops.py:1251: calling VarianceScaling.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
W0914 02:12:17.276001 140325522511680 deprecation.py:323] From /home/dataman/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/nn_impl.py:180: add_dispatch_support.&lt;locals&gt;.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
</code></pre>

<h3 id="ì†ì‹¤ê°’ì˜-ë³€í™”ë¥¼-ê·¸ë˜í”„ë¡œ-í™•ì¸">ì†ì‹¤ê°’ì˜ ë³€í™”ë¥¼ ê·¸ë˜í”„ë¡œ í™•ì¸</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>plot(hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;epoch&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;loss&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_37_0.png" alt="png" /></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë°˜ë³µì ìœ¼ë¡œ í•™ìŠµí•  ìˆ˜ë¡ ì†ì‹¤(Loss)ì´ 0ì— ê°€ê¹ê²Œ ëœë‹¤.<br />
ë‚˜ì´ìŠ¤!</p>
</blockquote>

<h3 id="w-ì™€-b-ê°’ì„-í™•ì¸">\(w\)ì™€ \(b\)ê°’ì„ í™•ì¸</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">w, b <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>get_weights()
w <span style="color:#f92672">=</span>  w[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]
b <span style="color:#f92672">=</span> b[<span style="color:#ae81ff">0</span>]
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;w: &#39;</span>, w)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;b: &#39;</span>, b)</code></pre></div>
<pre><code>w:  14.625153
b:  -7.5220504
</code></pre>

<h3 id="ê·¸ë˜í”„ë¡œ-í™•ì¸">ê·¸ë˜í”„ë¡œ í™•ì¸</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">x_scale <span style="color:#f92672">=</span> mm_scaler<span style="color:#f92672">.</span>transform(x)
plt<span style="color:#f92672">.</span>scatter(x_scale, y)
plt<span style="color:#f92672">.</span>plot(x_scale, sigmoid(w<span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>array(x_scale)<span style="color:#f92672">+</span>b), <span style="color:#e6db74">&#39;r&#39;</span>)
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;scaled-height&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;chinchu&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_42_0.png" alt="png" /></p>

<h2 id="í•´ê²°-solution">í•´ê²° (Solution)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ê³ ê°ë‹˜~ ì›í•˜ì‹œëŠ” ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.<br />
input_heightì— ì›í•˜ì‹œëŠ” í‚¤ë¥¼ ì…ë ¥í•˜ì‹œë©´<br />
&lsquo;ì¹œì¶”&rsquo;ê°€ ë  í™•ë¥ ì„ ì•Œë ¤ ì¤ë‹ˆë‹¤.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">input_height <span style="color:#f92672">=</span> <span style="color:#ae81ff">178.0</span>

input_x <span style="color:#f92672">=</span> mm_scaler<span style="color:#f92672">.</span>transform(np<span style="color:#f92672">.</span>array([input_height])<span style="color:#f92672">.</span>reshape(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>))
predict <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(input_x)

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;ì¹œì¶”ê°€ ë  í™•ë¥ ì€ {:.1f}% ì…ë‹ˆë‹¤.&#39;</span><span style="color:#f92672">.</span>format(predict[<span style="color:#ae81ff">0</span>][<span style="color:#ae81ff">0</span>]<span style="color:#f92672">*</span><span style="color:#ae81ff">100</span>))</code></pre></div>
<pre><code>ì¹œì¶”ê°€ ë  í™•ë¥ ì€ 93.8% ì…ë‹ˆë‹¤.
</code></pre>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/sigmoid/" rel="tag">Sigmoid</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/activation-function/" rel="tag">Activation function</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/cross-entropy-loss/" rel="tag">Cross-entropy Loss</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/rmsprop/" rel="tag">RMSProp</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/linear_regression/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">ì„ í˜• íšŒê·€ (Linear Regression)</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/post/neural_network/" rel="next"><span class="post-nav__caption">Next&thinsp;Â»</span><p class="post-nav__post-title">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (Neural Network)</p></a>
	</div>
</nav>
<script src="https://utteranc.es/client.js"
        repo="skettee/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 skettee.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>