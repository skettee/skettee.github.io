<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (NN) - MNIST - ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (NN) - MNIST" />
<meta property="og:description" content="ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(NN) ì‹¤ì „ ë¬¸ì œ! MNISTë¥¼ kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/neural_network_mnist/" />
<meta property="article:published_time" content="2019-08-30T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-08-30T00:00:00+00:00" />

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ" rel="home">
				<div class="logo__title">ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</div>
				<div class="logo__tagline">ë”¥ëŸ¬ë‹ ëª¨ë¸ë§</div>
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (NN) - MNIST</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2019-08-30T00:00:00">2019-08-30</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/deep-learning" rel="category">Deep Learning</a>, <a class="meta__link" href="/categories/neural-network" rel="category">Neural Network</a></span>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</a></li>
<li><a href="#ë°ì´í„°-ìˆ˜ì§‘-data-collection">ë°ì´í„° ìˆ˜ì§‘ (Data Collection)</a></li>
<li><a href="#ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</a>
<ul>
<li><a href="#í›ˆë ¨-ì„¸íŠ¸ì™€-í…ŒìŠ¤íŠ¸-ì„¸íŠ¸-train-and-test-set">í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ (Train and Test set)</a></li>
<li><a href="#ë°ì´í„°-í™•ì¸-data-visualization">ë°ì´í„° í™•ì¸ (Data Visualization)</a></li>
</ul></li>
<li><a href="#ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</a></li>
<li><a href="#ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</a>
<ul>
<li><a href="#relu-rectified-linear-unit">ReLU (Rectified Linear Unit)</a></li>
<li><a href="#adam-adaptive-moment-estimation">Adam (Adaptive moment estimation)</a></li>
<li><a href="#ì •ë¦¬">ì •ë¦¬</a></li>
</ul></li>
<li><a href="#í…ì„œí”Œë¡œìš°-tensorflow-ë¡œ-ëª¨ë¸ë§-modeling">í…ì„œí”Œë¡œìš°(Tensorflow)ë¡œ ëª¨ë¸ë§(Modeling)</a>
<ul>
<li><a href="#ì •ê·œí™”-normalization">ì •ê·œí™” (Normalization)</a></li>
<li><a href="#kerasë¥¼-ê°€ì§€ê³ -ëª¨ë¸ë§-modeling-í•˜ê¸°">Kerasë¥¼ ê°€ì§€ê³  ëª¨ë¸ë§(Modeling)í•˜ê¸°</a></li>
<li><a href="#ëª¨ë¸-í›ˆë ¨">ëª¨ë¸ í›ˆë ¨</a></li>
<li><a href="#ì •í™•ë„-í‰ê°€">ì •í™•ë„ í‰ê°€</a></li>
<li><a href="#ê·œì œ-regularization">ê·œì œ (Regularization)</a></li>
</ul></li>
<li><a href="#í•´ê²°-solution">í•´ê²° (Solution)</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<p>ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(NN) ì‹¤ì „ ë¬¸ì œ! MNISTë¥¼ kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!</p>

<p>ì‹¤ì œë¡œ ëŒë ¤ ë³´ê³  ì‹¶ìœ¼ë©´ êµ¬ê¸€ ì½”ë©ìœ¼ë¡œ ~</p>

<p><a href="https://colab.research.google.com/github/skettee/notebooks/blob/master/neural_network_mnist.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

<h2 id="ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</h2>

<p>ğŸ‘¤ ìƒì‚¬</p>

<blockquote>
<p>ì¸ê³µì§€ëŠ¥ì„ ì´ìš©í•´ì„œ ì‚¬ì§„ì„ ì¸ì‹í•˜ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•œë‹¤<br />
ì¼ë‹¨ ê¸°ë³¸ ê°œë…ì„ ìµíˆê¸° ìœ„í•´ì„œ  ì—°ìŠµ ë¬¸ì œë¥¼ í’€ì–´ë³´ê²Œ</p>

<p>ì•„ë˜ ì‚¬ì´íŠ¸ì— ê°€ë©´  &lsquo;MNIST database of handwritten digits&rsquo; ë°ì´í„° ì„¸íŠ¸ì— ëŒ€í•œ ì„¤ëª…ì´ ìˆë„¤<br />
<a href="https://keras.io/datasets/">https://keras.io/datasets/</a><br />
ì—¬ê¸°ì„œ ì œê³µí•˜ëŠ” MNIST ë°ì´í„° ì„¸íŠ¸ë¡œ í›ˆë ¨í•´ì„œ<br />
ì†ìœ¼ë¡œ ì“´ ìˆ«ìë¥¼ ì¸ì‹í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ë§Œë“¤ì–´ ë³´ê²Œ</p>
</blockquote>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë„µ~</p>

<p>(í˜¼ì£ë§) MNIST? ë­” ë§ì¸ì§€ ëª¨ë¥´ê²ƒë‹¤.. ì¼ë‹¨ ì„¤ëª…ì„ ë³´ì</p>
</blockquote>

<p>0ì—ì„œ 9ê¹Œì§€ ì†ìœ¼ë¡œ ì“´ ìˆ«ì ì´ë¯¸ì§€ ë°ì´í„° ì„¸íŠ¸ë¥¼ MNIST datasetì´ë¼ê³  í•œë‹¤.</p>

<p>ì´ë¯¸ì§€(x)ëŠ” í¬ê¸°ê°€ ê°€ë¡œ 28, ì„¸ë¡œ 28ì´ë©° ê·¸ë ˆì´ ìŠ¤ì¼€ì¼(0 ~ 255ì‚¬ì´ì˜ ê°’)ë¡œ ë˜ì–´ ìˆë‹¤.<br />
ì •ë‹µì§€(y)ëŠ” 0 ~ 9ì‚¬ì´ì˜ ì •ìˆ˜ë¡œ ë˜ì–´ ìˆë‹¤.<br />
í›ˆë ¨ì„ ìœ„í•œ 60,000ê°œì˜ ë°ì´í„° ì„¸íŠ¸(x, y)ì™€<br />
í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ 10,000ê°œì˜ ë°ì´í„° ì„¸íŠ¸(x, y)ê°€ ìˆë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì˜ìƒì¸ì‹ì„ í•˜ë©´ì„œ ê°€ì¥ ì²˜ìŒ ì‹¤ìŠµí•´ ë³´ëŠ”ê²ƒì´ MNIST&hellip;<br />
Cì—ì„œì˜ &lsquo;hello world&rsquo;ê¸‰ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì§€ê¸ˆê¹Œì§€ í•™ìŠµí•œ ëª¨ë¸ë§ ì§€ì‹ì„ ê°€ì§€ê³ <br />
ìˆ«ìë¥¼ ì¸ì‹í•˜ëŠ” NN ëª¨ë¸ì„ ë§Œë“¤ê³ <br />
í›ˆë ¨ê³¼ í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ì„œ<br />
ì •í™•ë„ë¥¼ ê³„ì‚°í•˜ë©´<br />
ë˜ê² êµ°</p>
</blockquote>

<h2 id="ë°ì´í„°-ìˆ˜ì§‘-data-collection">ë°ì´í„° ìˆ˜ì§‘ (Data Collection)</h2>

<p><code>keras.datasets</code>ë¥¼ ì´ìš©í•´ì„œ ê°„ë‹¨í•˜ê²Œ ë°ì´í„°ë¥¼ ê°€ì ¸ ì˜¬ ìˆ˜ ìˆë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì°¬ì–‘í•˜ë¼ Keras!</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>matplotlib inline
<span style="color:#f92672">from</span> tensorflow.keras.datasets <span style="color:#f92672">import</span> mnist
<span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt

<span style="color:#75715e"># train_images, test_images: uint8 array of grayscale image data with shape (num_samples, 28, 28)</span>
<span style="color:#75715e"># train_labels, test_labels: uint8 array of digit labels (integers in range 0-9) with shape (num_samples,)</span>
(train_images, train_labels), (test_images, test_labels) <span style="color:#f92672">=</span> mnist<span style="color:#f92672">.</span>load_data()</code></pre></div>
<h2 id="ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</h2>

<p>ì§€ê¸ˆê¹Œì§€ ë³¸ ë¬¸ì œì™€ëŠ” ì‚¬ì´ì¦ˆê°€ ë‹¤ë¥´ë‹¤!<br />
ìš°ì„  í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì— ëŒ€í•´ì„œ ì•Œì•„ ë³´ì</p>

<h3 id="í›ˆë ¨-ì„¸íŠ¸ì™€-í…ŒìŠ¤íŠ¸-ì„¸íŠ¸-train-and-test-set">í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ (Train and Test set)</h3>

<p>ìš°ë¦¬ê°€ ë§Œë“  ëª¨ë¸ì„ í›ˆë ¨ ì‹œí‚¬ë•Œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ê°€ <strong>í›ˆë ¨ ì„¸íŠ¸ (Train set)</strong><br />
í›ˆë ¨ì„ ë§ˆì¹œ ëª¨ë¸ì— ëŒ€í•´ì„œ ì„±ëŠ¥ì„ í™•ì¸í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ê°€ <strong>í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ (Test set)</strong></p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>í›ˆë ¨ ì„¸íŠ¸ëŠ” í•™êµ ìˆ˜ì—…ì´ê³ <br />
í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ëŠ” ëª¨ì˜ ê³ ì‚¬ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.</p>
</blockquote>

<h3 id="ë°ì´í„°-í™•ì¸-data-visualization">ë°ì´í„° í™•ì¸ (Data Visualization)</h3>

<p>ì„¤ëª…ë§Œ ë“¤ì–´ì„œëŠ” ì–´ë–»ê²Œ ëª¨ë¸ë§ì„ í•´ì•¼ í• ì§€ ê°ì´ ì˜¤ì§€ ì•ŠëŠ”ë‹¤. ë°ì´í„°ë¥¼ ëˆˆìœ¼ë¡œ í™•ì¸í•´ ë³´ì</p>

<p><strong>ì…ë ¥(x) ë°ì´í„° í™•ì¸</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e"># ëª¨ì–‘ (shape) í™•ì¸</span>
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;train_images shape is &#39;</span>, train_images<span style="color:#f92672">.</span>shape)</code></pre></div>
<pre><code>train_images shape is  (60000, 28, 28)
</code></pre>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>kerasê°€ ì¢‹ì•„í•˜ëŠ” ëª¨ì–‘ìœ¼ë¡œ ë˜ì–´ ìˆë‹¤.<br />
(batch_size, input_dimension) ê¸°ì–µí•˜ëŠ”ê°€?<br />
batch_size = 60000<br />
imput_dimension = 784 (28X28)</p>

<p>2Dë¼ê³  ì«„ì§€ë§ì&hellip;<br />
x-y ê·¸ë˜í”„ì—ì„œ ì ì„ ì°ëŠ”ë° ì  ìƒ‰ê¹”ì´ íšŒìƒ‰ì¡°ë¡œ 256ê°œê°€ ìˆë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤.<br />
0ì€ ê²€ì •ìƒ‰, 255ëŠ” í°ìƒ‰ì´ë‹¤.<br />
ê·¸ë¦¬ê³  ì ì„ <strong>í”½ì…€(pixel)</strong> ì´ë¼ê³  í•œë‹¤.</p>

<p>ì•„ë˜ ê·¸ë¦¼ì„ ë³´ì</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pick_image <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> <span style="color:#75715e"># 0 ~ 59999</span>

plt<span style="color:#f92672">.</span>figure(figsize<span style="color:#f92672">=</span>(<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">3</span>))
plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">1</span>)
<span style="color:#75715e"># ì´ë¯¸ì§€(image) í™•ì¸</span>
plt<span style="color:#f92672">.</span>imshow(train_images[pick_image], cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)
plt<span style="color:#f92672">.</span>colorbar()
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;image of {}&#39;</span><span style="color:#f92672">.</span>format(train_labels[pick_image]))
plt<span style="color:#f92672">.</span>subplot(<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">2</span>)
<span style="color:#75715e"># í”½ì…€(pixel)ê°’ ë¶„í¬</span>
plt<span style="color:#f92672">.</span>plot(train_images[<span style="color:#ae81ff">0</span>]<span style="color:#f92672">.</span>flatten())
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;x&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_9_0.png" alt="png" /></p>

<p>ê°™ì€ ìˆ«ìëŠ” í”½ì…€ê°’ì˜ ë¶„í¬ê°€ ë¹„ìŠ·í•  ê²ƒì´ë¼ê³  ê°€ì •ì„ í•˜ê³  ì…ë ¥ xë¥¼ 784ê°œì˜ í”½ì…€ê°’ìœ¼ë¡œ í•œë‹¤.<br />
ì´ë ‡ê²Œ ë‚¨ë“¤ê³¼ëŠ” ë‹¤ë¥´ê³  ë‚˜ì™€ ë‚˜ì˜ ë¶€ë¥˜ì™€ëŠ” ë¹„ìŠ·í•œ íŠ¹ì§•ì„ <strong>í”¼ì²˜(feature)</strong> ë¼ê³  í•˜ê³  íŠ¹ì§•ë“¤ì˜ ë°°ì—´ì„ <strong>í”¼ì²˜ ë²¡í„°(feature vector)</strong> ë¼ê³  í•œë‹¤.</p>

<p>ì—¬ê¸°ì„œ í”¼ì²˜(feature)ëŠ” &ldquo;0~255ì‚¬ì´ì˜ í”½ì…€ê°’&rdquo;ì´ê³  í”¼í„° ë²¡í„°(feature vector)ëŠ” &ldquo;784ê°œì˜ í”½ì…€ê°’ì˜ ë°°ì—´&rdquo;ì´ë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë‚˜ì¤‘ì— ì´ì•¼ê¸° í•˜ê² ì§€ë§Œ<br />
í”¼ì²˜(feature)ë¥¼ ì°¾ëŠ” ê²ƒì´<br />
í”¼ë¥¼ ë§ë¦¬ëŠ”<br />
ì–´ë ¤ìš´ ì¼ì´ë‹¤&hellip;</p>
</blockquote>

<p><strong>ì¶œë ¥(y) ë°ì´í„° í™•ì¸</strong></p>

<ul>
<li>batch_size = 60000<br /></li>
<li>input_dimension = 1<br /></li>
</ul>

<p>0ì—ì„œ 9ê¹Œì§€ 10ê°œì˜ í´ë˜ìŠ¤(Class)ë¡œ ë¶„ë¥˜í•˜ë©´ ëœë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">train_labels</code></pre></div>
<pre><code>array([5, 0, 4, ..., 5, 6, 8], dtype=uint8)
</code></pre>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ë¯¸ì§€ì˜ í”½ì…€ê°’ 784(28X28)ê°œë¥¼ ì…ë ¥ ë³€ìˆ˜(x)ë¡œ<br />
ìˆ«ìê°’ (0~9) 10ê°œë¥¼ ì¶œë ¥ ë³€ìˆ˜ (y)ë¡œ<br />
 ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(NN)ë¡œ ëª¨ë¸ë§ì„ í•˜ë©´ ë ê²ƒ ê°™ë‹¤.</p>
</blockquote>

<h2 id="ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</h2>

<p>ì…ë ¥ ë°ì´í„°ì˜ shape (28,28)ë¥¼ (784, )ë¡œ ë³€í™˜í•´ ì£¼ì–´ì•¼ í•œë‹¤.<br />
ì´ ì‘ì—…ì€ keras layerì—ì„œ ì²˜ë¦¬í•´ ì£¼ë©´ ëœë‹¤. (ë‚˜ì¤‘ì— í•˜ê² ë‹¤ëŠ” ì–˜ê¸°ë‹¤.)</p>

<p>ì†Œí”„íŠ¸ë§¥ìŠ¤(Softmax)ë¥¼ ì‚¬ìš©í•  ì˜ˆì •ì´ë‹ˆê¹Œ ì¶œë ¥ ë°ì´í„°ë¥¼ ì›-í•« ì¸ì½”ë”©ìœ¼ë¡œ ë³€í™˜í•´ ì£¼ì</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras.utils <span style="color:#f92672">import</span> to_categorical

Y_train <span style="color:#f92672">=</span> to_categorical(train_labels) <span style="color:#75715e"># one-hot encoding</span>
Y_test <span style="color:#f92672">=</span> to_categorical(test_labels)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;Y_train.shape is &#39;</span>, Y_train<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;one-hot encoded first Y_train is &#39;</span>, Y_train[<span style="color:#ae81ff">0</span>])</code></pre></div>
<pre><code>Y_train.shape is  (60000, 10)
one-hot encoded first Y_train is  [0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
</code></pre>

<h2 id="ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</h2>

<p>ì¼ë‹¨, 3-layer NN ëª¨ë¸ë¡œ ì§„í–‰í•´ ë³´ì<br />
ì¼ë‹¨ì´ë¼ê³  ë§í•œ ì´ìœ ëŠ” ì •ë‹µì´ ì—†ê¸° ë•Œë¬¸ì´ë‹¤.</p>

<ul>
<li>input layerëŠ” 2D(28X28)ë¥¼ 1Dë¡œ ë³€í™˜í•´ì„œ 784ê°œì˜ xë¡œ ë§Œë“ ë‹¤.<br /></li>
<li>hidden layer 1ì€ 128-unitìœ¼ë¡œ êµ¬ì„±í•˜ì<br /></li>
<li>hiddem layer 2ëŠ” 32-unitìœ¼ë¡œ êµ¬ì„±í•˜ì<br /></li>
<li>output layerëŠ” ë‹¹ì—°íˆ 10-unitìœ¼ë¡œ êµ¬ì„±, softmaxë¥¼ activation functionìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.<br /></li>
<li>lossëŠ” cross-entropy lossë¥¼ ì‚¬ìš©<br /></li>
</ul>

<p>ë‚¨ì€ê²ƒì€<br />
hidden layerì˜ activation functionê³¼ optimizerë¥¼ ì„ íƒí•˜ëŠ” ê²ƒì´ë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì˜¤ëŠ˜,<br />
ìƒˆë¡œìš´ ê²ƒë“¤ì„ ì†Œê°œ í•˜ê² ë‹¤.<br />
hidden layerì˜ activation functionì˜ ì •ì„ <strong>ReLU</strong>,<br />
optimizerì˜ ëíŒì™•ì¸ <strong>Adam</strong></p>
</blockquote>

<h3 id="relu-rectified-linear-unit">ReLU (Rectified Linear Unit)</h3>

<p>\(a=max(0,z)\)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">relu</span>(x):
    <span style="color:#66d9ef">return</span> max(<span style="color:#ae81ff">0</span>, x)

x_list <span style="color:#f92672">=</span> [x <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> range(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>, <span style="color:#ae81ff">11</span>)]
y_list <span style="color:#f92672">=</span> [relu(x) <span style="color:#66d9ef">for</span> x <span style="color:#f92672">in</span> x_list]

plt<span style="color:#f92672">.</span>plot(x_list, y_list)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_17_0.png" alt="png" /></p>

<p>ì‹œê·¸ëª¨ì´ë“œì˜ ë‹¨ì ì€  hidden layerê°€ ë§ì•„ ì§ˆ ìˆ˜ë¡ í•™ìŠµì´ ì•ˆë˜ëŠ” ë¬¸ì œê°€ ìˆë‹¤. ë¯¸ë¶„ì˜ ë¯¸ë¶„ì˜ ë¯¸ë¶„ì˜ &hellip; ë¯¸ë¶„ì„ í•˜ë‹¤ ë³´ë©´ ë¯¸ë¶„ê°’ì´ 0ì— ê°€ê¹ê²Œ ëœë‹¤. ê·¸ë¦¬ê³  \(z\)ê°’ì´ ì—„ì²­ í¬ê±°ë‚˜ ì‘ì€ ê°’ì´ ë˜ì–´ë„ ë¯¸ë¶„ê°’ì´ 0ì— ê°€ê¹ê²Œ ëœë‹¤. ì´ëŸ¬ë©´ ì†ì‹¤ í•¨ìˆ˜ì˜ ìµœì†Œê°’ì„ ì°¾ê¸° ìœ„í•´ \(w\)ì™€ \(b\)ë¥¼ ì›€ì§ì´ì§€ ëª»í•œë‹¤.  ì´ëŸ¬í•œ ë‹¨ì ì„ ë³´ì™„í•˜ê¸° ìœ„í•´ì„œ íƒ„ìƒí•œ ê²ƒì´ ë ë£¨(ReLU) í•¨ìˆ˜ì´ë‹¤. ë¬¼ë¡  ì—”ì§€ë‹ˆì–´ë¥¼ ê°ˆì•„ì„œ ë§Œë“¤ì—ˆë‹¤&hellip;</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ìˆ˜í•™ì— ì •ì„ì´ ìˆë“¯ì´ hidden layerì—ëŠ” ReLUê°€ ìˆë‹¤.<br />
ê¸°ëƒ¥ ì“°ì</p>
</blockquote>

<h3 id="adam-adaptive-moment-estimation">Adam (Adaptive moment estimation)</h3>

<p><strong>ëª¨ë©˜í…€(Momentum)</strong></p>

<p>ì£¼ì‹ ì¢€ í•œë‹¤ëŠ” ì‚¬ëŒë“¤ì€ &lsquo;ì§€ìˆ˜ì´ë™í‰ê· &rsquo;ì— ëŒ€í•´ì„œ ì˜ ì•Œê³  ìˆì„ ê²ƒì´ë‹¤.<br />
ìƒí•˜ë¡œ ì§„ë™í•˜ëŠ” ì£¼ì‹ ê·¸ë˜í”„ë¥¼ ì§€ìˆ˜ ì´ë™ í‰ê· ì„ ê³„ì‚°í•˜ë©´ ë¶€ë“œëŸ¬ìš´ ê³¡ì„ ìœ¼ë¡œ í‘œì‹œë˜ê³  ìƒìŠ¹ í˜¹ì€ í•˜ê°• ì¶”ì„¸ë¥¼ ì‰½ê²Œ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.<br />
ì§€ìˆ˜ì´ë™í‰ê· ì€ í˜„ì¬ì˜ ê°’ì´ ìˆìœ¼ë©´ ì—¬ê¸°ë‹¤ê°€ ê³¼ê±°ì— ì´ë™í•œ ë°©í–¥ì— ëŒ€í•œ ì¶”ì§„ë ¥(momentum)ì„ ì§€ìˆ˜ì ìœ¼ë¡œ ë°˜ì˜í•œ ê²ƒì´ë‹¤.</p>

<p>ê²½ì‚¬í•˜ê°•ë²•(Gradient Descent)ì˜ ë‹¨ì ì€ ì†ì‹¤ í•¨ìˆ˜ì˜ ìµœì†Œê°’ì„ ì°¾ì•„ê°€ëŠ” ê³¼ì •ì´ ì£¼ì‹ ê·¸ë˜í”„ ì²˜ëŸ¼ ì§„ë™ì´ ì‹¬í•˜ë‹¤ëŠ” ê²ƒì´ë‹¤. ë”°ë¼ì„œ ê²½ì‚¬í•˜ê°•ë²•ì— &lsquo;ì§€ìˆ˜ì´ë™í‰ê· &rsquo;ì„ ì ìš©í•´ì„œ <strong>ë¶€ë“œëŸ½ê²Œ</strong> ì†ì‹¤ í•¨ìˆ˜ì˜ ìµœì†Œê°’ì„ ì°¾ì•„ê°€ëŠ” ë°©ë²•ì„ ëª¨ë©˜í…€(Gradient Descent with momentum) ì´ë¼ê³  í•œë‹¤.</p>

<p>\(dw = {\partial {J(w,b)}\over \partial w}\),<br />
\(db = {\partial{J(w,b)}\over \partial b}\)</p>

<p>REPEAT(epoch) {<br />
\(w:=w-\alpha {V_{dw}}\)</p>

<p>\(b:=b-\alpha {V_{db}}\)<br />
}</p>

<p>\(V_{dw} = \beta_1 V_{dw} + (1-\beta_1 )dw\),<br />
\(V_{db} = \beta_1 V_{db} + (1-\beta_1 )db\)</p>

<p>\(\alpha =0.001\) : learining rate,<br />
\(\beta_1 = 0.9\) : exponential decay rate</p>

<p><strong>RMSProp</strong></p>

<p>ê¸‰ê²½ì‚¬ì¸ ê²½ìš°ì—ëŠ” ë³´í­ì„ ë‚®ì¶”ì–´ì„œ ê°€ì¥ ì•„ë˜ì¸ì§€ë¥¼ ì„¸ë°€íˆ ì‚´í”¼ê³ , ì™„ë§Œí•œ ê²½ì‚¬ì¸ ê²½ìš°ì—ëŠ” ë³´í­ì„ ë„“í˜€ì„œ ë¹¨ë¦¬ ì§€ë‚˜ê°€ëŠ” ë°©ì‹ì´ë‹¤.<br />
ì´ ë°©ì‹ì€ <strong>ë¹ ë¥´ê²Œ</strong> ì†ì‹¤ í•¨ìˆ˜ì˜ ìµœì†Œê°’ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤.</p>

<p>REPEAT(epoch) {<br />
\(w:=w-\alpha {dw \over {\sqrt {S_{dw}} + \epsilon}}\)</p>

<p>\(b:=b-\alpha {db \over {\sqrt {S_{db}} + \epsilon}}\)<br />
}</p>

<p>\(S_{dw} = \beta_2 S_{dw} + (1-\beta_2)dw^2\),<br />
\(S_{db} = \beta_2 S_{db} + (1-\beta_2)db^2\)</p>

<p>\(\beta_2 = 0.999\) : discounting factor,<br />
\(\epsilon = 1e-07\) : small value to avoid zero denominator</p>

<p><strong>Adam</strong></p>

<p>ì•ì˜ Momentumê³¼ RMSPropì„ í•©ì¹œê²ƒì´ Adamì´ë‹¤.<br />
<strong>ë¹ ë¥´ê³  ë¶€ë“œëŸ½ê²Œ</strong> ìµœì†Œê°’ì„ ì°¾ì•„ ê°„ë‹¤.</p>

<p>REPEAT(epoch) {<br />
\(w:=w-\alpha {V_{dw} \over {\sqrt {S_{dw}} + \epsilon}}\)</p>

<p>\(b:=b-\alpha {V_{db} \over {\sqrt {S_{db}} + \epsilon}}\)<br />
}</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì¢‹ì€ ê²ƒì„ ëª¨ë‘ í•©ì³ ë†“ì•˜ìœ¼ë‹ˆ ì„±ëŠ¥ì´ ì¢‹ì„ ìˆ˜ ë°–ì—<br />
ë‹¥ì¹˜ê³  Adam ì“°ì</p>
</blockquote>

<h3 id="ì •ë¦¬">ì •ë¦¬</h3>

<p>NNì„ ì´ìš©í•œ MNIST ì¸ì‹ ëª¨ë¸ì„ ë§Œë“œëŠ” ë°©ë²•ì„ ì •ë¦¬í•´ ë³´ì.<br />
1. ë°ì´í„°ë¥¼ ë³€í™˜í•œë‹¤.<br />
    1. ì…ë ¥ ë°ì´í„°ì˜ í˜•ì‹ê³¼ ëª¨ì–‘ì„ ë³€í™˜í•œë‹¤. 2Dë¥¼ 1Dë¡œ ë³€í™˜í•œë‹¤.<br />
    2. ì¶œë ¥ ë°ì´í„°ì˜ í˜•ì‹ê³¼ ëª¨ì–‘ì„ ë³€í™˜í•œë‹¤. <strong>ì›-í•« ì¸ì½”ë”©(one-hot encoding)</strong> ì„ ì‚¬ìš©í•œë‹¤.<br />
2. <strong>íˆë“  ë ˆì´ì–´(hidden layer)</strong>  ì •ì˜<br />
    1. íˆë“  ë ˆì´ì–´ ê°œìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” 2-hidden layerë¥¼ ì‚¬ìš©í•œë‹¤.<br />
    2. íˆë“  ë ˆì´ì–´ ìœ ë‹› ê°œìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” 128ê°œ, 32ê°œ ìœ ë‹›ì„ ì‚¬ìš©í•œë‹¤.<br />
    3. í™œì„± í•¨ìˆ˜(activation function)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>ReLU</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.<br />
3. <strong>ì¶œë ¥ ë ˆì´ì–´(output layer)</strong>  ì •ì˜<br />
    1. ì¶œë ¥ ë ˆì´ì–´ ìœ ë‹› ê°œìˆ˜ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” 10ê°œì˜ í´ë˜ìŠ¤ë¡œ ë¶„ë¥˜í•´ì•¼ ë˜ë‹ˆê¹Œ 10ê°œì˜ ìœ ë‹›ì„ ì‚¬ìš©í•œë‹¤.<br />
    2. í™œì„± í•¨ìˆ˜(activation function)ë¥¼ ì •ì˜í•œë‹¤. <strong>ì†Œí”„íŠ¸ë§¥ìŠ¤(softmax)</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.<br />
4. ì†ì‹¤ í•¨ìˆ˜ (Loss function)ë¥¼ ì •ì˜í•œë‹¤. <strong>í¬ë¡œìŠ¤-ì—”íŠ¸ë¡œí”¼ ì†ì‹¤(cross-entropy loss)</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.<br />
5. ì˜µí‹°ë§ˆì´ì €(Optimizer)ë¥¼ ì •ì˜í•œë‹¤. ì—¬ê¸°ì„œëŠ” <strong>Adam</strong> ì„ ì‚¬ìš©í•œë‹¤.<br />
6. ë°˜ë³µí•  íšŒìˆ˜(epoch)ë¥¼ ê²°ì •í•œë‹¤.<br />
7. ì£¼ì–´ì§„ ì¡°ê±´ìœ¼ë¡œ ëª¨ë¸ì„ ìµœì í™”(fit) ì‹œí‚¨ë‹¤.</p>

<h2 id="í…ì„œí”Œë¡œìš°-tensorflow-ë¡œ-ëª¨ë¸ë§-modeling">í…ì„œí”Œë¡œìš°(Tensorflow)ë¡œ ëª¨ë¸ë§(Modeling)</h2>

<p><strong>ì¼€ë¼ìŠ¤(Keras)</strong> ë¥¼ ì´ìš©í•´ì„œ êµ¬í˜„ì„ í•´ë³´ì!</p>

<h3 id="ì •ê·œí™”-normalization">ì •ê·œí™” (Normalization)</h3>

<p><strong>ì •ê·œê°’ = (í˜„ì¬ê°’ - ìµœì†Œê°’) / (ìµœëŒ€ê°’-ìµœì†Œê°’)</strong> ìœ¼ë¡œ ì •ê·œí™” í•œë‹¤!<br />
ìµœì†Œê°’ì´ 0ì´ê³ , ìµœëŒ€ê°’ì´ 255ì´ë‹ˆê¹Œ í˜„ì¬ê°’ì—ì„œ /255 ë¥¼ í•´ ì£¼ë©´ ëœë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">X_train <span style="color:#f92672">=</span> train_images <span style="color:#f92672">/</span> <span style="color:#ae81ff">255.0</span>
X_test <span style="color:#f92672">=</span> test_images <span style="color:#f92672">/</span> <span style="color:#ae81ff">255.0</span>

plt<span style="color:#f92672">.</span>imshow(X_train[pick_image], cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)
plt<span style="color:#f92672">.</span>colorbar()
plt<span style="color:#f92672">.</span>xlabel(np<span style="color:#f92672">.</span>argmax(Y_train[pick_image]))
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_20_0.png" alt="png" /></p>

<h3 id="kerasë¥¼-ê°€ì§€ê³ -ëª¨ë¸ë§-modeling-í•˜ê¸°">Kerasë¥¼ ê°€ì§€ê³  ëª¨ë¸ë§(Modeling)í•˜ê¸°</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> Flatten, Dense

model <span style="color:#f92672">=</span> Sequential()
model<span style="color:#f92672">.</span>add(Flatten(input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">28</span>)))
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">128</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">32</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">10</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;softmax&#39;</span>))
model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;categorical_crossentropy&#39;</span>, optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>, metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>])</code></pre></div>
<pre><code>WARNING: Logging before flag parsing goes to stderr.
W0906 19:08:54.737059 139909354948416 deprecation.py:506] From /home/dataman/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/init_ops.py:1251: calling VarianceScaling.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor
</code></pre>

<h3 id="ëª¨ë¸-í›ˆë ¨">ëª¨ë¸ í›ˆë ¨</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">hist <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(X_train, Y_train, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
train_acc <span style="color:#f92672">=</span> hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;acc&#39;</span>][<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
train_loss <span style="color:#f92672">=</span>  hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>][<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;train accuracy: &#39;</span>, train_acc)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;train loss: &#39;</span>, train_loss)</code></pre></div>
<pre><code>train accuracy:  0.9932
train loss:  0.019363174817231873
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>plot(hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;epoch&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;loss&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_25_0.png" alt="png" /></p>

<h3 id="ì •í™•ë„-í‰ê°€">ì •í™•ë„ í‰ê°€</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">test_loss, test_acc <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>evaluate(X_test, Y_test)

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;test accuracy: &#39;</span>, test_acc)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;test loss: &#39;</span>, test_loss)</code></pre></div>
<pre><code>10000/10000 [==============================] - 0s 31us/sample - loss: 0.1025 - acc: 0.9768
test accuracy:  0.9768
test loss:  0.1024522928831917
</code></pre>

<p>ëŒ€ì¶© ë§Œë“¤ì—ˆëŠ”ë°ë„ ì •í™•ë„ê°€ ìƒë‹¹íˆ ë†’ë‹¤.<br />
ê·¸ëŸ°ë°&hellip;<br />
í›ˆë ¨ ì •í™•ë„ì™€ í…ŒìŠ¤íŠ¸ ì •í™•ë„ê°€ ì°¨ì´ê°€ ë‚œë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ê²ƒì€<br />
ë””ìì´ë„ˆê°€<br />
í”¼íŒ…ëª¨ë¸ì— ë„ˆë¬´ ë”± ë§ê²Œ<br />
ì˜·ì„ ë§Œë“¤ì–´ì„œ (over fitting)<br />
ì‹¤ì œë¡œ ì œí’ˆì´ ë‚˜ì™”ì„ë•Œ<br />
ë‹¤ë¥¸ ì‚¬ëŒì€ ì…ì§€ë„ ëª»í•˜ëŠ”<br />
ì‚¬íƒœì™€ ë¹„ìŠ·í•˜ë‹¤.</p>
</blockquote>

<p>ì´ê²ƒì„ í›ˆë ¨ ì„¸íŠ¸ì— <strong>ê³¼ëŒ€ì í•©(Overfitting)</strong> ë˜ì—ˆë‹¤ê³  í•œë‹¤.<br />
ê³¼ëŒ€ì í•©(Overfitting)ì„ ì¤„ì´ëŠ” ë°©ë²•ìœ¼ë¡œëŠ” <strong>ê·œì œ(Regularization)</strong> ê³¼ <strong>ë“œëì•„ì›ƒ(Dropout)</strong> ì´ ìˆë‹¤.<br />
ê·œì œ(Regularization)ì— ëŒ€í•´ì„œ ì•Œì•„ ë³´ì</p>

<h3 id="ê·œì œ-regularization">ê·œì œ (Regularization)</h3>

<p>ê³¼ëŒ€ì í•©(Overfitting)ì„ ì¤„ì´ëŠ” ë°©ë²• ì¤‘ì— í•˜ë‚˜ë¡œì„œ<br />
ê¸°ì¡´ì˜ ì†ì‹¤í•¨ìˆ˜ \(J(w,b)\)ì— \( {\lambda \over {2m}} \sum_{l=1}^L ||w||^2\)ë¥¼ ì¶”ê°€í•œ ê²ƒì´ë‹¤.</p>

<p>\({\large J}(w, b) = -{1\over {m}}\sum_{i=1}^m [(y^{(i)}log({\hat y}^{(i)})) + (1-y^{(i)})log(1-{\hat y}^{(i)})]<br />
\\
\hspace{3.9em} + {\lambda \over {2m}} \sum_{l=1}^L ||w||^2\)</p>

<p>ìš°ë¦¬ëŠ” ì´ê²ƒì„ <strong>L2 Regularization</strong> ì´ë¼ê³  í•œë‹¤.<br />
\(\lambda\) ê°’ì€ ëª¨ë¸ì— ë”°ë¼ì„œ ì ì ˆí•˜ê²Œ ì„ íƒí•´ì•¼ í•œë‹¤.</p>

<p>ì•„ë˜ëŠ” ê¸°ì¡´ ëª¨ë¸ì— \(\lambda = 0.0001\)ì¸ L2 Regularizationì„ ì ìš©í•œ ê²°ê³¼ì´ë‹¤.<br />
í›ˆë ¨ ì •í™•ë„ëŠ” ë–¨ì–´ì§€ê³  í…ŒìŠ¤íŠ¸ ì •í™•ë„ëŠ” ì˜¬ë¼ê°€ì„œ ë‘˜ ì‚¬ì´ì˜ ì •í™•ë„ê°€ ë¹„ìŠ·í•´ ì§„ë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>Regularizationì€ \(w\)ì˜ ì—­í™œì„ ì¤„ì—¬ ì¤Œìœ¼ë¡œì¨,<br />
ëª¨ë¸ì„ ì•½ê°„ <strong>ë°”ë³´</strong>ë¡œ ë§Œë“¤ì–´ ì¤€ë‹¤.<br />
ì–´ëŠ ì •ë„ ë°”ë³´ë¡œ ë§Œë“¤ì–´ ì§ˆ ê²ƒì¸ì§€ëŠ”<br />
\(\lambda\)ë¡œ ì •í•´ì§„ë‹¤.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras <span style="color:#f92672">import</span> regularizers

model_l2 <span style="color:#f92672">=</span> Sequential()
model_l2<span style="color:#f92672">.</span>add(Flatten(input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">28</span>,<span style="color:#ae81ff">28</span>)))
model_l2<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">128</span>, kernel_regularizer<span style="color:#f92672">=</span>regularizers<span style="color:#f92672">.</span>l2(<span style="color:#ae81ff">0.0001</span>), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
model_l2<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">32</span>, kernel_regularizer<span style="color:#f92672">=</span>regularizers<span style="color:#f92672">.</span>l2(<span style="color:#ae81ff">0.0001</span>), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;relu&#39;</span>))
model_l2<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">10</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;softmax&#39;</span>))
model_l2<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;categorical_crossentropy&#39;</span>, optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;adam&#39;</span>, metrics<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;accuracy&#39;</span>])

hist <span style="color:#f92672">=</span> model_l2<span style="color:#f92672">.</span>fit(X_train, Y_train, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
train_acc_l2 <span style="color:#f92672">=</span> hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;acc&#39;</span>][<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]
train_loss_l2 <span style="color:#f92672">=</span>  hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>][<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>]

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;train accuracy: &#39;</span>, train_acc_l2)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;train loss: &#39;</span>, train_loss_l2)</code></pre></div>
<pre><code>train accuracy:  0.9884667
train loss:  0.07978579129775365
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">plt<span style="color:#f92672">.</span>plot(hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;epoch&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;loss&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_31_0.png" alt="png" /></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">test_loss_l2, test_acc_l2 <span style="color:#f92672">=</span> model_l2<span style="color:#f92672">.</span>evaluate(X_test, Y_test)

<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;test accuracy: &#39;</span>, test_acc_l2)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;test loss: &#39;</span>, test_loss_l2)</code></pre></div>
<pre><code>10000/10000 [==============================] - 0s 38us/sample - loss: 0.1201 - acc: 0.9777
test accuracy:  0.9777
test loss:  0.12008701454401016
</code></pre>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> pandas <span style="color:#f92672">as</span> pd

df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(data<span style="color:#f92672">=</span>[[train_acc, test_acc], [train_acc_l2, test_acc_l2]], 
                  index <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;model&#39;</span>, <span style="color:#e6db74">&#39;model_with_l2&#39;</span>], 
                  columns<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#39;train accuracy&#39;</span>, <span style="color:#e6db74">&#39;test accuracy&#39;</span>])
df</code></pre></div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>train accuracy</th>
      <th>test accuracy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>model</td>
      <td>0.993200</td>
      <td>0.9768</td>
    </tr>
    <tr>
      <td>model_with_l2</td>
      <td>0.988467</td>
      <td>0.9777</td>
    </tr>
  </tbody>
</table>
</div>

<h2 id="í•´ê²°-solution">í•´ê²° (Solution)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë³´ìŠ¤~ ì›í•˜ì‹œëŠ” ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.<br />
ì •í™•ë„ëŠ” 97% ì´ìƒì…ë‹ˆë‹¤.</p>

<p>test_dataì— ì›í•˜ì‹œëŠ” ì´ë¯¸ì§€ë¥¼ ì…ë ¥í•˜ì‹œë©´<br />
ì›í•˜ì‹œëŠ” ê²°ê³¼ê°’ì´ ì¶œë ¥ ë©ë‹ˆë‹¤.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pick_image <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span> <span style="color:#75715e"># 0 ~ 9999</span>

<span style="color:#66d9ef">def</span> <span style="color:#a6e22e">predict_handwrittendigits</span>(x):
    x_data <span style="color:#f92672">=</span>(np<span style="color:#f92672">.</span>expand_dims(x, <span style="color:#ae81ff">0</span>))
    predict <span style="color:#f92672">=</span> model_l2<span style="color:#f92672">.</span>predict(x_data)
    <span style="color:#66d9ef">return</span> np<span style="color:#f92672">.</span>argmax(predict)

test_data <span style="color:#f92672">=</span> test_images[pick_image]
result <span style="color:#f92672">=</span> predict_handwrittendigits(test_data)

plt<span style="color:#f92672">.</span>imshow(test_data, cmap<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;gray&#39;</span>)
plt<span style="color:#f92672">.</span>xticks([])
plt<span style="color:#f92672">.</span>yticks([])
plt<span style="color:#f92672">.</span>show()
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;predicted digit is &#39;</span>, result)</code></pre></div>
<p><img src="output_35_0.png" alt="png" /></p>

<pre><code>predicted digit is  0
</code></pre>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/mnist/" rel="tag">MNIST</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/relu/" rel="tag">ReLU</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/adam/" rel="tag">Adam</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/train-test/" rel="tag">Train &amp; Test</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/feature/" rel="tag">Feature</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/neural_network/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ (Neural Network)</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next">
		<a class="post-nav__link" href="/post/latent_factor_model/" rel="next"><span class="post-nav__caption">Next&thinsp;Â»</span><p class="post-nav__post-title">ì ì¬ ì¸ìˆ˜ ëª¨ë¸ (Latent Factor Model)</p></a>
	</div>
</nav>
<script src="https://utteranc.es/client.js"
        repo="skettee/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 skettee.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>