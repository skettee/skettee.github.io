<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Recurrent Neural Network - ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<meta property="og:title" content="Recurrent Neural Network" />
<meta property="og:description" content="ì‹œí€€ìŠ¤ ëª¨ë¸ë§(Sequence Modeling)ì„ ìœ„í•œ  ë¦¬ì»¤ëŸ°íŠ¸ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Recurrent Neural Network) ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/post/recurrent_neural_network/" />
<meta property="article:published_time" content="2019-09-11T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-09-11T00:00:00+00:00" />

	
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">
	<link rel="stylesheet" href="/css/style.css">
	
	<link rel="shortcut icon" href="/favicon.ico">
		
</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container">
		<div class="logo">
			<a class="logo__link" href="/" title="ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ" rel="home">
				<div class="logo__title">ë§‰ë¼ë¨¹ì€ ì—”ì§€ë‹ˆì–´ì˜ ë¨¸ì‹ ëŸ°ë‹ ê°œë°œ</div>
				<div class="logo__tagline">ë”¥ëŸ¬ë‹ ëª¨ë¸ë§</div>
			</a>
		</div>
		<div class="divider"></div>
	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Recurrent Neural Network</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg>
	<time class="meta__text" datetime="2019-09-11T00:00:00">2019-09-11</time>
</div>

<div class="meta__item-categories meta__item">
	<svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
	<span class="meta__text"><a class="meta__link" href="/categories/deep-learning" rel="category">Deep Learning</a>, <a class="meta__link" href="/categories/recurrent-neural-network" rel="category">Recurrent Neural Network</a></span>
</div>
</div>
		</header>
<div class="post__toc toc">
	<div class="toc__title">Page content</div>
	<div class="toc__menu">
		<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</a></li>
<li><a href="#ë°ì´í„°-ìˆ˜ì§‘-data-collection">ë°ì´í„° ìˆ˜ì§‘ (Data Collection)</a></li>
<li><a href="#ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</a></li>
<li><a href="#ë¦¬ì»¤ëŸ°íŠ¸-ë‰´ëŸ´-ë„¤íŠ¸ì›Œí¬-ëª¨ë¸ë§-rnn-modeling">ë¦¬ì»¤ëŸ°íŠ¸ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ ëª¨ë¸ë§ (RNN Modeling)</a>
<ul>
<li><a href="#í•˜ì´í¼ë³¼ë¦­-íƒ„ì  íŠ¸-í•¨ìˆ˜-tanh-function">í•˜ì´í¼ë³¼ë¦­ íƒ„ì  íŠ¸ í•¨ìˆ˜ (tanh function)</a></li>
<li><a href="#many-to-one-model">Many-to-One Model</a></li>
<li><a href="#ì •ë¦¬">ì •ë¦¬</a></li>
</ul></li>
<li><a href="#ì¼€ë¼ìŠ¤-keras-ë¡œ-ëª¨ë¸ë§-modeling">ì¼€ë¼ìŠ¤(Keras)ë¡œ ëª¨ë¸ë§(Modeling)</a>
<ul>
<li><a href="#ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</a></li>
<li><a href="#ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</a></li>
<li><a href="#ëª¨ë¸-í›ˆë ¨-train-model">ëª¨ë¸ í›ˆë ¨ (Train Model)</a></li>
</ul></li>
<li><a href="#í•´ê²°-solution">í•´ê²° (Solution)</a></li>
</ul></li>
</ul>
</nav>
	</div>
</div>
<div class="content post__content clearfix">
			<p>ì‹œí€€ìŠ¤ ëª¨ë¸ë§(Sequence Modeling)ì„ ìœ„í•œ  ë¦¬ì»¤ëŸ°íŠ¸ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(Recurrent Neural Network) ì— ëŒ€í•´ ì•Œì•„ë³´ê³  kerasë¥¼ ì´ìš©í•´ì„œ ëª¨ë¸ë§ì„ í•´ë³´ì!</p>

<p>ì‹¤ì œë¡œ ëŒë ¤ ë³´ê³  ì‹¶ìœ¼ë©´ êµ¬ê¸€ ì½”ë©ìœ¼ë¡œ ~</p>

<p><a href="https://colab.research.google.com/github/skettee/notebooks/blob/master/recurrent_neural_network.ipynb"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab" /></a></p>

<h2 id="ë¬¸ì œ-problem">ë¬¸ì œ (Problem)</h2>

<p>ğŸ’° ê³ ê°</p>

<blockquote>
<p>ì¹œì¶”í•œ ì—¬ì¹œì´ ì´ëª¨í‹°ì½˜ ë¬¸ìë¥¼ ë³´ë‚´ë©´ì„œ ì¢‹ì€ ë§ì¸ì§€ ë‚˜ìœë§ì¸ì§€ ë§ì¶”ì–´ ë³´ë¼ê³  í•˜ë„¤ìš”.<br />
ì§€ê¸ˆê¹Œì§€ ì˜¨ ë¬¸ìì™€ ë‹µì€ ì•„ë˜ì™€ ê°™ì•„ìš”.</p>

<p>ğŸ± ğŸ¤– â¤ï¸ â—ï¸ : GOOD<br />
ğŸ± â—ï¸ ğŸ· ğŸ¶ : BAD<br />
ğŸ· ğŸ± ğŸ¤– â¤ï¸ : GOOD<br />
â¤ï¸ ğŸ¤– â—ï¸ ğŸ· : BAD<br />
ğŸ¶ ğŸ± â¤ï¸ ğŸ¤– : GOOD<br />
ğŸ· â¤ï¸ â—ï¸ ğŸ¶ : BAD<br />
ğŸ± ğŸ¤– ğŸ· â¤ï¸ : GOOD<br />
â—ï¸ â¤ï¸ ğŸ± ğŸ¤– : GOOD<br />
ğŸ¤– ğŸ± â¤ï¸ ğŸ· : BAD<br />
ğŸ· ğŸ¶ â—ï¸ â¤ï¸ : BAD</p>

<p>ì•„ë˜ ì´ëª¨í‹°ì½˜ ë¬¸ìê°€ ì¢‹ì€ ë§ì¸ì§€ ë‚˜ìœë§ì¸ì§€ ì•Œë ¤ì£¼ëŠ” ì¸ê³µì§€ëŠ¥ì„ ë§Œë“¤ì–´ ì£¼ì„¸ìš”~</p>

<p>ë¬¸ì 1: ğŸ¶ ğŸ± ğŸ¤– â¤ï¸<br />
ë¬¸ì 2: ğŸ¤– â—ï¸ ğŸ· ğŸ¶</p>
</blockquote>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>í˜¹ì‹œ~ ì—¬ì¹œë‹˜ì´ ì•”í˜¸ ì „ë¬¸ê°€?</p>
</blockquote>

<h2 id="ë°ì´í„°-ìˆ˜ì§‘-data-collection">ë°ì´í„° ìˆ˜ì§‘ (Data Collection)</h2>

<p>ë„˜íŒŒì´(Numpy) ë°°ì—´(array)ë¡œ ë°ì´í„°ë¥¼ ë§Œë“¤ì</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> numpy <span style="color:#f92672">as</span> np

x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#e6db74">&#39;ğŸ±&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¤–&#39;</span>, <span style="color:#e6db74">&#39;â¤ï¸&#39;</span>, <span style="color:#e6db74">&#39;â—ï¸&#39;</span>], 
              [<span style="color:#e6db74">&#39;ğŸ±&#39;</span>, <span style="color:#e6db74">&#39;â—ï¸&#39;</span>, <span style="color:#e6db74">&#39;ğŸ·&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¶&#39;</span>], 
              [<span style="color:#e6db74">&#39;ğŸ·&#39;</span>, <span style="color:#e6db74">&#39;ğŸ±&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¤–&#39;</span>, <span style="color:#e6db74">&#39;â¤ï¸&#39;</span>], 
              [<span style="color:#e6db74">&#39;â¤ï¸&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¤–&#39;</span>, <span style="color:#e6db74">&#39;â—ï¸&#39;</span>, <span style="color:#e6db74">&#39;ğŸ·&#39;</span>], 
              [<span style="color:#e6db74">&#39;ğŸ¶&#39;</span>, <span style="color:#e6db74">&#39;ğŸ±&#39;</span>, <span style="color:#e6db74">&#39;â¤ï¸&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¤–&#39;</span>], 
              [<span style="color:#e6db74">&#39;ğŸ·&#39;</span>, <span style="color:#e6db74">&#39;â¤ï¸&#39;</span>, <span style="color:#e6db74">&#39;â—ï¸&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¶&#39;</span>], 
              [<span style="color:#e6db74">&#39;ğŸ±&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¤–&#39;</span>, <span style="color:#e6db74">&#39;ğŸ·&#39;</span>, <span style="color:#e6db74">&#39;â¤ï¸&#39;</span>], 
              [<span style="color:#e6db74">&#39;â—ï¸&#39;</span>, <span style="color:#e6db74">&#39;â¤ï¸&#39;</span>, <span style="color:#e6db74">&#39;ğŸ±&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¤–&#39;</span>], 
              [<span style="color:#e6db74">&#39;ğŸ¤–&#39;</span>, <span style="color:#e6db74">&#39;ğŸ±&#39;</span>, <span style="color:#e6db74">&#39;â¤ï¸&#39;</span>, <span style="color:#e6db74">&#39;ğŸ·&#39;</span>], 
              [<span style="color:#e6db74">&#39;ğŸ·&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¶&#39;</span>, <span style="color:#e6db74">&#39;â—ï¸&#39;</span>, <span style="color:#e6db74">&#39;â¤ï¸&#39;</span>]] )

y <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([[<span style="color:#e6db74">&#39;GOOD&#39;</span>], [<span style="color:#e6db74">&#39;BAD&#39;</span>], [<span style="color:#e6db74">&#39;GOOD&#39;</span>], [<span style="color:#e6db74">&#39;BAD&#39;</span>], [<span style="color:#e6db74">&#39;GOOD&#39;</span>], 
              [<span style="color:#e6db74">&#39;BAD&#39;</span>], [<span style="color:#e6db74">&#39;GOOD&#39;</span>],  [<span style="color:#e6db74">&#39;GOOD&#39;</span>], [<span style="color:#e6db74">&#39;BAD&#39;</span>], [<span style="color:#e6db74">&#39;BAD&#39;</span>]])

<span style="color:#66d9ef">print</span>(x<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(y<span style="color:#f92672">.</span>shape)</code></pre></div>
<pre><code>(10, 4)
(10, 1)
</code></pre>

<h2 id="ë°ì´í„°-ë¶„ì„-data-analysis">ë°ì´í„° ë¶„ì„ (Data Analysis)</h2>

<p>ë°ì´í„° ë¶„ì„ì˜ ê²½í—˜ê³¼ ë‚˜ì—ê²Œ ì¡´ì¬í•˜ëŠ” í’ë¶€í•œ <del>ê°¬ì„±</del> ê°ì„±ì„ ë°”íƒ•ìœ¼ë¡œ ì´ëª¨í‹°ì½˜ì˜ ì˜ë¯¸ë¥¼ ë‹¨ë²ˆì— ê°„íŒŒí•˜ê³  í…Œì´ë¸”ë¡œ ë§Œë“¤ì—ˆë‹¤.</p>

<table>
<thead>
<tr>
<th>ì´ëª¨í‹°ì½˜</th>
<th>ì˜ë¯¸</th>
</tr>
</thead>

<tbody>
<tr>
<td>ğŸ±</td>
<td>ë‚˜</td>
</tr>

<tr>
<td>ğŸ¤–</td>
<td>ë„ˆ</td>
</tr>

<tr>
<td>â—ï¸</td>
<td>ì¡¸ë¼</td>
</tr>

<tr>
<td>â¤ï¸</td>
<td>ì¢‹ë‹¤</td>
</tr>

<tr>
<td>ğŸ·</td>
<td>ë°”ë³´</td>
</tr>

<tr>
<td>ğŸ¶</td>
<td>ë©ì²­ì´</td>
</tr>
</tbody>
</table>

<p>ìœ„ì˜ ë³€í™˜ í…Œì´ë¸”ì„ ë°”íƒ•ìœ¼ë¡œ ë¬¸ì ì´ëª¨í‹°ì½˜ì„ í•´ì„í•œ í…Œì´ë¸”ì„ ë§Œë“¤ì—ˆë‹¤.</p>

<table>
<thead>
<tr>
<th>ë¬¸ì ì´ëª¨í‹°ì½˜</th>
<th>ì˜ë¯¸</th>
<th>ê°ì„± ë¶„ì„</th>
</tr>
</thead>

<tbody>
<tr>
<td>ğŸ± ğŸ¤– â¤ï¸ â—ï¸</td>
<td>ë‚˜ ë„ˆ ì¢‹ì•„í•´ ì¡¸ë¼</td>
<td>GOOD</td>
</tr>

<tr>
<td>ğŸ± â—ï¸ ğŸ· ğŸ¶</td>
<td>ë‚œ ì¡¸ë¼ ë°”ë³´ ë©ì²­ì´ì•¼</td>
<td>BAD</td>
</tr>

<tr>
<td>ğŸ· ğŸ± ğŸ¤– â¤ï¸</td>
<td>ë°”ë³´ì•¼ ë‚œ ë„ˆ ì¢‹ì•„í•´</td>
<td>GOOD</td>
</tr>

<tr>
<td>â¤ï¸ ğŸ¤– â—ï¸ ğŸ·</td>
<td>ì¢‹ëƒ ë„Œ ì¡¸ë¼ ë°”ë³´ì•¼</td>
<td>BAD</td>
</tr>

<tr>
<td>ğŸ¶ ğŸ± â¤ï¸ ğŸ¤–</td>
<td>ë©ì²­ì´ ë‚˜ ì¢‹ì•„í•´ ë„ˆë¥¼</td>
<td>GOOD</td>
</tr>

<tr>
<td>ğŸ· â¤ï¸ â—ï¸ ğŸ¶</td>
<td>ë°”ë³´ ì¢‹ëƒ ì¡¸ë¼ ë©ì²­ì•„</td>
<td>BAD</td>
</tr>

<tr>
<td>ğŸ± ğŸ¤– ğŸ· â¤ï¸</td>
<td>ë‚œ ë„ˆê°€ ë°”ë³´ê°™ì´ ì¢‹ë‹¤</td>
<td>GOOD</td>
</tr>

<tr>
<td>â—ï¸ â¤ï¸ ğŸ± ğŸ¤–</td>
<td>ì¡¸ë¼ ì¢‹ë‹¤ ë‚˜ëŠ” ë„ˆë¥¼</td>
<td>GOOD</td>
</tr>

<tr>
<td>ğŸ¤– ğŸ± â¤ï¸ ğŸ·</td>
<td>ë„ˆ ë‚˜ ì¢‹ëƒ ë°”ë³´ì•¼</td>
<td>BAD</td>
</tr>

<tr>
<td>ğŸ· ğŸ¶ â—ï¸ â¤ï¸</td>
<td>ë°”ë³´ ë©ì²­ì•„ ì¡¸ë¼ ì¢‹ëƒ</td>
<td>BAD</td>
</tr>
</tbody>
</table>

<p>ê³ ê°ì´ ì˜ë¢°í•œ ë¬¸ìì— ëŒ€í•´ì„œ ì˜ë¯¸ì™€ ê°ì„± ë¶„ì„ ì˜ˆìƒ í…Œì´ë¸”ì´ë‹¤.</p>

<table>
<thead>
<tr>
<th>ë¬¸ì ì´ëª¨í‹°ì½˜</th>
<th>ì˜ë¯¸</th>
<th>ì˜ˆìƒ</th>
</tr>
</thead>

<tbody>
<tr>
<td>ğŸ¶ ğŸ± ğŸ¤– â¤ï¸</td>
<td>ë©ì²­ì´ ë‚˜ ë„ˆ ì¢‹ì•„í•´</td>
<td>GOOD</td>
</tr>

<tr>
<td>ğŸ¤– â—ï¸ ğŸ· ğŸ¶</td>
<td>ë„Œ ì¡¸ë¼ ë°”ë³´ ë©ì²­ì´ì•¼</td>
<td>BAD</td>
</tr>
</tbody>
</table>

<p>ì´ ë¬¸ì œëŠ” ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬(NN)ë¡œëŠ” í•´ê²°í•  ìˆ˜ ì—†ë‹¤.<br />
ì™œëƒí•˜ë©´&hellip; ì•„ë˜ ë°ì´í„°ë¥¼ ë³´ì</p>

<table>
<thead>
<tr>
<th>ë¬¸ì ì´ëª¨í‹°ì½˜</th>
<th>ì˜ë¯¸</th>
<th>ì˜ˆìƒ</th>
</tr>
</thead>

<tbody>
<tr>
<td>ğŸ± ğŸ¤– ğŸ· â¤ï¸</td>
<td>ë‚œ ë„ˆê°€ ë°”ë³´ê°™ì´ ì¢‹ë‹¤</td>
<td>GOOD</td>
</tr>

<tr>
<td>ğŸ¤– ğŸ± â¤ï¸ ğŸ·</td>
<td>ë„ˆ ë‚˜ ì¢‹ëƒ ë°”ë³´ì•¼</td>
<td>BAD</td>
</tr>
</tbody>
</table>

<p>ë¬¸ì ì´ëª¨í‹°ì½˜ì˜ ìˆœì„œë§Œ ë°”ë€Œì–´ë„ ì˜ˆìƒ ê²°ê³¼ê°’ì´ ë‹¤ë¥´ê²Œ ëœë‹¤!</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ë°ì´í„°ì˜ ìˆœì„œê°€ ê²°ê³¼ì— ì˜í–¥ì„ ë¯¸ì¹œë‹¤!<br />
ìƒˆë¡œìš´ ëª¨ë¸ì´ í•„ìš”í•˜ë‹¤.</p>

<p>ê±±ì •ë§ˆë¼<br />
ë°ì´í„°ì˜ ìˆœì„œë¥¼ ê³ ë ¤í•œ ëª¨ë¸ì´ ì¡´ì¬í•œë‹¤.<br />
ê·¸ê²ƒì€ ë°”ë¡œ&hellip;</p>
</blockquote>

<h2 id="ë¦¬ì»¤ëŸ°íŠ¸-ë‰´ëŸ´-ë„¤íŠ¸ì›Œí¬-ëª¨ë¸ë§-rnn-modeling">ë¦¬ì»¤ëŸ°íŠ¸ ë‰´ëŸ´ ë„¤íŠ¸ì›Œí¬ ëª¨ë¸ë§ (RNN Modeling)</h2>

<p>ì§€ê¸ˆê¹Œì§€ ì•Œì•„ ë³´ì•˜ë˜ NN, CNN, MFë“±ì€ ë°ì´í„°ì˜ ìˆœì„œì™€ëŠ” ìƒê´€ì´ ì—†ì—ˆë‹¤.<br />
ê·¸ëŸ¬ë‚˜ ì´ë²ˆ ë¬¸ì œëŠ” ë°ì´í„°ì˜ ìˆœì„œë¥¼ ê³ ë ¤í•´ì•¼ í•œë‹¤. ì¦‰, ì´ì „ ë°ì´í„°ì˜ ì •ë³´ë„ ëª¨ë¸ë§ì— í•„ìš”í•˜ë‹¤.</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì—”ì§€ë‹ˆì–´ë“¤ì„ ê°ˆì•„ì„œ ë§Œë“ <br />
RNN ëª¨ë¸ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
</blockquote>

<p><img src="https://skettee.github.io/post/recurrent_neural_network/rnn_model.png" alt="RNN ëª¨ë¸" /></p>

<p>\(a^{<t>} = g\left(W_{aa}a^{<t-1>} + W_{ax}x^{<t>} + b_a\right)\)</p>

<p>\(\hat y^{<t>} = W_{ya}a^{<t>} + b_y\)</p>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ì´ì „ ë°ì´í„°ì˜ í™œì„±í•¨ìˆ˜(activation function) ê°’ì„<br />
í˜„ì¬ ë°ì´í„°ì˜ ì…ë ¥ê°’ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.<br />
ë˜‘ë˜‘í•´~</p>

<p>RNNì—ì„œì˜ í™œì„±í•¨ìˆ˜ \(g(z)\)ëŠ” ReLU í˜¹ì€ <strong>tanh</strong> ë¥¼ ì‚¬ìš©í•œë‹¤.<br />
tanhë€?</p>
</blockquote>

<h3 id="í•˜ì´í¼ë³¼ë¦­-íƒ„ì  íŠ¸-í•¨ìˆ˜-tanh-function">í•˜ì´í¼ë³¼ë¦­ íƒ„ì  íŠ¸ í•¨ìˆ˜ (tanh function)</h3>

<p>tanh í•¨ìˆ˜ëŠ” sigmoid í•¨ìˆ˜ì˜ ì¤‘ì‹¬ê°’ì„ 0ìœ¼ë¡œ ì˜®ê²¨ ë†“ì€ í•¨ìˆ˜ì´ë‹¤.  sigmoid ë³´ë‹¤ ì¢€ ë” ê°œì„ ëœ ì„±ëŠ¥ì„ ë³´ì¸ë‹¤ê³  í•œë‹¤.</p>

<p>\(tanh(x) = \dfrac{e^x - e^{-x}}{e^x + e^{-x}}\)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">%</span>matplotlib inline
<span style="color:#f92672">import</span> matplotlib.pyplot <span style="color:#f92672">as</span> plt

tanh <span style="color:#f92672">=</span> <span style="color:#66d9ef">lambda</span> x: (np<span style="color:#f92672">.</span>exp(x) <span style="color:#f92672">-</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>x)) <span style="color:#f92672">/</span> (np<span style="color:#f92672">.</span>exp(x) <span style="color:#f92672">+</span> np<span style="color:#f92672">.</span>exp(<span style="color:#f92672">-</span>x))

xx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">10</span>,<span style="color:#ae81ff">100</span>)

plt<span style="color:#f92672">.</span>plot(xx, tanh(xx))
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_10_0.png" alt="png" /></p>

<h3 id="many-to-one-model">Many-to-One Model</h3>

<p>RNNëª¨ë¸ì€ 5ê°€ì§€ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤.</p>

<p><img src="http://karpathy.github.io/assets/rnn/diags.jpeg" alt="RNN ëª¨ë¸ ì¢…ë¥˜" /></p>

<p>ì¶œì²˜: <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/">Andrej Karpathy blog</a></p>

<p>ìì„¸í•œ ì„¤ëª…ì€ ìƒëµí•œë‹¤.  ìš°ë¦¬ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ê°ì„±ë¶„ì„(Sentiment Anaysis)ì— ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” many to one ëª¨ë¸ì„ ì‚¬ìš©í•˜ì<br />
ì…ë ¥ê³¼ ì¶œë ¥ì˜ ëª¨ì–‘ì€ ì•„ë˜ ê·¸ë¦¼ê³¼ ê°™ë‹¤.</p>

<p><img src="https://skettee.github.io/post/recurrent_neural_network/many_to_one.png" alt="many-to-one" /></p>

<h3 id="ì •ë¦¬">ì •ë¦¬</h3>

<ol>
<li>Input Layer  (í•‘í¬ìƒ‰)

<ol>
<li>Batch sizeëŠ” 10ê°œ<br /></li>
<li>Time stepì€ 4ê°œ (\(T_x = 4\))<br /></li>
<li>Feature ê°œìˆ˜ëŠ” ì…ë ¥ì— ë“¤ì–´ê°€ëŠ” ì´ëª¨í‹°ì½˜ 1ê°œ<br /></li>
</ol></li>
<li>RNN Layer  (ì—°ë‘ìƒ‰)

<ol>
<li>32ê°œ ìœ ë‹›ìœ¼ë¡œ êµ¬ì„±í•œë‹¤.<br /></li>
<li>í™œì„± í•¨ìˆ˜ëŠ” ReLUë¥¼ ì‚¬ìš©í•œë‹¤.<br /></li>
</ol></li>
<li>Output Layer (íŒŒë‘ìƒ‰)

<ol>
<li>í™œì„± í•¨ìˆ˜ëŠ” ì‹œê·¸ëª¨ì´ë“œ(Sigmoid)ë¥¼ ì‚¬ìš©í•œë‹¤.</li>
</ol></li>
<li>Loss funtion ì€ mean squared error ë¥¼ ì‚¬ìš©í•œë‹¤.<br /></li>
<li>Optimizer ëŠ” RMSPropì„ ì‚¬ìš©í•œë‹¤.<br /></li>
</ol>

<h2 id="ì¼€ë¼ìŠ¤-keras-ë¡œ-ëª¨ë¸ë§-modeling">ì¼€ë¼ìŠ¤(Keras)ë¡œ ëª¨ë¸ë§(Modeling)</h2>

<h3 id="ë°ì´í„°-ë³€í™˜-data-transformation">ë°ì´í„° ë³€í™˜ (Data Transformation)</h3>

<p>ì…ë ¥ ë°ì´í„°ì˜ ì´ëª¨í‹°ì½˜ê³¼ ì¶œë ¥ ë°ì´í„°ì˜ ë¬¸ìë¥¼ ìˆ«ìë¡œ ë³€í™˜í•œë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> sklearn.preprocessing <span style="color:#f92672">import</span> LabelEncoder

encoder <span style="color:#f92672">=</span> LabelEncoder()

<span style="color:#75715e"># Encoding X</span>
batch_size <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]
input_dim <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]
x_train <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>flatten() <span style="color:#75715e"># Flattern</span>
x_train <span style="color:#f92672">=</span> encoder<span style="color:#f92672">.</span>fit_transform(x_train) <span style="color:#75715e"># Labeling</span>
x_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>reshape(x_train, (batch_size, input_dim)) <span style="color:#75715e"># Reshape</span>

<span style="color:#75715e"># Encoding Y</span>
batch_size <span style="color:#f92672">=</span> y<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]
input_dim <span style="color:#f92672">=</span> y<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]
y_train <span style="color:#f92672">=</span> y<span style="color:#f92672">.</span>flatten() <span style="color:#75715e"># Flattern</span>
y_train <span style="color:#f92672">=</span> encoder<span style="color:#f92672">.</span>fit_transform(y_train) <span style="color:#75715e"># Labeling</span>
y_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>reshape(y_train, (batch_size, input_dim)) <span style="color:#75715e"># Reshape</span>

<span style="color:#66d9ef">print</span>(x_train<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(y_train<span style="color:#f92672">.</span>shape)</code></pre></div>
<pre><code>(10, 4)
(10, 1)
</code></pre>

<p>Kerasì˜ RNNì— ì…ë ¥ë˜ëŠ” ë°ì´í„°ì˜ ëª¨ì–‘(shape) ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>

<p><strong>(batch_size, timesteps, features)</strong></p>

<p>ë”°ë¼ì„œ ì…ë ¥ ë°ì´í„°ì˜ shapeë¥¼ (10, 4, 1)ë¡œ ë³€í™˜í•œë‹¤.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">X_train <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>reshape(x_train, (x_train<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>], x_train<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>], <span style="color:#ae81ff">1</span>))
Y_train <span style="color:#f92672">=</span> y_train
<span style="color:#66d9ef">print</span>(X_train<span style="color:#f92672">.</span>shape)
<span style="color:#66d9ef">print</span>(Y_train<span style="color:#f92672">.</span>shape)</code></pre></div>
<pre><code>(10, 4, 1)
(10, 1)
</code></pre>

<h3 id="ëª¨ë¸ë§-modeling">ëª¨ë¸ë§ (Modeling)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">from</span> tensorflow.keras <span style="color:#f92672">import</span> Sequential
<span style="color:#f92672">from</span> tensorflow.keras.layers <span style="color:#f92672">import</span> SimpleRNN, Dense

model <span style="color:#f92672">=</span> Sequential()
model<span style="color:#f92672">.</span>add(SimpleRNN(units<span style="color:#f92672">=</span><span style="color:#ae81ff">32</span>, input_shape<span style="color:#f92672">=</span>(<span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>), activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;relu&#34;</span>))
model<span style="color:#f92672">.</span>add(Dense(<span style="color:#ae81ff">1</span>, activation<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;sigmoid&#34;</span>))
model<span style="color:#f92672">.</span>compile(loss<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mean_squared_error&#39;</span>, optimizer<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;rmsprop&#39;</span>)
model<span style="color:#f92672">.</span>summary()</code></pre></div>
<pre><code>WARNING: Logging before flag parsing goes to stderr.
W0913 23:04:53.602141 139855953307456 deprecation.py:506] From /home/dataman/anaconda3/lib/python3.7/site-packages/tensorflow/python/ops/init_ops.py:1251: calling VarianceScaling.__init__ (from tensorflow.python.ops.init_ops) with dtype is deprecated and will be removed in a future version.
Instructions for updating:
Call initializer instance with the dtype argument instead of passing it to the constructor


Model: &quot;sequential&quot;
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
simple_rnn (SimpleRNN)       (None, 32)                1088      
_________________________________________________________________
dense (Dense)                (None, 1)                 33        
=================================================================
Total params: 1,121
Trainable params: 1,121
Non-trainable params: 0
_________________________________________________________________
</code></pre>

<h3 id="ëª¨ë¸-í›ˆë ¨-train-model">ëª¨ë¸ í›ˆë ¨ (Train Model)</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">hist <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>fit(X_train,Y_train, epochs<span style="color:#f92672">=</span><span style="color:#ae81ff">200</span>, verbose<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)

plt<span style="color:#f92672">.</span>plot(hist<span style="color:#f92672">.</span>history[<span style="color:#e6db74">&#39;loss&#39;</span>])
plt<span style="color:#f92672">.</span>xlabel(<span style="color:#e6db74">&#39;epoch&#39;</span>)
plt<span style="color:#f92672">.</span>ylabel(<span style="color:#e6db74">&#39;loss&#39;</span>)
plt<span style="color:#f92672">.</span>show()</code></pre></div>
<p><img src="output_20_0.png" alt="png" /></p>

<h2 id="í•´ê²°-solution">í•´ê²° (Solution)</h2>

<p>âš™ï¸ ì—”ì§€ë‹ˆì–´</p>

<blockquote>
<p>ê³ ê°ë‹˜~ ì›í•˜ì‹œëŠ” ì†”ë£¨ì…˜ì…ë‹ˆë‹¤.</p>

<p>test_dataì— ì›í•˜ì‹œëŠ” ë¬¸ì ì´ëª¨í‹°ì½˜ì„ ì…ë ¥í•˜ì‹œë©´<br />
ê°ì„± ë¶„ì„ ê²°ê³¼ ê°’ (GOOD, BAD)ê°€ ì¶œë ¥ ë©ë‹ˆë‹¤.</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">analyze_message</span>(message):
    x <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>array([message])
    <span style="color:#66d9ef">if</span> x<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">1</span>:
        <span style="color:#66d9ef">return</span> None
    <span style="color:#66d9ef">if</span> x<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>] <span style="color:#f92672">!=</span> <span style="color:#ae81ff">4</span>:
        <span style="color:#66d9ef">return</span> None
    batch_size <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">0</span>]
    time_steps <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>shape[<span style="color:#ae81ff">1</span>]
    x <span style="color:#f92672">=</span> x<span style="color:#f92672">.</span>flatten()
    x <span style="color:#f92672">=</span> encoder<span style="color:#f92672">.</span>fit_transform(x)
    X_test <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>reshape(x, (batch_size, time_steps, <span style="color:#ae81ff">1</span>))
    predict <span style="color:#f92672">=</span> model<span style="color:#f92672">.</span>predict(X_test)
    <span style="color:#66d9ef">if</span> predict[<span style="color:#ae81ff">0</span>] <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0.5</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;GOOD&#39;</span>
    <span style="color:#66d9ef">else</span>:
        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;BAD&#39;</span>

test_data1 <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;ğŸ¶&#39;</span>, <span style="color:#e6db74">&#39;ğŸ±&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¤–&#39;</span>, <span style="color:#e6db74">&#39;â¤ï¸&#39;</span>]
result <span style="color:#f92672">=</span> analyze_message(test_data1)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;{} : {}&#39;</span><span style="color:#f92672">.</span>format(test_data1, result))

test_data2 <span style="color:#f92672">=</span> [<span style="color:#e6db74">&#39;ğŸ¤–&#39;</span>, <span style="color:#e6db74">&#39;â—ï¸&#39;</span>, <span style="color:#e6db74">&#39;ğŸ·&#39;</span>, <span style="color:#e6db74">&#39;ğŸ¶&#39;</span>]
result <span style="color:#f92672">=</span> analyze_message(test_data2)
<span style="color:#66d9ef">print</span>(<span style="color:#e6db74">&#39;{} : {}&#39;</span><span style="color:#f92672">.</span>format(test_data2, result))</code></pre></div>
<pre><code>['ğŸ¶', 'ğŸ±', 'ğŸ¤–', 'â¤ï¸'] : GOOD
['ğŸ¤–', 'â—ï¸', 'ğŸ·', 'ğŸ¶'] : BAD
</code></pre>
		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link btn" href="/tags/tanh/" rel="tag">tanh</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/timesteps/" rel="tag">timesteps</a></li>
		<li class="tags__item"><a class="tags__link btn" href="/tags/many-to-one/" rel="tag">many-to-one</a></li>
	</ul>
</div>
		</footer>
	</article>
</main>


<nav class="post-nav flex">
	<div class="post-nav__item post-nav__item--prev">
		<a class="post-nav__link" href="/post/latent_factor_model/" rel="prev"><span class="post-nav__caption">Â«&thinsp;Previous</span><p class="post-nav__post-title">ì ì¬ ì¸ìˆ˜ ëª¨ë¸ (Latent Factor Model)</p></a>
	</div>
</nav>
<script src="https://utteranc.es/client.js"
        repo="skettee/blog-comments"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2019 skettee.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>